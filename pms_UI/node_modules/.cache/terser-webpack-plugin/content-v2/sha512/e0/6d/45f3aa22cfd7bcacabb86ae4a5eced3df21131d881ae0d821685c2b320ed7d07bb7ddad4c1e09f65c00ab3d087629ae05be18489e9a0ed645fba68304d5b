{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-2d0d7104\"],{\"74e6\":function(e,t,a){\"use strict\";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",{staticClass:\"app-container\",staticStyle:{padding:\"2px 0 0 0\"}},[a(\"div\",{ref:\"search\"},[a(\"el-form\",{directives:[{name:\"show\",rawName:\"v-show\",value:e.showSearch,expression:\"showSearch\"}],ref:\"queryForm\",attrs:{model:e.queryParams,inline:!0,\"label-width\":\"68px\",hidden:\"\"}},[a(\"el-form-item\",{attrs:{label:\"年月\",prop:\"actDate\"}},[a(\"el-date-picker\",{attrs:{clearable:\"\",size:\"small\",type:\"month\",\"value-format\":\"yyyy-MM-dd\",placeholder:\"选择年月\"},model:{value:e.queryParams.actDate,callback:function(t){e.$set(e.queryParams,\"actDate\",t)},expression:\"queryParams.actDate\"}})],1),a(\"el-form-item\",[a(\"el-button\",{attrs:{type:\"primary\",icon:\"el-icon-search\",size:\"mini\"},on:{click:e.handleQuery}},[e._v(\"搜索\")])],1)],1)],1),a(\"div\",{ref:\"btns\"},[a(\"el-row\",{staticClass:\"mb8\",attrs:{gutter:10}},[a(\"el-col\",{attrs:{span:1.5}},[a(\"el-button\",{attrs:{type:\"info\",icon:\"el-icon-back\",size:\"mini\",loading:e.exportLoading},on:{click:e.goBack}},[e._v(\"返回 \")])],1),a(\"el-col\",{attrs:{span:1.5}},[a(\"el-button\",{directives:[{name:\"hasPermi\",rawName:\"v-hasPermi\",value:[\"bonus:calculation:list\"],expression:\"['bonus:calculation:list']\"}],attrs:{type:\"primary\",icon:\"el-icon-notebook-2\",size:\"mini\"},on:{click:e.processExamine}},[e._v(\"流转历史 \")])],1),a(\"el-col\",{attrs:{span:1.5}},[[a(\"download-excel\",{staticClass:\"export-excel-wrapper\",attrs:{data:e.sumDataList,fields:e.jsonFields,header:e.title,name:e.excelName}},[a(\"el-button\",{attrs:{type:\"warning\",icon:\"el-icon-document-copy\",size:\"mini\"},on:{click:function(e){}}},[e._v(\"导出EXCEL \")])],1)]],2),a(\"right-toolbar\",{attrs:{showSearch:e.showSearch},on:{\"update:showSearch\":function(t){e.showSearch=t},\"update:show-search\":function(t){e.showSearch=t},queryTable:e.getList}})],1)],1),a(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.loading,expression:\"loading\"}],ref:\"multipleTable\",attrs:{border:\"\",stripe:\"\",data:e.EvaluateDataList,height:\"calc(100vh - 180px)\",\"row-style\":e.rowStyle,\"row-class-name\":e.rowClassName,\"show-summary\":!0,\"summary-method\":e.getSummaries},on:{\"selection-change\":e.handleSelectionChange,\"row-click\":e.rowClick}},[a(\"el-table-column\",{attrs:{type:\"selection\",width:\"55\",align:\"center\"}}),a(\"el-table-column\",{attrs:{sortable:\"\",label:\"科室名称\",align:\"left\",prop:\"deptRoomName\"}}),a(\"el-table-column\",{attrs:{sortable:\"\",label:\"人员姓名\",align:\"left\",prop:\"docName\"}}),e._l(e.indexList,(function(e,t){return a(\"el-table-column\",{key:t,attrs:{label:e.indexName,prop:e.guideCode,align:\"right\"}})})),a(\"el-table-column\",{attrs:{sortable:\"\",label:\"合计\",align:\"right\",prop:\"total\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[a(\"span\",[e._v(e._s(e.computedStatus(t.row)))])]}}])})],2),a(\"el-form\",{ref:\"form\",attrs:{model:e.form,\"label-width\":\"80px\"}},[a(\"formItem\",{attrs:{showDialog:e.showDialog,showBaseInfo:e.btn3,open:e.btn4,open2:e.btn5,comment:e.form,userOptions:e.userOptions},on:{\"update:showDialog\":function(t){e.showDialog=t},\"update:show-dialog\":function(t){e.showDialog=t},success:e.formItemSuccess}})],1),a(\"el-dialog\",{attrs:{title:\"流转历史\",visible:e.processOpen,width:\"1200px\",\"append-to-body\":\"\",\"close-on-click-modal\":!1,\"custom-class\":\"el-button--primary\"},on:{\"update:visible\":function(t){e.processOpen=t}}},[a(\"div\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.loading,expression:\"loading\"}],style:\"height:\"+e.height},[a(\"iframe\",{staticStyle:{width:\"100%\",height:\"100%\"},attrs:{src:e.src,frameborder:\"no\",scrolling:\"auto\"}})])])],1)},i=[],n=a(\"b85c\"),s=(a(\"b680\"),a(\"99af\"),a(\"d81d\"),a(\"7db0\"),a(\"d3b7\"),a(\"159b\"),a(\"b0c0\"),a(\"a9e3\"),a(\"13d5\"),a(\"c466\")),r=a(\"e472\"),l=a(\"3b86\"),c=a(\"0e67\"),u=a(\"986b\"),d=a(\"0b70\"),m=a(\"f2d9\"),h=a(\"2b0e\"),p=a(\"d623\");h[\"default\"].component(\"downloadExcel\",m[\"a\"]);var f={name:\"EvaluateData\",deptCode:{type:[String,String],default:\"\"},components:{formItem:c[\"default\"],btns:u[\"default\"],selectList:p[\"default\"]},filters:{transToValue:function(e,t){return e[t]}},computed:{computedStatus:function(){return function(e){var t,a=0,o=Object(n[\"a\"])(this.indexList);try{for(o.s();!(t=o.n()).done;){var i=t.value;a+=parseFloat(e[i.guideCode])}}catch(s){o.e(s)}finally{o.f()}return e.total=a.toFixed(2),a.toFixed(2)}},sumDataList:function(){return this.sumDataList_.push({}),this.sumDataList_.push(this.bottomTotal),this.sumDataList_},excelName:function(){return\"人员奖金\"+Object(s[\"c\"])()+\".xls\"}},mounted:function(){},watch:{},data:function(){return{processOpen:!1,height:\"500px;\",src:\"\",showAudit:!1,id:\"\",showDialog:!1,userOptions:[],auditState:\"\",saveLoading:!1,loading:!1,exportLoading:!1,ids:[],single:!0,multiple:!0,showSearch:!0,total:0,EvaluateDataList:[],sumDataList_:[],selectionRow:[],title:\"\",open:!1,queryParams:{pageNum:1,pageSize:30,compCode:null,deptCode:null,deptName:null,accountCode:null,guideCode:null,guideValue:null,delFlag:null,actDate:Object(s[\"c\"])()+\"-01\",createBy:null,createTime:null,updateBy:null,updateTime:null,remark:null,deptType:null},form:{procedureId:null,assignee:null},indexList:[],nextAssignee:[],btn1:!1,btn2:!1,btn3:!1,btn4:!1,btn5:!1,comment:\"\",proclnsIds:\"\",datas:{},openSelect:!1,doctorOpen:!1,docParams:{pageNum:1,pageSize:20},doctorList:[],docTotal:0,tableTitle:\"人员奖金数据\",jsonFields:{\"科室名称\":\"deptRoomName\",\"人员姓名\":\"docName\"},bottomTotal:{deptRoomName:\"合计\",docName:\"\",total:0}}},created:function(){this.getDept(),this.getDetailInfo()},methods:{getDept:function(){var e=this;this.loading=!0,this.queryParams.actDate=this.$route.params.actDate,this.queryParams.nowDate=this.$route.params.actDate,this.queryParams.deptCode=this.$route.params.deptCode,Object(l[\"a\"])(this.queryParams).then((function(t){e.indexList=t.data,e.getList(),e.loading=!1}))},getList:function(){var e=this;for(var t in this.loading=!0,this.queryParams.actDate||(this.queryParams.actDate=Object(s[\"c\"])()+\"-01\"),this.queryParams.deptCode=this.$route.params.deptCode,Object(l[\"d\"])(this.queryParams).then((function(t){for(var a in e.EvaluateDataList=t.data,e.tableDoLayout(),e.sumDataList_=[].concat(t.data),e.EvaluateDataList)\"\"!=e.EvaluateDataList[a][\"remark\"]&&null!=e.EvaluateDataList[a][\"remark\"]||(e.EvaluateDataList[a][\"remark\"]=\"0\");e.loading=!1})),this.indexList)this.jsonFields[this.indexList[t].indexName]=this.indexList[t].guideCode;this.jsonFields[\"合计\"]=\"total\"},successSubmit:function(e){this.open=e,this.getList()},cancel:function(){this.open=!1},cancelSelect:function(){this.openSelect=!1},reset:function(){this.form={id:null,compCode:null,deptName:null,accountCode:null,guideCode:null,guideValue:null,delFlag:null,actDate:null,createBy:null,createTime:null,updateBy:null,updateTime:null,remark:null},this.resetForm(\"form\")},handleQuery:function(){this.queryParams.pageNum=1,this.getList()},resetQuery:function(){this.resetForm(\"queryForm\"),this.handleQuery()},handleSelectionChange:function(e){this.ids=e.map((function(e){return e.docCode})),this.single=1!==e.length,this.multiple=!e.length,this.selectionRow=e},rowClick:function(e,t,a){var o=this.$refs.multipleTable,i=this.selectionRow.find((function(t){return t.rowIndex==e.rowIndex}));i&&1==this.selectionRow.length?o.toggleRowSelection(e,!1):(o.clearSelection(),o.toggleRowSelection(e))},rowStyle:function(e){var t=e.row,a=e.rowIndex;Object.defineProperty(t,\"rowIndex\",{value:a,writable:!0,enumerable:!1})},rowClassName:function(e){var t=e.row,a=(e.rowIndex,\"\"),o=this.selectionRow.find((function(e){return e.rowIndex===t.rowIndex}));return o&&(a=\"current-row \"),a},tableRowClassName:function(e){var t=e.row,a=e.rowIndex;t.row_index=a},handleSelectionDocChange:function(e,t){this.singleTable(t)},handleDocRowClick:function(e){this.singleTable(e)},singleTable:function(e){var t=this.$refs.itsmDataTable;t.clearSelection(),this.currentRowIndex==e.row_index?(t.toggleRowSelection(e,!1),this.currentRowIndex=null,this.docSelectData=null):(t.toggleRowSelection(e),this.currentRowIndex=e.row_index,this.docSelectData=e)},sexFormat:function(e,t){return this.selectDictLabel(this.sexOptions,e.gender)},handleExport:function(){var e=this;this.queryParams;this.$confirm(\"是否确认导出科室奖金数据项?\",\"警告\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then((function(){for(var t in e.indexList)e.jsonFields.push(e.indexList[t].guideCode,e.indexList[t].guideCode);e.exportLoading=!0})).catch((function(){}))},goBack:function(){this.$store.dispatch(\"tagsView/delView\",this.$route),this.$router.go(-1)},packageData:function(){var e=this;this.$refs.multipleTable.data.forEach((function(t){t.unitCode=t.docCode,t.deptCode=t.deptRoomCode,t.actDate=e.queryParams.actDate}));var t={data:this.$refs.multipleTable.data,audit:{deptCode:this.$route.params.deptCode,nowDate:this.queryParams.actDate,comment:this.form.comment,assignee:this.form.assignee}};return t},formItemSuccess:function(){var e=this,t=this.packageData();t.isCommit=!0,this.saveLoading=!0,Object(r[\"a\"])(t).then((function(t){e.msgSuccess(\"提交成功\"),e.saveLoading=!1,e.auditState=\"1\"}))},getDetailInfo:function(){var e=this;Object(r[\"f\"])({deptCode:this.$route.params.deptCode,nowDate:this.queryParams.actDate}).then((function(t){if(t.rows.length>0){var a=t.rows[0],o=e,i=a.procedureId;e.proclnsIds=a.procedureId,e.form.procedureId=e.proclnsIds,e.id=a.id,e.auditState=a.auditState,Object(d[\"c\"])(o,e.$store.state.user.name,i,e.userOptions,e.btn1,e.btn2,e.btn3,e.btn4,e.btn5)}}))},processExamineForm2:function(){this.src=\"\".concat(this.processUrl,\"/api/wf/processHistoric?procInsId=\").concat(this.proclnsIds)},processExamine:function(){var e=this.proclnsIds;null!=e&&e?(this.processExamineForm2(),this.processOpen=!0):this.msgError(\"没有流转历史数据！\")},docCodeList:function(e){for(var t in e[0]){var a={deptRoomCode:this.EvaluateDataList[0].deptRoomCode,deptRoomName:this.EvaluateDataList[0].deptRoomName,docCode:e[0][t].docCode,docName:e[0][t].docName};for(var o in this.indexList)a[this.indexList[o].guideCode]=0,a[\"remark\"]=\"1\";this.EvaluateDataList.push(a)}},getSummaries:function(e){var t=this,a=e.columns,o=e.data,i=[];return a.forEach((function(e,a){if(0!==a){var n=o.map((function(t){return Number(t[e.property])}));n.every((function(e){return isNaN(e)}))?i[a]=\"N/A\":(i[a]=n.reduce((function(e,t){var a=Number(t);return isNaN(a)?e:e+t}),0),\"deptRoomName\"!=e.property&&\"docName\"!=e.property&&(t.bottomTotal[e.property]=parseFloat(i[a])),i[a]=i[a].toFixed(2))}else i[a]=\"合计\"})),i},tableDoLayout:function(){var e=this;this.$refs.multipleTable&&this.$nextTick((function(){e.$refs.multipleTable.doLayout()}))}}},g=f,b=a(\"2877\"),w=Object(b[\"a\"])(g,o,i,!1,null,null,null);t[\"default\"]=w.exports}}]);","extractedComments":[]}