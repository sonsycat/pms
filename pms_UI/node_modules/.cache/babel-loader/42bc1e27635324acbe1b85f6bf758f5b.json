{"remainingRequest":"D:\\work\\pms_oracle\\pms_UI\\node_modules\\babel-loader\\lib\\index.js!D:\\work\\pms_oracle\\pms_UI\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\work\\pms_oracle\\pms_UI\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\work\\pms_oracle\\pms_UI\\src\\views\\evaluate\\set\\bonusIndex.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\work\\pms_oracle\\pms_UI\\src\\views\\evaluate\\set\\bonusIndex.vue","mtime":1693362205000},{"path":"D:\\work\\pms_oracle\\pms_UI\\babel.config.js","mtime":1693361824000},{"path":"D:\\work\\pms_oracle\\pms_UI\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1693361924000},{"path":"D:\\work\\pms_oracle\\pms_UI\\node_modules\\babel-loader\\lib\\index.js","mtime":1693361909000},{"path":"D:\\work\\pms_oracle\\pms_UI\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1693361924000},{"path":"D:\\work\\pms_oracle\\pms_UI\\node_modules\\vue-loader\\lib\\index.js","mtime":1693362179000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIik7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIik7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UuanMiKTsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyIpOwp2YXIgX2luZGV4ID0gcmVxdWlyZSgiQC9hcGkvZXZhbHVhdGUvaW5kZXgiKTsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KdmFyIF9kZWZhdWx0ID0gewogIG5hbWU6ICdCb251c0luZGV4JywKICBwcm9wczoge30sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGluZGV4U2VsZWN0ZWRMb2FkaW5nOiBmYWxzZSwKICAgICAgaW5kZXhMaXN0TG9hZGluZzogZmFsc2UsCiAgICAgIGZvcm06IHt9LAogICAgICBydWxlczoge30sCiAgICAgIHNob3dTZWFyY2g6IHRydWUsCiAgICAgIGRlcHRSb29tVHlwZURpY3Q6IFtdLAogICAgICBkZXB0Um9vbVR5cGU6IG51bGwsCiAgICAgIGluZGV4TGlzdDogW10sCiAgICAgIC8vIOacqumAieaMh+aghwogICAgICBpbmRleFVuU2VsZWN0ZWRMaXN0OiBbXSwKICAgICAgLy8g5bey6YCJ5oyH5qCHCiAgICAgIGluZGV4U2VsZWN0ZWRMaXN0OiBbXSwKICAgICAgZGF0YUxpc3RzOiBbXQogICAgfTsKICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgdGhpcy5nZXREaWN0cygiSlhHTF9KSl9LU0xCIikudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgX3RoaXMuZGVwdFJvb21UeXBlRGljdCA9IHJlc3BvbnNlLmRhdGE7CiAgICAgIF90aGlzLmRlcHRSb29tVHlwZSA9IF90aGlzLmRlcHRSb29tVHlwZURpY3RbMF0uZGljdFZhbHVlOwogICAgfSk7CiAgICB0aGlzLmdldEJvbnVzSW5kZXhMaXN0KCk7CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkge30sCiAgbWV0aG9kczogewogICAgLyoqIOiOt+WPluWllumHkeaMh+agh+WIl+ihqCAqL2dldEJvbnVzSW5kZXhMaXN0OiBmdW5jdGlvbiBnZXRCb251c0luZGV4TGlzdCgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CiAgICAgIHZhciBwYXJhbSA9IHsKICAgICAgICBvcmdUeXBlOiAiMiIKICAgICAgfTsgLy/np5EKICAgICAgKDAsIF9pbmRleC5saXN0Qm9udXNJbmRleCkocGFyYW0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgX3RoaXMyLmluZGV4TGlzdCA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgX3RoaXMyLmdldEJvbnVzSW5kZXhMaXN0U2VsZWN0ZWQoX3RoaXMyLmRlcHRSb29tVHlwZSk7CiAgICAgICAgX3RoaXMyLmluZGV4U2VsZWN0ZWRMb2FkaW5nID0gZmFsc2U7CiAgICAgIH0pOwogICAgfSwKICAgIC8qKiDojrflj5blt7LpgInmjIfmoIfliJfooaggKi9nZXRCb251c0luZGV4TGlzdFNlbGVjdGVkOiBmdW5jdGlvbiBnZXRCb251c0luZGV4TGlzdFNlbGVjdGVkKGRlcHRSb29tVHlwZSkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKICAgICAgdGhpcy5pbmRleFVuU2VsZWN0ZWRMaXN0ID0gW107CiAgICAgIHRoaXMuaW5kZXhTZWxlY3RlZExpc3QgPSBbXTsKICAgICAgdGhpcy5pbmRleExpc3QuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIGlmIChkZXB0Um9vbVR5cGUgPT0gJzAnKSB7CiAgICAgICAgICAvLyDni6znq4vmoLjnrpcKICAgICAgICAgIGlmIChpdGVtLmRlcHRUeXBlICE9ICcyJykge30KICAgICAgICB9IGVsc2UgaWYgKGRlcHRSb29tVHlwZSA9PSAnMScpIHsKICAgICAgICAgIC8vIOW5s+Wdh+WllgogICAgICAgICAgaWYgKGl0ZW0uZGVwdFR5cGUgPT0gJzInKSB7fQogICAgICAgIH0KICAgICAgICBpZiAoZGVwdFJvb21UeXBlID09ICcwJyAmJiBpdGVtLmRlcHRUeXBlICE9ICcyJyB8fCBkZXB0Um9vbVR5cGUgPT0gJzEnICYmIGl0ZW0uZGVwdFR5cGUgPT0gJzInKSB7CiAgICAgICAgICBpZiAoIWl0ZW0uZGVwdFJvb21UeXBlKSB7CiAgICAgICAgICAgIF90aGlzMy5pbmRleFVuU2VsZWN0ZWRMaXN0LnB1c2goaXRlbSk7CiAgICAgICAgICB9IGVsc2UgaWYgKGl0ZW0uZGVwdFJvb21UeXBlID09IGRlcHRSb29tVHlwZSkgewogICAgICAgICAgICBfdGhpczMuaW5kZXhTZWxlY3RlZExpc3QucHVzaChpdGVtKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIHRhYmxlUm93Q2xhc3NOYW1lOiBmdW5jdGlvbiB0YWJsZVJvd0NsYXNzTmFtZShfcmVmKSB7CiAgICAgIHZhciByb3cgPSBfcmVmLnJvdywKICAgICAgICByb3dJbmRleCA9IF9yZWYucm93SW5kZXg7CiAgICAgIHJvdy5pbmRleCA9IHJvd0luZGV4OwogICAgfSwKICAgIC8vIOW+hemAieinkuiJsuWkmumAieahhumAieS4reaVsOaNrgogICAgc2VsZWN0SW5kZXg6IGZ1bmN0aW9uIHNlbGVjdEluZGV4KHNlbGVjdGlvbiwgcm93KSB7CiAgICAgIHRoaXMucm93Q2xpY2tXYWl0Q2xhc3Moc2VsZWN0aW9uWzBdKTsKICAgIH0sCiAgICAvL+W+hemAieinkuiJsiDngrnlh7vooYwKICAgIHJvd0NsaWNrV2FpdENsYXNzOiBmdW5jdGlvbiByb3dDbGlja1dhaXRDbGFzcyhzZWxlY3Rpb24pIHsKICAgICAgdGhpcy5pbmRleFNlbGVjdGVkTGlzdC5wdXNoKHNlbGVjdGlvbik7CiAgICAgIHRoaXMuaW5kZXhVblNlbGVjdGVkTGlzdC5zcGxpY2Uoc2VsZWN0aW9uLmluZGV4LCAxKTsKICAgIH0sCiAgICAvLyDlt7LpgInop5LoibLlpJrpgInmoYbpgInkuK3mlbDmja4KICAgIHVuc2VsZWN0SW5kZXg6IGZ1bmN0aW9uIHVuc2VsZWN0SW5kZXgoc2VsZWN0aW9uLCByb3cpIHsKICAgICAgdGhpcy5yb3dDbGlja0hhc0NsYXNzKHNlbGVjdGlvblswXSk7CiAgICB9LAogICAgLy8g5bey57uP6YCJ5oup54K55Ye76KGMCiAgICByb3dDbGlja0hhc0NsYXNzOiBmdW5jdGlvbiByb3dDbGlja0hhc0NsYXNzKHNlbGVjdGlvbikgewogICAgICB0aGlzLmluZGV4VW5TZWxlY3RlZExpc3QucHVzaChzZWxlY3Rpb24pOwogICAgICB0aGlzLmluZGV4U2VsZWN0ZWRMaXN0LnNwbGljZShzZWxlY3Rpb24uaW5kZXgsIDEpOwogICAgfSwKICAgIHN3aXRjaERlcHRSb29tVHlwZTogZnVuY3Rpb24gc3dpdGNoRGVwdFJvb21UeXBlKGFsbCkgewogICAgICB0aGlzLmdldEJvbnVzSW5kZXhMaXN0U2VsZWN0ZWQoYWxsKTsKICAgIH0sCiAgICBzdWJtaXRGb3JtOiBmdW5jdGlvbiBzdWJtaXRGb3JtKCkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKICAgICAgaWYgKCF0aGlzLmRlcHRSb29tVHlwZSkgewogICAgICAgIHRoaXMubXNnRXJyb3IoIuacqumAieaLqeenkeWupOexu+WIqyIpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB2YXIgZGF0YSA9IHsKICAgICAgICBjb21wQ29kZTogdGhpcy4kc3RvcmUuc3RhdGUudXNlci51c2VySW5mby5kZXB0SWQsCiAgICAgICAgZGVwdFJvb21UeXBlOiB0aGlzLmRlcHRSb29tVHlwZSwKICAgICAgICBldmFsdWF0ZUluZGV4Qm9udXNMaXN0OiB0aGlzLmluZGV4U2VsZWN0ZWRMaXN0Lm1hcChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgX3RoaXM0LmRhdGFMaXN0cy5mb3JFYWNoKGZ1bmN0aW9uIChpdGUpIHsKICAgICAgICAgICAgaWYgKGl0ZS5pbmRleE5hbWUgPT0gaXRlbS5pbmRleE5hbWUpIHsKICAgICAgICAgICAgICBpdGVtLmluZGV4Q29kZSA9IGl0ZS5pbmRleENvZGU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgICAgcmV0dXJuIGl0ZW07CiAgICAgICAgfSkKICAgICAgfTsKICAgICAgdmFyIHNhdmVMb2FkaW5nID0gdGhpcy5zYXZlTG9hZGluZygpOwogICAgICAoMCwgX2luZGV4LnNhdmVCb251c0luZGV4KShkYXRhKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIGlmIChyZXNwb25zZS5jb2RlID09IDIwMCkgewogICAgICAgICAgX3RoaXM0Lm1zZ1N1Y2Nlc3MoIuS/neWtmOaIkOWKnyIpOwogICAgICAgICAgX3RoaXM0LiRlbWl0KCJzdWNjZXNzIiwgZmFsc2UpOwogICAgICAgICAgX3RoaXM0LmdldEJvbnVzSW5kZXhMaXN0KCk7CiAgICAgICAgICBzYXZlTG9hZGluZy5jbG9zZSgpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfQp9OwpleHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDs="},{"version":3,"mappings":";;;;;;;;;;AA+DA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eAEA;EACAA;EACAC,QAEA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACA;MACAC;MACA;MACAC;MACAC;IACA;EACA;EAEAC;IAAA;IACA;MACA;MACA;IACA;IACA;EACA;EAEAC,6BAEA;EAEAC;IACA,eACAC;MAAA;MACA;QAAAC;MAAA;MACA;QACA;QACA;QACA;MACA;IACA;IACA,eACAC;MAAA;MACA;MACA;MACA;QACA;UACA;UACA,2BAEA;QACA;UACA;UACA,2BAEA;QACA;QACA;UACA;YACA;UACA;YACA;UACA;QACA;MACA;IACA;IAEAC;MAAA;QAAAC;MACAC;IACA;IACA;IACAC;MACA;IACA;IACA;IACAC;MACA;MACA;IACA;IACA;IACAC;MACA;IACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACA;IACA;IAEAC;MAAA;MACA;QACA;QACA;MACA;MACA;QACAC;QACApB;QACAqB;UACA;YACA;cACAC;YACA;UACA;UACA;QACA;MACA;MACA;MACA;QACA;UACA;UACA;UACA;UACAC;QACA;MACA;IACA;EACA;AACA;AAAA","names":["name","props","data","indexSelectedLoading","indexListLoading","form","rules","showSearch","deptRoomTypeDict","deptRoomType","indexList","indexUnSelectedList","indexSelectedList","dataLists","created","mounted","methods","getBonusIndexList","orgType","getBonusIndexListSelected","tableRowClassName","rowIndex","row","selectIndex","rowClickWaitClass","unselectIndex","rowClickHasClass","switchDeptRoomType","submitForm","compCode","evaluateIndexBonusList","item","saveLoading"],"sourceRoot":"src/views/evaluate/set","sources":["bonusIndex.vue"],"sourcesContent":["<template>\n  <div class=\"app-container\">\n    <div ref=\"search\">\n      <el-form ref=\"queryForm\" :inline=\"true\" v-show=\"showSearch\">\n        <el-form-item label=\"科室类别\" prop=\"deptRoomType\" >\n          <el-select class=\"w100\" v-model=\"deptRoomType\" @change=\"switchDeptRoomType($event)\"  placeholder=\"请选择科室类别\">\n            <el-option\n              v-for=\"dict in deptRoomTypeDict\"\n              :key=\"dict.dictValue\"\n              :label=\"dict.dictLabel\"\n              :value=\"dict.dictValue\"\n            />\n          </el-select>\n        </el-form-item>\n        <el-form-item>\n          <el-button type=\"primary\" icon=\"el-icon-document\" size=\"mini\" @click=\"submitForm\">保 存</el-button>\n        </el-form-item>\n      </el-form>\n    </div>\n    <el-row :gutter=\"20\">\n      <el-col :span=\"12\" class=\"mb10\">\n        <el-card>\n          <el-col :span=\"12\">\n            <span style=\"font-size:16px\">待选指标</span>\n          </el-col>\n          <el-table\n            v-loading=\"indexListLoading\"\n            :data=\"indexUnSelectedList\"\n            :row-class-name=\"tableRowClassName\"\n            @select=\"selectIndex\"\n            @row-dblclick=\"rowClickWaitClass\"\n            height=\"calc('100% - 48px')\"\n          >\n            <el-table-column type=\"index\" width=\"50\"> </el-table-column>\n            <el-table-column type=\"selection\" width=\"55\" align=\"center\" />\n            <el-table-column label=\"指标名称\" align=\"left\" prop=\"indexName\" show-overflow-tooltip/>\n          </el-table>\n        </el-card>\n      </el-col>\n      <el-col :span=\"12\" class=\"mb10\">\n        <el-card>\n          <el-col :span=\"10\">\n            <span style=\"font-size:16px\">已选指标</span>\n          </el-col>\n          <el-table\n            v-loading=\"indexSelectedLoading\"\n            :data=\"indexSelectedList\"\n            :row-class-name=\"tableRowClassName\"\n            @row-dblclick=\"rowClickHasClass\"\n            @select=\"unselectIndex\"\n            height=\"calc('100% - 48px')\"\n          >\n            <el-table-column type=\"index\" width=\"50\"> </el-table-column>\n            <el-table-column type=\"selection\" width=\"55\" align=\"center\" />\n            <el-table-column label=\"指标名称\" align=\"left\" prop=\"indexName\" show-overflow-tooltip/>\n          </el-table>\n        </el-card>\n      </el-col>\n    </el-row>\n  </div>\n</template>\n\n<script>\nimport {listBonusIndex, saveBonusIndex} from \"@/api/evaluate/index\";\n\nexport default {\n  name: 'BonusIndex',\n  props: {\n\n  },\n  data() {\n    return {\n      indexSelectedLoading:false,\n      indexListLoading:false,\n      form:{},\n      rules:{},\n      showSearch:true,\n      deptRoomTypeDict:[],\n      deptRoomType: null,\n      indexList: [],\n      // 未选指标\n      indexUnSelectedList: [],\n      // 已选指标\n      indexSelectedList: [],\n      dataLists:[],\n    };\n  },\n\n  created(){\n    this.getDicts(\"JXGL_JJ_KSLB\").then(response=>{\n      this.deptRoomTypeDict = response.data;\n      this.deptRoomType = this.deptRoomTypeDict[0].dictValue;\n    })\n    this.getBonusIndexList();\n  },\n\n  mounted() {\n\n  },\n\n  methods: {\n    /** 获取奖金指标列表 */\n    getBonusIndexList(){\n      let param = {orgType: \"2\"};//科\n      listBonusIndex(param).then(response => {\n        this.indexList = response.data;\n        this.getBonusIndexListSelected(this.deptRoomType)\n        this.indexSelectedLoading = false\n      });\n    },\n    /** 获取已选指标列表 */\n    getBonusIndexListSelected(deptRoomType){\n      this.indexUnSelectedList = [];\n      this.indexSelectedList = [];\n      this.indexList.forEach(item=>{\n        if(deptRoomType == '0'){\n          // 独立核算\n          if(item.deptType != '2'){\n\n          }\n        }else if(deptRoomType == '1'){\n          // 平均奖\n          if(item.deptType == '2'){\n\n          }\n        }\n        if((deptRoomType == '0' && item.deptType != '2') || deptRoomType == '1' && item.deptType == '2'){\n          if(!item.deptRoomType){\n            this.indexUnSelectedList.push(item);\n          }else if(item.deptRoomType == deptRoomType){\n            this.indexSelectedList.push(item);\n          }\n        }\n      })\n    },\n\n    tableRowClassName({ row, rowIndex }) {\n      row.index = rowIndex;\n    },\n    // 待选角色多选框选中数据\n    selectIndex(selection, row) {\n      this.rowClickWaitClass(selection[0])\n    },\n    //待选角色 点击行\n    rowClickWaitClass(selection){\n      this.indexSelectedList.push(selection);\n      this.indexUnSelectedList.splice(selection.index, 1);\n    },\n    // 已选角色多选框选中数据\n    unselectIndex(selection, row) {\n      this.rowClickHasClass(selection[0])\n    },\n    // 已经选择点击行\n    rowClickHasClass(selection){\n      this.indexUnSelectedList.push(selection);\n      this.indexSelectedList.splice(selection.index, 1);\n    },\n    switchDeptRoomType(all){\n      this.getBonusIndexListSelected(all);\n    },\n\n    submitForm(){\n      if(!this.deptRoomType){\n        this.msgError(\"未选择科室类别\");\n        return;\n      }\n      let data = {\n        compCode: this.$store.state.user.userInfo.deptId,\n        deptRoomType: this.deptRoomType,\n        evaluateIndexBonusList: this.indexSelectedList.map(item=>{\n          this.dataLists.forEach(ite=>{\n            if(ite.indexName==item.indexName){\n              item.indexCode=ite.indexCode\n            }\n          })\n          return item\n        })\n      }\n      const saveLoading=this.saveLoading()\n      saveBonusIndex(data).then(response=>{\n        if(response.code==200){\n          this.msgSuccess(\"保存成功\");\n          this.$emit(\"success\", false);\n          this.getBonusIndexList();\n          saveLoading.close()\n        }\n      })\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n::v-deep .mb10 {\n  height: 100%;\n  .el-card__body {\n    padding: 10px;\n    height: 100%;\n  }\n  .el-table{\n    height: calc(100vh - 220px);\n  }\n}\n.app-container{padding: 0px;}\n</style>\n"]}]}