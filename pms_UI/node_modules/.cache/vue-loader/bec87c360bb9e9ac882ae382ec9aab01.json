{"remainingRequest":"D:\\hrp\\zjry-pms-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\hrp\\zjry-pms-ui\\src\\views\\backlog\\already\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\hrp\\zjry-pms-ui\\src\\views\\backlog\\already\\index.vue","mtime":1682043107796},{"path":"D:\\hrp\\zjry-pms-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1682058377348},{"path":"D:\\hrp\\zjry-pms-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":1682058380827},{"path":"D:\\hrp\\zjry-pms-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1682058377348},{"path":"D:\\hrp\\zjry-pms-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":1682058381348}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGxpc3RBbHJlYWR5IH0gZnJvbSAiQC9hcGkvcHJvY2Vzcy9tb2RlbCI7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogImJhY2tsb2ciLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB0YWJsZUhlaWdodDogImF1dG8iLAogICAgICBzcmM6ICIiLAogICAgICBoZWlnaHQ6ICI1MDBweDsiLAogICAgICBjb21wb25lbnRVcmw6IG51bGwsCiAgICAgIC8vIOmBrue9qeWxggogICAgICBsb2FkaW5nOiB0cnVlLAogICAgICAvLyDlr7zlh7rpga7nvanlsYIKICAgICAgZXhwb3J0TG9hZGluZzogZmFsc2UsCiAgICAgIC8vIOmAieS4reaVsOe7hAogICAgICBwcm9jSW5zSWRzOiBbXSwKICAgICAgLy8g6Z2e5Y2V5Liq56aB55SoCiAgICAgIHNpbmdsZTogdHJ1ZSwKICAgICAgLy8g5rWB6L2s5Y6G5Y+y5a+56K+d5qGGCiAgICAgIHByb2Nlc3NPcGVuOiBmYWxzZSwKICAgICAgLy8g6Z2e5aSa5Liq56aB55SoCiAgICAgIG11bHRpcGxlOiB0cnVlLAogICAgICAvLyDmmL7npLrmkJzntKLmnaHku7YKICAgICAgc2hvd1NlYXJjaDogdHJ1ZSwKICAgICAgLy8g5oC75p2h5pWwCiAgICAgIHRvdGFsOiAwLAogICAgICAvLyDlkIjlkIzkv67mlLnorrDlvZXooajmoLzmlbDmja4KICAgICAgcmVjb3JkTGlzdDogW10sCiAgICAgIC8vIOa1geeoi+e8luWPt+aVsOe7hAogICAgICBwcm9jbG5zSWRzczogW10sCiAgICAgIC8vIOW8ueWHuuWxguagh+mimAogICAgICB0aXRsZTogIiIsCiAgICAgIC8vIOaYr+WQpuaYvuekuuW8ueWHuuWxggogICAgICBvcGVuOiBmYWxzZSwKICAgICAgLy8g5p+l6K+i5Y+C5pWwCiAgICAgIHF1ZXJ5UGFyYW1zOiB7CiAgICAgICAgcGFnZU5vOiAxLAogICAgICAgIHBhZ2VTaXplOiAzMCwKICAgICAgICBjb21wQ29kZTogbnVsbCwKICAgICAgICBkZXB0Q29kZTogbnVsbCwKICAgICAgICBzeXN0ZW1JZDogIlBNUyIsCiAgICAgICAgdXNlcklkOiB0aGlzLiRzdG9yZS5zdGF0ZS51c2VyLnVzZXJJbmZvLnVzZXJJZAogICAgICB9LAogICAgICAvLyDooajljZXlj4LmlbAKICAgICAgZm9ybToge30sCiAgICAgIC8vIOihqOWNleagoemqjAogICAgICBydWxlczoge30sCiAgICAgIGNvbXBvbmVudElkOiAiIiwKICAgICAgc2VsZWN0aW9uUm93OiBbXQogICAgfTsKICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmdldExpc3QoKTsKICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgdGhpcy5yZXNpemVIYW5kbGVyKCk7CiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJyZXNpemUiLCB0aGlzLnJlc2l6ZUhhbmRsZXIpOwogICAgfSk7CiAgfSwKICBjb21wdXRlZDogewogICAgbGlzdERhdGEoKSB7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5hcHAuc2lkZWJhci5vcGVuZWQ7CiAgICB9CiAgfSwKICB3YXRjaDogewogICAgbGlzdERhdGEodmFsKSB7CiAgICAgIHZhciB0aGF0ID0gdGhpczsKICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgICAgICB0aGF0LnJlc2l6ZUhhbmRsZXIoKTsKICAgICAgfSwgMzAwKTsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGhhbmRsZVNvcnRDaGFuZ2UoY29sdW1uLCBwcm9wLCBvcmRlcikgewogICAgICB0aGlzLnF1ZXJ5UGFyYW1zLm9yZGVyQnlDb2x1bW4gPSBjb2x1bW4ucHJvcDsKICAgICAgdGhpcy5xdWVyeVBhcmFtcy5pc0FzYyA9IGNvbHVtbi5vcmRlcjsKICAgICAgdGhpcy5nZXRMaXN0KCk7CiAgICB9LAogICAgcmVzaXplSGFuZGxlcigpIHsKICAgICAgbGV0IGEgPSB0aGlzLiRyZWZzLnNlYXJjaC5vZmZzZXRIZWlnaHQ7CiAgICAgIGxldCBiID0gdGhpcy4kcmVmcy5idG5zLm9mZnNldEhlaWdodDsKICAgICAgbGV0IGggPSBhICsgYiArIHRoaXMuJHN0b3JlLnN0YXRlLnNldHRpbmdzLnRhYmxlSGVpZ2h0OwogICAgICBoID0gaCArICJweCI7CiAgICAgIHRoaXMudGFibGVIZWlnaHQgPSBgY2FsYygxMDB2aCAtICR7aH0pYDsKICAgIH0sCiAgICAvKiog5p+l6K+i5ZCI5ZCM5L+u5pS56K6w5b2V5YiX6KGoICovCiAgICBnZXRMaXN0KCkgewogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlOwogICAgICBsaXN0QWxyZWFkeSh0aGlzLnF1ZXJ5UGFyYW1zKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICBpZiAocmVzcG9uc2UuY29kZSA9PSAyMDApIHsKICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLmxpc3QgPT0gbnVsbCB8fCByZXNwb25zZS5kYXRhLmxpc3QgPT0gIiIpIHsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMucmVjb3JkTGlzdCA9IHJlc3BvbnNlLmRhdGEubGlzdDsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMudG90YWwgPSByZXNwb25zZS5kYXRhLmNvdW50OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLm1zZ0Vycm9yKHJlc3BvbnNlLm1zZyk7CiAgICAgICAgfQogICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgICB9KTsKICAgIH0sCiAgICAvKiog5Yi35paw5oyJ6ZKu5pON5L2cICovCiAgICBoYW5kbGVRdWVyeSgpIHsKICAgICAgdGhpcy5xdWVyeVBhcmFtcy5wYWdlTnVtID0gMTsKICAgICAgdGhpcy5nZXRMaXN0KCk7CiAgICB9LAogICAgLy8g54K55Ye76KGMCiAgICBoYW5kbGVSb3dDbGljayhyb3cpIHsKICAgICAgbGV0IHJlY29yZExpc3RUYWJsZSA9IHRoaXMuJHJlZnMucmVjb3JkTGlzdFRhYmxlOwogICAgICBsZXQgZmluZFJvdyA9IHRoaXMuc2VsZWN0aW9uUm93LmZpbmQoYyA9PiBjLnByb2NJbnNJZCA9PSByb3cucHJvY0luc0lkKTsKICAgICAgaWYgKGZpbmRSb3cpIHsKICAgICAgICByZWNvcmRMaXN0VGFibGUudG9nZ2xlUm93U2VsZWN0aW9uKHJvdywgZmFsc2UpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICByZWNvcmRMaXN0VGFibGUuY2xlYXJTZWxlY3Rpb24oKTsgLy/muIXnqbrliJfooajnmoTpgInkuK0KICAgICAgcmVjb3JkTGlzdFRhYmxlLnRvZ2dsZVJvd1NlbGVjdGlvbihyb3csIHRydWUpOwogICAgfSwKICAgIC8vIOWkmumAieahhumAieS4reaVsOaNrgogICAgaGFuZGxlU2VsZWN0aW9uQ2hhbmdlKHNlbGVjdGlvbikgewogICAgICBsZXQgcmVjb3JkTGlzdFRhYmxlID0gdGhpcy4kcmVmcy5yZWNvcmRMaXN0VGFibGU7CiAgICAgIGlmIChzZWxlY3Rpb24ubGVuZ3RoID4gMSkgewogICAgICAgIHJlY29yZExpc3RUYWJsZS5jbGVhclNlbGVjdGlvbigpOyAvL+a4heepuuWIl+ihqOeahOmAieS4rQogICAgICAgIHJlY29yZExpc3RUYWJsZS50b2dnbGVSb3dTZWxlY3Rpb24oCiAgICAgICAgICBzZWxlY3Rpb25bc2VsZWN0aW9uLmxlbmd0aCAtIDFdLAogICAgICAgICAgdHJ1ZQogICAgICAgICk7IC8v5Y+q5pi+56S66YCJ5Lit5pyA5ZCO5LiA5LiqIOi/meaXtnNlbGVjdGlvbui/mOaYr+WkmumAieeahOWIl+ihqCjlsLHmmK/kvaDpgInkuK3nmoTlh6DkuKrmlbDmja4pCiAgICAgICAgc2VsZWN0aW9uID0gQXJyYXkoc2VsZWN0aW9uW3NlbGVjdGlvbi5sZW5ndGggLSAxXSk7CiAgICAgIH0gZWxzZSBpZiAoc2VsZWN0aW9uLmxlbmd0aCA9PT0gMSkgewogICAgICAgIHNlbGVjdGlvbiA9IEFycmF5KHNlbGVjdGlvbltzZWxlY3Rpb24ubGVuZ3RoIC0gMV0pOwogICAgICB9IGVsc2UgewogICAgICAgIHNlbGVjdGlvbiA9IFtdOwogICAgICB9CiAgICAgIC8vIOaWueS+v+eCueWHu+ihjOWPlua2iOmAieS4rQogICAgICB0aGlzLnNlbGVjdGlvblJvdyA9IHNlbGVjdGlvbjsKICAgICAgLy8g6K6+572u6KGM6auY5LquCiAgICAgIHJlY29yZExpc3RUYWJsZS5zZXRDdXJyZW50Um93KHNlbGVjdGlvblswXSk7CgogICAgICB0aGlzLnNpbmdsZSA9IHNlbGVjdGlvbi5sZW5ndGggIT09IDE7CiAgICAgIHRoaXMubXVsdGlwbGUgPSAhc2VsZWN0aW9uLmxlbmd0aDsKICAgICAgdGhpcy5wcm9jbG5zSWRzcyA9IHNlbGVjdGlvbi5tYXAoaXRlbSA9PiBpdGVtLnByb2NJbnNJZCk7CiAgICB9LAogICAgLy8g5Y+W5raI5oyJ6ZKuCiAgICBjYW5jZWwoZmxhZykgewogICAgICB0aGlzLm9wZW4gPSBmbGFnOwogICAgfSwKICAgIHN1Ym1pdFN1Y2Nlc3MoZmxhZykgewogICAgICB0aGlzLm9wZW4gPSBmbGFnOwogICAgICB0aGlzLmdldExpc3QoKTsKICAgIH0sCiAgICAvKiog5rWB6L2s5Y6G5Y+y5Yid5aeL5YyWICovCiAgICBwcm9jZXNzRXhhbWluZUZvcm0oKSB7CiAgICAgIHRoaXMuc3JjID0KICAgICAgICBgJHt0aGlzLnByb2Nlc3NVcmx9L2FwaS93Zi9wcm9jZXNzSGlzdG9yaWM/cHJvY0luc0lkPSR7dGhpcy5wcm9jbG5zSWRzc1swXX1gOwogICAgfSwKICAgIC8qKiDmtYHovazljoblj7LmjInpkq7mk43kvZwgKi8KICAgIHByb2Nlc3NFeGFtaW5lKCkgewogICAgICBjb25zb2xlLmxvZyh0aGlzLnByb2NsbnNJZHNzWzBdKTsKICAgICAgaWYgKHRoaXMucHJvY2xuc0lkc3NbMF0gPT0gbnVsbCB8fCAhdGhpcy5wcm9jbG5zSWRzc1swXSkgewogICAgICAgIHRoaXMubXNnRXJyb3IoIuayoeaciea1gei9rOWOhuWPsuaVsOaNru+8gSIpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMucHJvY2Vzc0V4YW1pbmVGb3JtKCk7CiAgICAgICAgdGhpcy5wcm9jZXNzT3BlbiA9IHRydWU7CiAgICAgIH0KICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyCA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/backlog/already","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <div ref=\"btns\" ></div>\n    <div ref=\"search\" >\n      <el-form :model=\"queryParams\" ref=\"queryForm\" :inline=\"true\" v-show=\"showSearch\" label-width=\"68px\">\n        <el-form-item>\n          <el-button type=\"primary\" icon=\"el-icon-edit\" size=\"mini\" :disabled=\"single\" @click=\"processExamine\">流转历史</el-button>\n          <el-button type=\"primary\" icon=\"el-icon-search\" size=\"mini\" @click=\"handleQuery\">刷新</el-button>\n        </el-form-item>\n      </el-form>\n    </div>\n    <el-table  :height=\"tableHeight\" ref=\"recordListTable\" stripe v-loading=\"loading\" :data=\"recordList\" @selection-change=\"handleSelectionChange\" highlight-current-row @row-click=\"handleRowClick\">\n      <el-table-column type=\"selection\" width=\"55\" align=\"center\"/>\n      <!--<el-table-column label=\"任务节点ID\" align=\"center\" prop=\"taskId\" />\n      <el-table-column label=\"流程定义值\" align=\"center\" prop=\"taskDefKey\" />-->\n      <el-table-column label=\"标题\" align=\"left\" prop=\"title\"  width=\"280\"  :sort-orders=\"['descending', 'ascending']\"/>\n      <el-table-column label=\"任务名称\" align=\"left\" prop=\"taskName\"  :sort-orders=\"['descending', 'ascending']\"/>\n      <el-table-column label=\"流程名称\" align=\"left\" prop=\"procName\" />\n      <el-table-column label=\"办理时间\" align=\"center\" prop=\"endTimeStr\"  :sort-orders=\"['descending', 'ascending']\"/>\n    </el-table>\n\n    <pagination\n      v-show=\"total>0\"\n      :total=\"total\"\n      :page.sync=\"queryParams.pageNo\"\n      :limit.sync=\"queryParams.pageSize\"\n      @pagination=\"getList\"\n    />\n\n    <component v-if=\"open\" :is=\"componentUrl\" :id=\"componentId\" :proclnsIds=\"proclnsIds\" :open=\"open\" @cancel=\"cancel\" @success=\"submitSuccess\"></component>\n\n    <!-- 流转历史对话框 -->\n    <el-dialog title=\"流转历史\" :visible.sync=\"processOpen\" width=\"1200px\" append-to-body :close-on-click-modal=\"false\" custom-class=\"el-button--primary\">\n      <div v-loading=\"loading\" :style=\"'height:'+ height\">\n        <iframe :src=\"src\" frameborder=\"no\" style=\"width: 100%;height: 100%\" scrolling=\"auto\" />\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { listAlready } from \"@/api/process/model\";\n\nexport default {\n  name: \"backlog\",\n  data() {\n    return {\n      tableHeight: \"auto\",\n      src: \"\",\n      height: \"500px;\",\n      componentUrl: null,\n      // 遮罩层\n      loading: true,\n      // 导出遮罩层\n      exportLoading: false,\n      // 选中数组\n      procInsIds: [],\n      // 非单个禁用\n      single: true,\n      // 流转历史对话框\n      processOpen: false,\n      // 非多个禁用\n      multiple: true,\n      // 显示搜索条件\n      showSearch: true,\n      // 总条数\n      total: 0,\n      // 合同修改记录表格数据\n      recordList: [],\n      // 流程编号数组\n      proclnsIdss: [],\n      // 弹出层标题\n      title: \"\",\n      // 是否显示弹出层\n      open: false,\n      // 查询参数\n      queryParams: {\n        pageNo: 1,\n        pageSize: 30,\n        compCode: null,\n        deptCode: null,\n        systemId: \"PMS\",\n        userId: this.$store.state.user.userInfo.userId\n      },\n      // 表单参数\n      form: {},\n      // 表单校验\n      rules: {},\n      componentId: \"\",\n      selectionRow: []\n    };\n  },\n  created() {\n    this.getList();\n    this.$nextTick(() => {\n      this.resizeHandler();\n      window.addEventListener(\"resize\", this.resizeHandler);\n    });\n  },\n  computed: {\n    listData() {\n      return this.$store.state.app.sidebar.opened;\n    }\n  },\n  watch: {\n    listData(val) {\n      var that = this;\n      setTimeout(function() {\n        that.resizeHandler();\n      }, 300);\n    }\n  },\n  methods: {\n    handleSortChange(column, prop, order) {\n      this.queryParams.orderByColumn = column.prop;\n      this.queryParams.isAsc = column.order;\n      this.getList();\n    },\n    resizeHandler() {\n      let a = this.$refs.search.offsetHeight;\n      let b = this.$refs.btns.offsetHeight;\n      let h = a + b + this.$store.state.settings.tableHeight;\n      h = h + \"px\";\n      this.tableHeight = `calc(100vh - ${h})`;\n    },\n    /** 查询合同修改记录列表 */\n    getList() {\n      this.loading = true;\n      listAlready(this.queryParams).then(response => {\n        if (response.code == 200) {\n          if (response.data.list == null || response.data.list == \"\") {\n          } else {\n            this.recordList = response.data.list;\n          }\n          this.total = response.data.count;\n        } else {\n          this.msgError(response.msg);\n        }\n        this.loading = false;\n      });\n    },\n    /** 刷新按钮操作 */\n    handleQuery() {\n      this.queryParams.pageNum = 1;\n      this.getList();\n    },\n    // 点击行\n    handleRowClick(row) {\n      let recordListTable = this.$refs.recordListTable;\n      let findRow = this.selectionRow.find(c => c.procInsId == row.procInsId);\n      if (findRow) {\n        recordListTable.toggleRowSelection(row, false);\n        return;\n      }\n      recordListTable.clearSelection(); //清空列表的选中\n      recordListTable.toggleRowSelection(row, true);\n    },\n    // 多选框选中数据\n    handleSelectionChange(selection) {\n      let recordListTable = this.$refs.recordListTable;\n      if (selection.length > 1) {\n        recordListTable.clearSelection(); //清空列表的选中\n        recordListTable.toggleRowSelection(\n          selection[selection.length - 1],\n          true\n        ); //只显示选中最后一个 这时selection还是多选的列表(就是你选中的几个数据)\n        selection = Array(selection[selection.length - 1]);\n      } else if (selection.length === 1) {\n        selection = Array(selection[selection.length - 1]);\n      } else {\n        selection = [];\n      }\n      // 方便点击行取消选中\n      this.selectionRow = selection;\n      // 设置行高亮\n      recordListTable.setCurrentRow(selection[0]);\n\n      this.single = selection.length !== 1;\n      this.multiple = !selection.length;\n      this.proclnsIdss = selection.map(item => item.procInsId);\n    },\n    // 取消按钮\n    cancel(flag) {\n      this.open = flag;\n    },\n    submitSuccess(flag) {\n      this.open = flag;\n      this.getList();\n    },\n    /** 流转历史初始化 */\n    processExamineForm() {\n      this.src =\n        `${this.processUrl}/api/wf/processHistoric?procInsId=${this.proclnsIdss[0]}`;\n    },\n    /** 流转历史按钮操作 */\n    processExamine() {\n      console.log(this.proclnsIdss[0]);\n      if (this.proclnsIdss[0] == null || !this.proclnsIdss[0]) {\n        this.msgError(\"没有流转历史数据！\");\n      } else {\n        this.processExamineForm();\n        this.processOpen = true;\n      }\n    }\n  }\n};\n</script>\n"]}]}