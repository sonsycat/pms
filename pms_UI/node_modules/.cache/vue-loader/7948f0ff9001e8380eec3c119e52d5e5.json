{"remainingRequest":"F:\\pms_UI\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\pms_UI\\src\\views\\revenue\\special\\index.vue?vue&type=style&index=0&id=5199851f&lang=scss&scoped=true&","dependencies":[{"path":"F:\\pms_UI\\src\\views\\revenue\\special\\index.vue","mtime":1693362205934},{"path":"F:\\pms_UI\\node_modules\\css-loader\\dist\\cjs.js","mtime":1693361949271},{"path":"F:\\pms_UI\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1693362179282},{"path":"F:\\pms_UI\\node_modules\\postcss-loader\\src\\index.js","mtime":1693362110683},{"path":"F:\\pms_UI\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1693362152666},{"path":"F:\\pms_UI\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1693361924439},{"path":"F:\\pms_UI\\node_modules\\vue-loader\\lib\\index.js","mtime":1693362179279}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCjo6di1kZWVwewogIC5lbC10YWJsZV9fYm9keS13cmFwcGVyLmlzLXNjcm9sbGluZy1sZWZ0ewogICAgICBoZWlnaHQ6YXV0byAhaW1wb3J0YW50OwogICAgICBtYXgtaGVpZ2h0OmNhbGMoMTAwdmggLSAzMjZweCkgIWltcG9ydGFudDsKICAgIH0KICAgIC5lbC10YWJsZV9fYm9keS13cmFwcGVyLmlzLXNjcm9sbGluZy1taWRkbGV7CiAgICAgIG1heC1oZWlnaHQ6Y2FsYygxMDB2aCAtIDMyNnB4KSAhaW1wb3J0YW50OwogICAgICBoZWlnaHQ6YXV0byAhaW1wb3J0YW50OwogICAgfQogICAgLmVsLXRhYmxlX19ib2R5LXdyYXBwZXIuaXMtc2Nyb2xsaW5nLXJpZ2h0ewogICAgICBoZWlnaHQ6YXV0byAhaW1wb3J0YW50OwogICAgICBtYXgtaGVpZ2h0OmNhbGMoMTAwdmggLSAzMjZweCkgIWltcG9ydGFudDsKICAgIH0KfQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/revenue/special","sourcesContent":["<template>\n  <div class=\"app-container\">\n  <div ref=\"search\">\n    <el-form :model=\"queryParams\" ref=\"queryForm\" :inline=\"true\" v-show=\"showSearch\">\n      <el-form-item label=\"项目名称\" prop=\"revenueCode\">\n        <el-select class=\"search_w220\" v-model=\"queryParams.revenueCode\" filterable clearable placeholder=\"请选择项目名称\" >\n          <el-option\n            v-for=\"dict in revenueList\"\n            :key=\"dict.dictValue\"\n            :label=\"dict.dictLabel\"\n            :value=\"dict.dictValue\"\n          ></el-option>\n        </el-select>\n      </el-form-item>\n      <el-form-item label=\"开单科室\" prop=\"billDept\">\n        <el-select class=\"search_w220\" v-model=\"queryParams.billDept\" filterable clearable placeholder=\"请选择开单科室\" >\n          <el-option\n            v-for=\"dict in deptList\"\n            :key=\"dict.deptRoomId\"\n            :label=\"dict.deptRoomName\"\n            :value=\"dict.deptRoomId\"\n          ></el-option>\n          <!--            :value=\"Number(dict.dictValue)\"-->\n        </el-select>\n      </el-form-item>\n      <el-form-item label=\"执行科室\" prop=\"execDept\">\n        <el-select class=\"search_w220\" v-model=\"queryParams.execDept\" filterable clearable placeholder=\"请选择执行科室\" >\n          <el-option\n            v-for=\"dict in deptList\"\n            :key=\"dict.deptRoomId\"\n            :label=\"dict.deptRoomName\"\n            :value=\"dict.deptRoomId\"\n          ></el-option>\n        </el-select>\n      </el-form-item>\n      <el-form-item>\n        <el-button type=\"primary\" icon=\"el-icon-search\" size=\"mini\" @click=\"handleQuery\">搜索</el-button>\n        <el-button icon=\"el-icon-refresh\" size=\"mini\" @click=\"resetQuery\">重置</el-button>\n      </el-form-item>\n    </el-form>\n\t</div>\n\t<div ref=\"btns\">\n    <el-row :gutter=\"10\" class=\"mb8\">\n      <el-col :span=\"1.5\">\n        <el-button\n          size=\"mini\"\n          type=\"primary\"\n          icon=\"el-icon-refresh\"\n          @click=\"handleRefresh\"\n        >刷新</el-button>\n      </el-col>\n      <el-col :span=\"1.5\">\n        <el-button\n          type=\"primary\"\n          icon=\"el-icon-box\"\n          size=\"mini\"\n          @click=\"handleSave\"\n        >保存</el-button>\n      </el-col>\n      <el-col :span=\"1.5\">\n        <el-button\n          type=\"primary\"\n          icon=\"el-icon-plus\"\n          size=\"mini\"\n          @click=\"handleAddTable\"\n        >添加行</el-button>\n      </el-col>\n\n      <el-col :span=\"1.5\">\n        <el-button\n          type=\"primary\"\n          icon=\"el-icon-plus\"\n          size=\"mini\"\n          :disabled=\"single\"\n          @click=\"handleDept\"\n        >科室设置</el-button>\n      </el-col>\n      <right-toolbar :showSearch.sync=\"showSearch\" @queryTable=\"getList\"></right-toolbar>\n    </el-row>\n\t</div>\n\n    <el-table border v-loading=\"loading\" :height=\"tableHeight\" :data=\"specialList\" @selection-change=\"handleSelectionChange\" ref=\"multipleTable\" @row-click=\"rowClick\" :row-style=\"rowStyle\" :row-class-name=\"rowClassName\">\n      <el-table-column type=\"selection\" width=\"55\" align=\"center\" />\n      <el-table-column sortable label=\"项目名称\" align=\"center\" prop=\"revenueCode\" width=\"160px\" fixed=\"left\">\n        <template slot-scope=\"scope\">\n          <el-select v-model=\"scope.row.revenueCode\" filterable clearable placeholder=\"请选择项目名称\" @change=\"changeRow(scope.row)\" >\n            <el-option\n              v-for=\"dict in revenueList\"\n              :key=\"dict.dictValue\"\n              :label=\"dict.dictLabel\"\n              :value=\"dict.dictValue\"\n            ></el-option>\n          </el-select>\n        </template>\n      </el-table-column>\n      <el-table-column sortable label=\"开单科室\" align=\"center\" prop=\"billDept\" width=\"160px\" fixed=\"left\">\n        <template slot-scope=\"scope\">\n          <el-select v-model=\"scope.row.billDept\" filterable clearable placeholder=\"请选择开单科室\" @change=\"changeRow(scope.row)\" >\n            <el-option\n              v-for=\"dict in deptList\"\n              :key=\"dict.deptRoomId\"\n              :label=\"dict.deptRoomName\"\n              :value=\"dict.deptRoomId\"\n            ></el-option>\n          </el-select>\n        </template>\n      </el-table-column>\n      <el-table-column sortable label=\"执行科室\" align=\"center\" prop=\"execDept\" width=\"160px\" fixed=\"left\">\n        <template slot-scope=\"scope\">\n          <el-select v-model=\"scope.row.execDept\" filterable clearable placeholder=\"请选择执行科室\" @change=\"changeRow(scope.row)\" >\n            <el-option\n              v-for=\"dict in deptList\"\n              :key=\"dict.deptRoomId\"\n              :label=\"dict.deptRoomName\"\n              :value=\"dict.deptRoomId\"\n            ></el-option>\n          </el-select>\n        </template>\n      </el-table-column>\n      <el-table-column sortable label=\"住院开单\" align=\"center\" prop=\"inpBill\" width=\"120px\" >\n        <template slot-scope=\"scope\">\n          <div @click.stop.prevent style=\"display:inline\">\n          <el-input-number :precision=\"2\" :disabled=\"checkedNumFlag2\" controls-position=\"right\" :min=\"0\" :max=\"100\" v-model=\"scope.row.inpBill\" class=\"w100\" @change=\"changeRow(scope.row)\"></el-input-number>\n          </div>\n        </template>\n      </el-table-column>\n      <el-table-column sortable label=\"住院执行\" align=\"center\" prop=\"inpExec\" width=\"120px\" >\n        <template slot-scope=\"scope\">\n          <div @click.stop.prevent style=\"display:inline\">\n          <el-input-number :precision=\"2\" :disabled=\"checkedNumFlag2\" controls-position=\"right\" :min=\"0\" :max=\"100\" v-model=\"scope.row.inpExec\" class=\"w100\" @change=\"changeRow(scope.row)\"></el-input-number>\n          </div>\n        </template>\n      </el-table-column>\n      <el-table-column sortable label=\"住院护理\" align=\"center\" prop=\"inpCare\" width=\"120px\" >\n        <template slot-scope=\"scope\">\n          <div @click.stop.prevent style=\"display:inline\">\n          <el-input-number :precision=\"2\" :disabled=\"checkedNumFlag2\" controls-position=\"right\" :min=\"0\" :max=\"100\" v-model=\"scope.row.inpCare\" class=\"w100\" @change=\"changeRow(scope.row)\"></el-input-number>\n          </div>\n        </template>\n      </el-table-column>\n      <el-table-column sortable label=\"门诊开单\" align=\"center\" prop=\"outpBill\" width=\"120px\" >\n        <template slot-scope=\"scope\">\n          <div @click.stop.prevent style=\"display:inline\">\n          <el-input-number :precision=\"2\" :disabled=\"checkedNumFlag2\" controls-position=\"right\" :min=\"0\" :max=\"100\" v-model=\"scope.row.outpBill\" class=\"w100\" @change=\"changeRow(scope.row)\"></el-input-number>\n          </div>\n        </template>\n      </el-table-column>\n      <el-table-column sortable label=\"门诊执行\" align=\"center\" prop=\"outpExec\" width=\"120px\" >\n        <template slot-scope=\"scope\">\n          <div @click.stop.prevent style=\"display:inline\">\n          <el-input-number :precision=\"2\" :disabled=\"checkedNumFlag2\" controls-position=\"right\" :min=\"0\" :max=\"100\" v-model=\"scope.row.outpExec\" class=\"w100\" @change=\"changeRow(scope.row)\"></el-input-number>\n          </div>\n        </template>\n      </el-table-column>\n      <el-table-column sortable label=\"门诊护理\" align=\"center\" prop=\"outpCare\" width=\"120px\" >\n        <template slot-scope=\"scope\">\n          <div @click.stop.prevent style=\"display:inline\">\n          <el-input-number :precision=\"2\" :disabled=\"checkedNumFlag2\" controls-position=\"right\" :min=\"0\" :max=\"100\" v-model=\"scope.row.outpCare\" class=\"w100\" @change=\"changeRow(scope.row)\"></el-input-number>\n          </div>\n        </template>\n      </el-table-column>\n      <el-table-column sortable label=\"合作医疗\" align=\"center\" prop=\"coopMed\" width=\"120px\" >\n        <template slot-scope=\"scope\">\n          <div @click.stop.prevent style=\"display:inline\">\n          <el-input-number :precision=\"2\" controls-position=\"right\" :min=\"0\" :max=\"100\" v-model=\"scope.row.coopMed\" class=\"w100\" @change=\"changeRow(scope.row)\"></el-input-number>\n          </div>\n        </template>\n      </el-table-column>\n      <el-table-column sortable label=\"成本对照\" align=\"center\" prop=\"projectCode\" width=\"160px\" >\n        <template slot-scope=\"scope\">\n          <el-select v-model=\"scope.row.projectCode\" clearable placeholder=\"请选择成本对照\" @change=\"changeRow(scope.row)\" >\n            <el-option\n              v-for=\"dict in projectList\"\n              :key=\"dict.dictValue\"\n              :label=\"dict.dictLabel\"\n              :value=\"dict.dictValue\"\n            ></el-option>\n          </el-select>\n        </template>\n      </el-table-column>\n      <el-table-column sortable label=\"固定折算\" align=\"center\" prop=\"fixConv\" width=\"120px\" >\n        <template slot-scope=\"scope\">\n          <div @click.stop.prevent style=\"display:inline\">\n          <el-input-number :precision=\"2\" controls-position=\"right\" :min=\"0\" :max=\"100\" v-model=\"scope.row.fixConv\" class=\"w100\" @change=\"changeRow(scope.row)\"></el-input-number>\n          </div>\n        </template>\n      </el-table-column>\n      <el-table-column sortable label=\"收入类别\" align=\"center\" prop=\"hisRevenumTypede\" width=\"150px\" >\n        <template slot-scope=\"scope\">\n          <el-select v-model=\"scope.row.hisRevenumTypede\" clearable placeholder=\"请选择项目名称\" @change=\"changeRow(scope.row)\" >\n            <el-option\n              v-for=\"dict in hisIncomeList\"\n              :key=\"dict.dictValue\"\n              :label=\"dict.dictLabel\"\n              :value=\"dict.dictValue\"\n            ></el-option>\n          </el-select>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"操作\" fixed=\"right\" align=\"center\">\n        <template slot-scope=\"scope\">\n          <el-button\n            size=\"mini\"\n            icon=\"el-icon-delete\" circle\n            type=\"danger\"\n            @click=\"handleAddDelete(scope.$index, scope.row)\"></el-button>\n        </template>\n      </el-table-column>\n      <el-table-column prop=\"isError\" v-if=\"false\"></el-table-column>\n    </el-table>\n\n    <pagination\n      v-show=\"total>0\"\n      :total=\"total\"\n      :page.sync=\"queryParams.pageNum\"\n      :limit.sync=\"queryParams.pageSize\"\n      @pagination=\"getList\"\n    />\n\n\t<addEdit v-if=\"open\" :open=\"open\" :id=\"addEditId\" @cancel=\"cancel\" @success=\"successSubmit\"></addEdit>\n\n  <dept v-if=\"openDept\" :open=\"openDept\" :id=\"addEditId\" @cancel=\"cancelDept\" @success=\"successSubmitDept\"></dept>\n\n  </div>\n</template>\n\n<script>\nimport { listSpecial, getSpecial, delSpecial, addSpecial, updateSpecial, exportSpecial,getRevenue,getProject,getIncome,refresh,getSpecialCode,save } from \"@/api/revenue/special\";\nimport { listSpecialTemp, getSpecialTemp, delSpecialTemp, addSpecialTemp, updateSpecialTemp, exportSpecialTemp } from \"@/api/revenue/specialTemp\";\nimport addEdit from \"./addEdit\";\nimport dept from \"./dept\";\nimport {getConfigKeyApi} from \"@/api/system/config\";\nimport { truncate } from 'fs';\nimport { treeRoom } from '@/api/until'\n\nexport default {\n  name: \"Special\",\n  components: {\naddEdit,dept\n  },\n  data() {\n    return {\n      checkedNumFlag2:false,\n      openDept: false,\n      // 遮罩层\n      loading: true,\n      // 导出遮罩层\n      exportLoading: false,\n      // 选中数组\n      ids: [],\n      // 非单个禁用\n      single: true,\n      // 非多个禁用\n      multiple: true,\n      // 显示搜索条件\n      showSearch: true,\n      // 总条数\n      total: 0,\n      // 特殊收入项目方案表格数据\n      specialList: [],\n      selectionRow: [],\n      // 弹出层标题\n      title: \"\",\n      // 是否显示弹出层\n      open: false,\n      // 查询参数\n      queryParams: {\n        pageNum: 1,\n        pageSize: 30,\n        compCode: this.$store.state.user.userInfo.deptId,\n        accountCode: null,\n        specialCode: null,\n        revenueCode: null,\n        revenueName: null,\n        billDept: null,\n        execDept: null,\n      },\n      // 表单参数\n      form: {},\n      // 表单校验\n      rules: {\n      },\n      //科室字典\n      deptList: [],\n      //收入核算方案\n      revenueList: [],\n      //成本项目字典\n      projectList: [],\n      //his收入类别字典\n      hisIncomeList: [],\n      tableHeight: \"auto\",\n      isAddChecked:true,\n      checkedNum:null,\n      checkedNumFlag:false,\n      checkedItem:false,\n      isOnlyDeptCode:false,\n      fixConvBool:false,\n    };\n  },\n  created() {\n    refresh(this.queryParams).then(()=>{\n      this.getList();\n    });\n    getRevenue(this.$store.state.user.userInfo.deptId).then(res=>{\n      this.revenueList = res.data;\n    });\n    getProject(this.$store.state.user.userInfo.deptId).then(res=>{\n      this.projectList = res.data;\n    });\n    getIncome(this.$store.state.user.userInfo.deptId).then(res=>{\n      this.hisIncomeList = res.data;\n    });\n    getConfigKeyApi(\"SFSRSBFT\").then(res=>{\n      this.checkedNum=res\n      if (this.checkedNum == '0') {\n        this.checkedNumFlag2 = true;\n      }\n    });\n    this.$nextTick(() => {\n      this.resizeHandler();\n      window.addEventListener(\"resize\", this.resizeHandler);\n    });\n\n    this.getDeptList(this.$store.state.user.userInfo.deptId);\n  },\n  computed: {\n    listData() {\n      return this.$store.state.app.sidebar.opened;\n    }\n  },\n  watch: {\n    \"$store.state.dicts\": {\n      handler(val) {\n        // 基础字典\n        let baseDicts = val.baseDicts;\n        // this.deptList = val.deptInfo;\n      },\n      deep: true,\n      immediate: true\n    },\n    listData(val) {\n      var that = this;\n      setTimeout(function() {\n        that.resizeHandler();\n      }, 300);\n    }\n  },\n  methods: {\n    //获取开单科室\n    getDeptList(deptId){\n      let data={deptId:deptId}\n      treeRoom(data).then(response=>{\n        if(response.code==200){\n          this.deptList=JSON.parse(JSON.stringify(response.rows))\n        }\n      })\n    },\n    successSubmitDept(flag) {\n      this.openDept = flag;\n      this.getList();\n    },\n    // 取消按钮\n    cancelDept() {\n      this.openDept = false;\n      this.reset();\n    },\n    handleDept(row) {\n      this.reset();\n      const id = row.id || this.ids[0];\n      this.openDept = true;\n      this.addEditId = id; // id赋值\n      console.log(\"addEditId---\" + addEdit);\n    },\n    resizeHandler() {\n      let a = this.$refs.search.offsetHeight;\n      let b = this.$refs.btns.offsetHeight;\n      let h = a + b + 18 + 45 + 84 + 40 + 20;\n      h = h + \"px\";\n      this.tableHeight = `calc(100vh - ${h})`;\n    },\n    /** 查询特殊收入项目方案列表 */\n    getList() {\n      this.loading = true;\n      listSpecialTemp(this.queryParams).then(response => {\n        this.specialList = response.rows;\n        this.total = response.total;\n        this.loading = false;\n          this.specialList.forEach(i=>{\n            i.isError = 1;\n          })\n      });\n    },\n\tsuccessSubmit(flag) {\n      this.open = flag;\n      this.getList();\n    },\n    // 取消按钮\n    cancel() {\n      this.open = false;\n      this.reset();\n    },\n    // 表单重置\n    reset() {\n      this.form = {\n        id: null,\n        compCode: this.$store.state.user.userInfo.deptId,\n        accountCode: null,\n        specialCode: null,\n        revenueCode: null,\n        revenueName: null,\n        billDept: null,\n        execDept: null,\n        inpBill: null,\n        inpExec: null,\n        inpCare: null,\n        outpBill: null,\n        outpExec: null,\n        outpCare: null,\n        coopMed: null,\n        accountType: null,\n        convRatio: null,\n        fixConv: null,\n        projectCode: null,\n        hisRevenumTypede: null,\n        delFlag: null,\n        createBy: null,\n        createTime: null,\n        updateBy: null,\n        updateTime: null,\n        remark: null\n      };\n      this.resetForm(\"form\");\n    },\n    /** 搜索按钮操作 */\n    handleQuery() {\n      this.queryParams.pageNum = 1;\n      this.getList();\n    },\n    /** 重置按钮操作 */\n    resetQuery() {\n      this.resetForm(\"queryForm\");\n      this.handleQuery();\n    },\n    // 多选框选中数据\n    handleSelectionChange(selection) {\n      this.ids = selection.map(item => item.id)\n      this.single = selection.length!==1\n      this.multiple = !selection.length\n      this.selectionRow=selection\n    },\n    rowClick(row, column, event) {\n      let refsElTable = this.$refs.multipleTable;\n      let findRow = this.selectionRow.find(c => c.rowIndex == row.rowIndex);\n      if (findRow && this.selectionRow.length == 1) {\n        refsElTable.toggleRowSelection(row, false);\n        return;\n      }\n      refsElTable.clearSelection();\n      refsElTable.toggleRowSelection(row);\n    },\n    rowStyle({\n      row,\n      rowIndex\n    }) {\n      Object.defineProperty(row, 'rowIndex', {\n        value: rowIndex,\n        writable: true,\n        enumerable: false\n      })\n    },\n    rowClassName({row, rowIndex}) {\n      if(row && row.isError==0){\n        return \"warning-row \"\n      }else {\n        if (rowIndex % 2 === 1) {\n          return \"striped\";\n        } else {\n          return \"\";\n        }\n      }\n    },\n    /** 新增添加行 */\n    handleAddTable() {\n      let saveLoading = this.saveLoading();\n      getSpecialCode(this.queryParams).then(response=>{\n        let tablCol={\n          id: response.data.id,\n          compCode: this.$store.state.user.userInfo.deptId,\n          specialCode: response.data.specialCode,\n          revenueCode: null,\n          revenueName: null,\n          billDept: null,\n          execDept: null,\n          inpBill: null,\n          inpExec: null,\n          inpCare: null,\n          outpBill: null,\n          outpExec: null,\n          outpCare: null,\n          coopMed: null,\n          convRatio: null,\n          fixConv: null,\n          projectCode: null,\n          hisRevenumTypede: null,\n          type: '1',\n          isError: 1\n        }\n        if (this.checkedNum == '0') {\n          tablCol={\n            id: response.data.id,\n            compCode: this.$store.state.user.userInfo.deptId,\n            specialCode: response.data.specialCode,\n            revenueCode: null,\n            revenueName: null,\n            billDept: null,\n            execDept: null,\n            inpBill: '100',\n            inpExec: '100',\n            inpCare: '0',\n            outpBill: '100',\n            outpExec: '100',\n            outpCare: '0',\n            coopMed: null,\n            convRatio: null,\n            fixConv: null,\n            projectCode: null,\n            hisRevenumTypede: null,\n            type: '1',\n            isError: 1\n          }\n        }\n        this.specialList.push(tablCol);\n        this.tableScrollLeft(\"multipleTable\")\n        saveLoading.close();\n      })\n    },\n    handleAddDelete(idx,row) {\n      this.specialList.splice(idx, 1);\n      delSpecialTemp(row).then(()=>{\n\n      })\n    },\n    handleUpdate(row) {\n      this.reset();\n      const id = row.id || this.ids[0];\n      this.open = true;\n      this.addEditId = id; // id赋值\n      console.log(\"addEditId---\" + addEdit);\n    },\n    /** 刷新按钮操作 */\n    handleRefresh() {\n      this.$confirm('确定刷新当前数据吗，未保存数据即将清空！', \"警告\", {\n          confirmButtonText: \"确定\",\n          cancelButtonText: \"取消\",\n          type: \"warning\"\n        }).then(() => {\n          let saveLoading = this.saveLoading();\n          refresh(this.queryParams).then(()=>{\n            this.getList();\n            this.msgSuccess(\"刷新成功\");\n            saveLoading.close();\n          })\n        }).catch(() => {});\n    },\n    changeRow(row){\n      let saveLoading = this.saveLoading();\n      updateSpecialTemp(row).then(()=>{\n        saveLoading.close();\n      })\n    },\n    checkedData(){\n      if(this.checkedNum==1){\n        if(this.specialList.length>0){\n            this.specialList.forEach(_=>{\n              _.inpNum=_.inpBill + _.inpExec + _.inpCare\n              _.outpNum=_.outpBill + _.outpExec + _.outpCare\n            if(_.inpNum==100 && _.outpNum==100){\n              this.checkedNumFlag=true;\n            }else{\n              this.checkedNumFlag=false;\n              _.isError=0;\n              this.rowClassName(_)\n            }\n          })\n          if(!this.checkedNumFlag){\n            this.msgError(\"分摊比例设置系统参数设置为否，门诊与住院 开单+执行+护理应分别为100\")\n          }\n        }else{\n          this.checkedNumFlag=true;\n        }\n      }else{\n        if(this.specialList.length>0){\n          // this.specialList.forEach(_=>{\n          //   _unNum=_.inpBill + _.outpBill + _.inpExec + _.outpExec;\n          //   if(_unNum==100){\n              this.checkedNumFlag=true;\n          //   }else{\n          //     this.checkedNumFlag=false;\n          //   }\n          // })\n          // if(!this.checkedNumFlag){\n          //   this.msgError(\"门诊和住院开单+执行应为100\")\n          // }\n        }else{\n          this.checkedNumFlag=true;\n        }\n      }\n    },\n    checkedNumFun(){\n      if(this.specialList.length>0){\n        this.specialList.forEach(_=>{\n          _.sum=_.coopMed + _.fixConv;\n          if(_.sum>100){\n            this.isAddChecked=false;\n            _.isError=0;\n              this.rowClassName(_);\n          }else{\n            this.isAddChecked=true;\n          }\n        })\n        if(!this.isAddChecked){\n            this.msgError(\"合作医疗+固定折算比例不能大于100\")\n        }\n      }else{\n          this.isAddChecked=true;\n      }\n    },\n    checkedDataItem(){\n      if(this.specialList.length>0){\n        this.specialList.forEach(_=>{\n          if(_.revenueCode&&_.billDept &&_.execDept&&_.hisRevenumTypede){\n            this.checkedItem=true;\n            if(_.billDept == _.execDept){\n              _.isError=0;\n              this.isOnlyDeptCode=false;\n              this.checkedItem=false;\n            }else{\n              this.isOnlyDeptCode=true;\n              this.checkedItem=true;\n              if(_.fixConv>0){\n                if(_.projectCode){\n                  this.fixConvBool=true;\n                  this.checkedItem=true;\n                }else{\n                  this.fixConvBool=false;\n                  this.checkedItem=false;\n                  _.isError=0;\n                  this.rowClassName(_)\n                }\n              }else{\n                this.fixConvBool=true;\n              }\n            }\n          }else{\n            this.isOnlyDeptCode=true;\n            this.checkedItem= false;\n            this.fixConvBool=true;\n            _.isError=0;\n            this.rowClassName(_)\n          }\n        })\n        if(!this.isOnlyDeptCode){\n          this.msgError(\"开单科室与执行科室不能相同\")\n        }\n        if(!this.fixConvBool){\n          this.msgError(\"固定折算比例大于0，请选择成本对照\")\n        }\n        if(!this.checkedItem && this.isOnlyDeptCode && this.fixConvBool){\n          this.msgError(\"请检查数据是否填写完整\")\n        }\n      }else{\n        this.checkedItem= true;\n      }\n    },\n    handleSave() {\n        this.checkedData()\n        if(this.checkedNumFlag){\n          this.checkedNumFun();\n          if(this.isAddChecked){\n            this.checkedDataItem();\n            if(this.checkedItem){\n              let saveLoading = this.saveLoading();\n              save(this.queryParams).then(()=>{\n                refresh(this.queryParams).then(()=>{\n                  this.getList();\n                  this.msgSuccess(\"保存成功\");\n                  saveLoading.close();\n                })\n              })\n            }\n          }\n        }\n      }\n    }\n};\n</script>\n<style lang=\"scss\" scoped>\n::v-deep{\n  .el-table__body-wrapper.is-scrolling-left{\n      height:auto !important;\n      max-height:calc(100vh - 326px) !important;\n    }\n    .el-table__body-wrapper.is-scrolling-middle{\n      max-height:calc(100vh - 326px) !important;\n      height:auto !important;\n    }\n    .el-table__body-wrapper.is-scrolling-right{\n      height:auto !important;\n      max-height:calc(100vh - 326px) !important;\n    }\n}\n</style>\n\n"]}]}