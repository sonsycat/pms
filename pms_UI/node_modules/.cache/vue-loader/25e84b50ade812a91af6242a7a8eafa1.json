{"remainingRequest":"F:\\pms_UI\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\pms_UI\\src\\views\\components\\orgSearch\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\pms_UI\\src\\views\\components\\orgSearch\\index.vue","mtime":1693362205180},{"path":"F:\\pms_UI\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1693361924439},{"path":"F:\\pms_UI\\node_modules\\babel-loader\\lib\\index.js","mtime":1693361909992},{"path":"F:\\pms_UI\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1693361924439},{"path":"F:\\pms_UI\\node_modules\\vue-loader\\lib\\index.js","mtime":1693362179279}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IHRyZWVzZWxlY3QsIHRyZWVSb29tIH0gZnJvbSAiQC9hcGkvdW50aWwiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogImluZGV4IiwKICBwcm9wczogewogICAgcXVlcnlQYXJhbXM6IE9iamVjdCwKICAgIGxhYmVsOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogIuWNleS9jSIKICAgIH0sCiAgICBzaXplOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogIm1pbmkiCiAgICB9LAogICAgcmVhZG9ubHk6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogZmFsc2UKICAgIH0sCiAgICBjb21wQ29kZTogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICJjb21wQ29kZSIKICAgIH0sCiAgICBjb21wTmFtZTogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICJjb21wTmFtZSIKICAgIH0sCiAgICAvLyDpnIDopoHmuIXnqbrnsbvkvLwg56eR5a6k55qE5YC8CiAgICBkZXB0Q29kZTogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICJkZXB0Q29kZSIKICAgIH0KICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICAvL+WumuS5ieeCueWHu+asoeaVsCzpu5jorqQw5qyhCiAgICAgIHRyZWVDbGlja0NvdW50OiAwLAogICAgICBkZXB0UGFyYW1zOiB0aGlzLnF1ZXJ5UGFyYW1zLAogICAgICBkZXB0U2VhcmNoRm9ybURpYWxvZzogZmFsc2UsCiAgICAgIGRlcHROYW1lRm9ybTogdW5kZWZpbmVkLAogICAgICBkZXB0T3B0aW9uczogdW5kZWZpbmVkLAogICAgICBkZWZhdWx0UHJvcHM6IHsKICAgICAgICBjaGlsZHJlbjogImNoaWxkcmVuIiwKICAgICAgICBsYWJlbDogImxhYmVsIgogICAgICB9LAogICAgICBkZXB0TGlzdDogW10sCiAgICAgIG9wZW46IGZhbHNlLAogICAgICBsb2FkaW5nOiB0cnVlLAogICAgICAvLyDpu5jorqTkuI3lsZXlvIDmiYDmnInoioLngrkKICAgICAgZGVmYXVsdEV4cGFuZDogZmFsc2UKICAgIH07CiAgfSwKCiAgbW91bnRlZCgpIHsKICAgIC8vIHRoaXMuZ2V0VHJlZVNlbGVjdCgpOwogIH0sCiAgd2F0Y2g6IHsKICAgIC8vIOagueaNruWQjeensOetm+mAiemDqOmXqOagkQogICAgZGVwdE5hbWVGb3JtKHZhbCkgewogICAgICB0aGlzLiRyZWZzLnRyZWVGb3JtLmZpbHRlcih2YWwpOwogICAgfSwKICAgIHF1ZXJ5UGFyYW1zOiB7CiAgICAgIGhhbmRsZXIodmFsKSB7CiAgICAgICAgdGhpcy5kZXB0UGFyYW1zID0gdmFsOwogICAgICB9LAogICAgICBkZWVwOiB0cnVlLAogICAgICBpbW1lZGlhdGU6IHRydWUKICAgIH0sCiAgICAvLyBmb3Jt6KGo5Y2V5Litc2VhcmNo6IqC54K55Y2V5Ye75LqL5Lu2CiAgICBoYW5kbGVGb3JtTm9kZUNsaWNrKGRhdGEpIHsKICAgICAgaWYgKHRoaXMuY29tcENvZGUgPT0gImNvbXBDb2RlIikgewogICAgICAgIHRoaXMucXVlcnlQYXJhbXMuZGVwdENvZGUgPSBudWxsOwogICAgICB9CiAgICAgIHRoaXMuZGVwdFBhcmFtc1t0aGlzLmNvbXBDb2RlXSA9IGRhdGEuaWQ7CiAgICAgIHRoaXMuZGVwdFBhcmFtc1t0aGlzLmNvbXBOYW1lXSA9IGRhdGEubGFiZWw7CiAgICAgIHRoaXMuZGVwdFNlYXJjaEZvcm1EaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy4kZW1pdCgiY2xpY2siLHRoaXMuZGVwdFBhcmFtcykKICAgICAgdGhpcy4kZW1pdCgiaW5wdXQiLCB0aGlzLmRlcHRQYXJhbXMpOwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgLy8g54K55Ye7aW5wdXQKICAgIGhhbmRsZUNsaWNrSW5wdXQoKSB7CiAgICAgIGlmICghdGhpcy5yZWFkb25seSkgewogICAgICAgIHRoaXMuZGVwdFNlYXJjaEZvcm1EaWFsb2cgPSB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIHRoaXMubXNnRXJyb3IoJ+emgeatoue8lui+kScpCiAgICAgIH0KICAgIH0sCiAgICBnZXREZXB0RGF0YXMobm9kZSwgcmVzb2x2ZSkgewogICAgICB2YXIgcElkID0gIiI7CiAgICAgIGlmIChub2RlLmxldmVsID09PSAwKSB7CiAgICAgICAgcElkID0gIiI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcElkID0gbm9kZS5kYXRhLmlkOwogICAgICB9CiAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICAgICAgdHJlZXNlbGVjdCh7IHBhcmVudElkOiBwSWQgfSkudGhlbihyZXMgPT4gewogICAgICAgICAgaWYgKHJlc29sdmUpIHsKICAgICAgICAgICAgcmVzb2x2ZShyZXMuZGF0YSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLmRlcHRPcHRpb25zID0gcmVzLmRhdGE7CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICB9KTsKICAgICAgfSwgMTAwKTsKICAgIH0sCiAgICAvL+iOt+WPluWNleS9jeagkQogICAgZ2V0VHJlZVNlbGVjdCgpIHsKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgICAgdHJlZXNlbGVjdCgpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIHRoaXMuZGVwdE9wdGlvbnMgPSByZXNwb25zZS5kYXRhOwogICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgICB9KTsKICAgIH0sCiAgICAvLyBmb3Jt6KGo5Y2V5Litc2VhcmNo6IqC54K55Y2V5Ye75LqL5Lu2CiAgICBoYW5kbGVGb3JtTm9kZUNsaWNrKGRhdGEpIHsKICAgICAgLy/orrDlvZXngrnlh7vmrKHmlbAKICAgICAgdGhpcy50cmVlQ2xpY2tDb3VudCsrOwogICAgICAvL+WNleasoeeCueWHu+asoeaVsOi2hei/hzLmrKHkuI3kvZzlpITnkIYs55u05o6l6L+U5ZueLOS5n+WPr+S7peaLk+WxleaIkOWkmuWHu+S6i+S7tgogICAgICBpZiAodGhpcy50cmVlQ2xpY2tDb3VudCA+PSAyKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIC8v6K6h5pe25ZmoLOiuoeeulzMwMOavq+enkuS4uuWNleS9jSzlj6/oh6rooYzkv67mlLkKICAgICAgdGhpcy50aW1lciA9IHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICBpZiAodGhpcy50cmVlQ2xpY2tDb3VudCA9PSAxKSB7CiAgICAgICAgICAvL+aKiuasoeaVsOW9kumbtgogICAgICAgICAgdGhpcy50cmVlQ2xpY2tDb3VudCA9IDA7CiAgICAgICAgICAvL+WNleWHu+S6i+S7tuWkhOeQhgogICAgICAgICAgLy8JCQkJCWNvbnNvbGUubG9nKCLljZXlh7vkuovku7YiKTsKICAgICAgICB9IGVsc2UgaWYgKHRoaXMudHJlZUNsaWNrQ291bnQgPiAxKSB7CiAgICAgICAgICAvL+aKiuasoeaVsOW9kumbtgogICAgICAgICAgdGhpcy50cmVlQ2xpY2tDb3VudCA9IDA7CiAgICAgICAgICAvL+WPjOWHu+S6i+S7tgogICAgICAgICAgdGhpcy5xdWVyeVBhcmFtc1t0aGlzLmRlcHRDb2RlXSA9IG51bGw7CiAgICAgICAgICB0aGlzLmRlcHRQYXJhbXNbdGhpcy5jb21wQ29kZV0gPSBkYXRhLmlkOwogICAgICAgICAgdGhpcy5kZXB0UGFyYW1zW3RoaXMuY29tcE5hbWVdID0gZGF0YS5sYWJlbDsKICAgICAgICAgIHRoaXMuZGVwdFNlYXJjaEZvcm1EaWFsb2cgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuJGVtaXQoImlucHV0IiwgdGhpcy5kZXB0UGFyYW1zKTsKICAgICAgICAgIHRoaXMuJGVtaXQoImNsaWNrIix0aGlzLmRlcHRQYXJhbXMpCiAgICAgICAgfQogICAgICB9LCAzMDApOwogICAgfSwKICAgIC8vIHNlYXJjaOetm+mAieiKgueCuQogICAgZmlsdGVyTm9kZSh2YWx1ZSwgZGF0YSkgewogICAgICBpZiAoIXZhbHVlKSByZXR1cm4gdHJ1ZTsKICAgICAgcmV0dXJuIGRhdGEubGFiZWwuaW5kZXhPZih2YWx1ZSkgIT09IC0xOwogICAgfSwKICAgIGhhbmRsZUNoYW5nZSh2YWx1ZSkgewogICAgICBpZiAoIXZhbHVlKSB7CiAgICAgICAgdGhpcy5kZXB0UGFyYW1zW3RoaXMuY29tcENvZGVdID0gIiI7CiAgICAgICAgdGhpcy4kZW1pdCgiaW5wdXQiLCB0aGlzLmRlcHRQYXJhbXMpOwogICAgICB9CiAgICB9LAogICAgLy8g5Yi35paw5qCR6IqC54K5CiAgICBoYW5kbGVSZWZyZXNoKCkgewogICAgICAvLyB0aGlzLmdldFRyZWVTZWxlY3QoKTsKICAgICAgdGhpcy5nZXREZXB0RGF0YXMoKTsKICAgIH0sCiAgICAvLyDlsZXlvIDmlLbnvKnmoJHnu5PngrkKICAgIGhhbmRsZUV4cGFuZChmbGFnKSB7CiAgICAgIC8vIOWwhuayoeaciei9rOaNouaIkOagkeeahOWOn+aVsOaNrgogICAgICBsZXQgdHJlZUxpc3QgPSB0aGlzLmRlcHRPcHRpb25zOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRyZWVMaXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdGhpcy4kcmVmcy50cmVlRm9ybS5zdG9yZS5ub2Rlc01hcFt0cmVlTGlzdFtpXS5pZF0uZXhwYW5kZWQgPSBmbGFnOwogICAgICB9CiAgICB9CiAgfQp9Owo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/components/orgSearch","sourcesContent":["<template>\n  <div class=\"deptSearch el-form-item\" >\n    <el-form-item :label=\"label\" :prop=\"compName\">\n      <el-input :size=\"size\" :readonly=\"readonly\" :clearable=\"!readonly\" @keyup.enter.native=\"handleQuery\" v-on:click.native=\"handleClickInput\" :placeholder=\"`请选择${label}`\" v-model=\"deptParams[compName]\" @change=\"handleChange\" style=\"width:100%\"/>\n    </el-form-item>\n    <el-form-item label=\"\" :prop=\"compCode\" style=\"display:none\">\n      <el-input type=\"text\" v-model=\"deptParams[compCode]\" @keyup.enter.native=\"handleQuery\"/>\n    </el-form-item>\n    <el-dialog custom-class=\"el-button--primary\" :visible.sync=\"deptSearchFormDialog\" id=\"deptDialog\" :close-on-click-modal=\"false\" :title=\"`选择${label}`\" append-to-body\n               width=\"500px\" >\n      <div>\n        <div class=\"head-container\">\n          <el-row>\n            <el-col :span=\"16\" class=\"pr5\">\n              <el-input\n                v-model=\"deptNameForm\"\n                placeholder=\"请输入编码名称\"\n                clearable\n                size=\"small\"\n                prefix-icon=\"el-icon-search\"\n                style=\"margin-bottom: 20px;\"\n              />\n            </el-col>\n            <el-col :span=\"8\">\n              <el-button\n                size=\"mini\"\n                type=\"text\"\n                icon=\"el-icon-refresh\"\n                @click=\"handleRefresh\"\n              >刷新</el-button>\n              <el-button\n                size=\"mini\"\n                type=\"text\"\n                icon=\"el-icon-arrow-down\"\n                @click=\"handleExpand(true)\"\n              >展开</el-button>\n              <el-button\n                size=\"mini\"\n                type=\"text\"\n                icon=\"el-icon-arrow-up\"\n                @click=\"handleExpand(false)\"\n              >折叠</el-button>\n            </el-col>\n          </el-row>\n\n\n        </div>\n        <div class=\"head-container\">\n          <el-tree\n            lazy\n            v-loading=\"loading\"\n            node-key=\"id\"\n            :data=\"deptOptions\"\n            :load=\"getDeptDatas\"\n            :props=\"defaultProps\"\n            :filter-node-method=\"filterNode\"\n            :default-expand-all=\"defaultExpand\"\n            ref=\"treeForm\"\n            @node-click=\"handleFormNodeClick\"\n          />\n        </div>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { treeselect, treeRoom } from \"@/api/until\";\nexport default {\n  name: \"index\",\n  props: {\n    queryParams: Object,\n    label: {\n      type: String,\n      default: \"单位\"\n    },\n    size: {\n      type: String,\n      default: \"mini\"\n    },\n    readonly: {\n      type: Boolean,\n      default: false\n    },\n    compCode: {\n      type: String,\n      default: \"compCode\"\n    },\n    compName: {\n      type: String,\n      default: \"compName\"\n    },\n    // 需要清空类似 科室的值\n    deptCode: {\n      type: String,\n      default: \"deptCode\"\n    }\n  },\n  data() {\n    return {\n      //定义点击次数,默认0次\n      treeClickCount: 0,\n      deptParams: this.queryParams,\n      deptSearchFormDialog: false,\n      deptNameForm: undefined,\n      deptOptions: undefined,\n      defaultProps: {\n        children: \"children\",\n        label: \"label\"\n      },\n      deptList: [],\n      open: false,\n      loading: true,\n      // 默认不展开所有节点\n      defaultExpand: false\n    };\n  },\n\n  mounted() {\n    // this.getTreeSelect();\n  },\n  watch: {\n    // 根据名称筛选部门树\n    deptNameForm(val) {\n      this.$refs.treeForm.filter(val);\n    },\n    queryParams: {\n      handler(val) {\n        this.deptParams = val;\n      },\n      deep: true,\n      immediate: true\n    },\n    // form表单中search节点单击事件\n    handleFormNodeClick(data) {\n      if (this.compCode == \"compCode\") {\n        this.queryParams.deptCode = null;\n      }\n      this.deptParams[this.compCode] = data.id;\n      this.deptParams[this.compName] = data.label;\n      this.deptSearchFormDialog = false;\n      this.$emit(\"click\",this.deptParams)\n      this.$emit(\"input\", this.deptParams);\n    }\n  },\n  methods: {\n    // 点击input\n    handleClickInput() {\n      if (!this.readonly) {\n        this.deptSearchFormDialog = true;\n      } else {\n        // this.msgError('禁止编辑')\n      }\n    },\n    getDeptDatas(node, resolve) {\n      var pId = \"\";\n      if (node.level === 0) {\n        pId = \"\";\n      } else {\n        pId = node.data.id;\n      }\n      setTimeout(() => {\n        this.loading = true;\n        treeselect({ parentId: pId }).then(res => {\n          if (resolve) {\n            resolve(res.data);\n          } else {\n            this.deptOptions = res.data;\n          }\n          this.loading = false;\n        });\n      }, 100);\n    },\n    //获取单位树\n    getTreeSelect() {\n      this.loading = true;\n      treeselect().then(response => {\n        this.deptOptions = response.data;\n        this.loading = false;\n      });\n    },\n    // form表单中search节点单击事件\n    handleFormNodeClick(data) {\n      //记录点击次数\n      this.treeClickCount++;\n      //单次点击次数超过2次不作处理,直接返回,也可以拓展成多击事件\n      if (this.treeClickCount >= 2) {\n        return;\n      }\n      //计时器,计算300毫秒为单位,可自行修改\n      this.timer = window.setTimeout(() => {\n        if (this.treeClickCount == 1) {\n          //把次数归零\n          this.treeClickCount = 0;\n          //单击事件处理\n          //\t\t\t\t\tconsole.log(\"单击事件\");\n        } else if (this.treeClickCount > 1) {\n          //把次数归零\n          this.treeClickCount = 0;\n          //双击事件\n          this.queryParams[this.deptCode] = null;\n          this.deptParams[this.compCode] = data.id;\n          this.deptParams[this.compName] = data.label;\n          this.deptSearchFormDialog = false;\n          this.$emit(\"input\", this.deptParams);\n          this.$emit(\"click\",this.deptParams)\n        }\n      }, 300);\n    },\n    // search筛选节点\n    filterNode(value, data) {\n      if (!value) return true;\n      return data.label.indexOf(value) !== -1;\n    },\n    handleChange(value) {\n      if (!value) {\n        this.deptParams[this.compCode] = \"\";\n        this.$emit(\"input\", this.deptParams);\n      }\n    },\n    // 刷新树节点\n    handleRefresh() {\n      // this.getTreeSelect();\n      this.getDeptDatas();\n    },\n    // 展开收缩树结点\n    handleExpand(flag) {\n      // 将没有转换成树的原数据\n      let treeList = this.deptOptions;\n      for (let i = 0; i < treeList.length; i++) {\n        this.$refs.treeForm.store.nodesMap[treeList[i].id].expanded = flag;\n      }\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.deptSearch {\n  margin-bottom: 0 !important;\n}\n// 单位弹框样式更改\n#deptDialog {\n  ::v-deep .el-dialog {\n    height: 80%;\n    overflow: hidden;\n    .el-dialog__body {\n      height: calc(100% - 54px);\n      overflow: hidden;\n      > div {\n        height: 100%;\n        .head-container:last-of-type {\n          height: calc(100% - 54px);\n          overflow-y: auto;\n        }\n      }\n    }\n  }\n}\n</style>\n"]}]}