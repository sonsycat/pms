{"remainingRequest":"D:\\hrp\\zjry-pms-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\hrp\\zjry-pms-ui\\src\\views\\revenue\\apport\\addEdit.vue?vue&type=style&index=0&id=6b99a1d9&lang=scss&scoped=true&","dependencies":[{"path":"D:\\hrp\\zjry-pms-ui\\src\\views\\revenue\\apport\\addEdit.vue","mtime":1682043106219},{"path":"D:\\hrp\\zjry-pms-ui\\node_modules\\css-loader\\dist\\cjs.js","mtime":1682058377861},{"path":"D:\\hrp\\zjry-pms-ui\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1682058382042},{"path":"D:\\hrp\\zjry-pms-ui\\node_modules\\postcss-loader\\src\\index.js","mtime":1682058378631},{"path":"D:\\hrp\\zjry-pms-ui\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1682058378517},{"path":"D:\\hrp\\zjry-pms-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1682058377348},{"path":"D:\\hrp\\zjry-pms-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":1682058381348}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgo6OnYtZGVlcCAuZWwtZGlhbG9nIHsKICBtaW4taGVpZ2h0OiAxMCU7CiAgb3ZlcmZsb3c6IGhpZGRlbjsKICAuZWwtZGlhbG9nX19ib2R5IHsKICAgIGhlaWdodDogY2FsYygxMDAlIC0gMTAwcHgpOwogICAgb3ZlcmZsb3c6IGF1dG87CiAgICBwYWRkaW5nOiAzMHB4IDIwcHggMCAhaW1wb3J0YW50OwogIH0KfQo="},{"version":3,"sources":["addEdit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"addEdit.vue","sourceRoot":"src/views/revenue/apport","sourcesContent":["<template>\r\n    <el-dialog :title=\"title\" :visible.sync=\"openDialog\" width=\"40%\" custom-class=\"el-button--primary\" append-to-body :close-on-click-modal=\"false\" @close=\"handleDialogClose\">\r\n      <el-form ref=\"form\" :model=\"form\" :rules=\"rules\" label-width=\"80px\">\r\n        <el-col :span=\"12\">\r\n          <el-form-item label=\"生成年月\" prop=\"occureTime\">\r\n            <el-date-picker class=\"w100\"\r\n              v-model=\"form.occureTime\"\r\n              type=\"month\"\r\n              value-format=\"yyyy-MM\"\r\n              placeholder=\"选择年月\"\r\n              @change=\"selectOccureTime\"\r\n              >\r\n            </el-date-picker>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"24\" :style=\"{marginBottom:'10px'}\" >\r\n          <div shadow=\"always\" >\r\n            <el-button icon=\"el-icon-plus\" type=\"success\" style=\"float:right\" :disabled=\"unAllowAdd\" @click=\"submitForm\" :loading=\"loading\">生成</el-button>\r\n          </div>\r\n        </el-col>\r\n        <el-col :span=\"24\" class=\"mb20\">\r\n          <el-progress v-if=\"progressShow\" :text-inside=\"true\" :stroke-width=\"20\" :percentage=\"percentage\"></el-progress>\r\n        </el-col>\r\n        <el-col :span=\"24\" style=\"max-height:450px;overflow:auto;padding:10px 0\">\r\n          <el-timeline>\r\n            <el-timeline-item\r\n              v-for=\"(activity, index) in activities\"\r\n              :key=\"index\"\r\n              :icon=\"activity.icon\"\r\n              :type=\"activity.type\"\r\n              :size=\"activity.size\"\r\n            >\r\n              {{activity.content}}\r\n              <div v-if=\"!activity.flag\" class=\"errorStyle\">{{activity.timestamp}}</div>\r\n              <div v-if=\"activity.flag\" class=\"successStyle\">{{activity.timestamp}}</div>\r\n              <!-- <div v-if=\"activity.flag\" class=\"successStyle\">{{activity.idea1}}</div> -->\r\n              <!-- <div v-if=\"activity.flag\" class=\"successStyle\">{{activity.idea2}}</div>\r\n              <div v-if=\"activity.flag\" class=\"successStyle\">{{activity.idea3}}</div> -->\r\n            </el-timeline-item>\r\n          </el-timeline>\r\n        </el-col>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"cancel\">取 消</el-button>\r\n      </div>\r\n    </el-dialog>\r\n</template>\r\n\r\n<script>\r\nimport { resolveGenerateCheck1, resolveGenerateCheck2, resolveGenerate1, resolveGenerate2, resolveGenerate3, resolveGenerate4} from \"@/api/revenue/apport\";\r\n\r\nexport default {\r\n  name: \"addEdit\",\r\n  props: {\r\n    open: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n  },\r\n  watch: {\r\n    open: {\r\n      handler(val) {\r\n        this.openDialog = val;\r\n      },\r\n      deep: true\r\n    }\r\n  },\r\n  components: {\r\n  },\r\n  data() {\r\n    return {\r\n      title: \"收入数据生成-收入生成\",\r\n      openDialog: this.open,\r\n      unAllowAdd:true,\r\n      loading: false,\r\n      progressShow:false,\r\n      activities: [],\r\n      percentage:0,\r\n      // 表单参数\r\n      form: {\r\n        compCode:this.$store.state.user.accountInfo.deptId,\r\n        occureTime:'',\r\n      },\r\n\t  \t// 表单校验\r\n      rules: {\r\n      }\r\n    };\r\n  },\r\n  created() {\r\n  },\r\n  methods: {\r\n    selectOccureTime(val){\r\n      if(!val){\r\n        this.unAllowAdd = true\r\n      }else{\r\n        this.unAllowAdd = false\r\n      }\r\n    },\r\n    // 弹框关闭\r\n    handleDialogClose() {\r\n      this.$emit(\"cancel\", false);\r\n    },\r\n    // 取消\r\n    cancel() {\r\n      this.$emit(\"cancel\", false);\r\n    },\r\n    /** 提交按钮 */\r\n    submitForm() {\r\n      this.$refs[\"form\"].validate(valid => {\r\n        if (valid) {\r\n          this.loading = true;\r\n          this.activities = []\r\n          this.progressShow = true\r\n          this.saveStepOne(this.form).then(()=>{\r\n            return this.saveStepOne1(this.form)\r\n          }).then(()=>{\r\n            return this.saveStepOne2(this.form)\r\n          }).then(()=>{\r\n            return this.saveStepOne3(this.form)\r\n          }).then(()=>{\r\n            return this.saveStepTow(this.form)\r\n          }).then(()=>{\r\n            return this.saveStepTow1(this.form)\r\n          }).then(()=>{\r\n            this.loading = false;\r\n          }).catch((res)=>{\r\n            this.loading = false;\r\n          })\r\n        }\r\n      });\r\n    },\r\n    saveStepOne(data){\r\n      return new Promise((reslove,reject)=>{\r\n        resolveGenerateCheck1(data).then(response =>{\r\n          if(response.code == 200){\r\n            this.percentage = 15\r\n            this.activities.push({\r\n              content: '验证是否有当前月数据',\r\n              timestamp: 'ok',\r\n              size: 'large',\r\n              type: 'success',\r\n              icon: 'el-icon-check',\r\n              flag:true\r\n            })\r\n            reslove()\r\n          }else{\r\n            reject(response)\r\n          }\r\n        }).catch((res)=>{\r\n          this.percentage = 10\r\n          this.activities.push({\r\n            content: '验证是否有当前月数据',\r\n            timestamp: 'Error',\r\n            size: 'large',\r\n            type: 'danger',\r\n            color:\"red\",\r\n            icon: 'el-icon-close',\r\n            flag:false\r\n          })\r\n          reject(res)\r\n        })\r\n      })\r\n    },\r\n    saveStepOne1(data){\r\n      return new Promise((reslove,reject)=>{\r\n        resolveGenerateCheck2(data).then(response =>{\r\n          if(response.code == 200){\r\n            this.percentage = 30\r\n            this.activities.push({\r\n              content: '验证当前是否有对应方案',\r\n              timestamp: 'ok',\r\n              size: 'large',\r\n              type: 'success',\r\n              icon: 'el-icon-check',\r\n              flag:true\r\n            })\r\n            reslove()\r\n          }else{\r\n            reject(response)\r\n          }\r\n        }).catch((res)=>{\r\n          this.percentage = 20\r\n          this.activities.push({\r\n            content: '验证当前是否有对应方案',\r\n            timestamp: 'Error',\r\n            size: 'large',\r\n            type: 'danger',\r\n            color:\"red\",\r\n            icon: 'el-icon-close',\r\n            flag:false\r\n          })\r\n          reject(res)\r\n        })\r\n      })\r\n    },\r\n    saveStepOne2(data){\r\n      return new Promise((reslove,reject)=>{\r\n        resolveGenerate1(data).then(response =>{\r\n          if(response.code == 200){\r\n            this.percentage = 45\r\n            this.activities.push({\r\n              content: '门诊收入分解',\r\n              timestamp: 'ok',\r\n              size: 'large',\r\n              type: 'success',\r\n              icon: 'el-icon-check',\r\n              flag:true\r\n            })\r\n            reslove()\r\n          }else{\r\n            reject(response)\r\n          }\r\n        }).catch((res)=>{\r\n          this.percentage = 30\r\n          this.activities.push({\r\n            content: '门诊收入分解',\r\n            timestamp: 'Error',\r\n            size: 'large',\r\n            type: 'danger',\r\n            color:\"red\",\r\n            icon: 'el-icon-close',\r\n            flag:false\r\n          })\r\n          reject(res)\r\n        })\r\n      })\r\n    },\r\n    saveStepOne3(data){\r\n      return new Promise((reslove,reject)=>{\r\n        resolveGenerate2(data).then(response =>{\r\n          if(response.code == 200){\r\n            this.percentage = 60\r\n            this.activities.push({\r\n              content: '门诊收入附加分解',\r\n              timestamp: 'ok',\r\n              size: 'large',\r\n              type: 'success',\r\n              icon: 'el-icon-check',\r\n              flag:true\r\n            })\r\n            reslove()\r\n          }else{\r\n            reject(response)\r\n          }\r\n        }).catch((res)=>{\r\n          this.percentage = 40\r\n          this.activities.push({\r\n            content: '门诊收入附加分解',\r\n            timestamp: 'Error',\r\n            size: 'large',\r\n            type: 'danger',\r\n            color:\"red\",\r\n            icon: 'el-icon-close',\r\n            flag:false\r\n          })\r\n          reject(res)\r\n        })\r\n      })\r\n    },\r\n    saveStepTow(data){\r\n      return new Promise((reslove,reject)=>{\r\n        resolveGenerate3(data).then(response =>{\r\n          if(response.code == 200){\r\n            this.percentage = 75\r\n            this.activities.push({\r\n              content: '住院收入分解',\r\n              timestamp: 'ok',\r\n              size: 'large',\r\n              type: 'success',\r\n              icon: 'el-icon-check',\r\n              flag:true\r\n            })\r\n            reslove()\r\n          }else{\r\n            reject(response)\r\n          }\r\n        }).catch((res)=>{\r\n          this.percentage = 70\r\n          this.activities.push({\r\n            content: '住院收入分解',\r\n            timestamp: 'Error',\r\n            size: 'large',\r\n            type: 'danger',\r\n            color:\"red\",\r\n            icon: 'el-icon-close',\r\n            flag:false\r\n          })\r\n          reject(res)\r\n        })\r\n      })\r\n    },\r\n    saveStepTow1(data){\r\n      return new Promise((reslove,reject)=>{\r\n        resolveGenerate4(data).then(response =>{\r\n          if(response.code == 200){\r\n            this.percentage = 100\r\n            this.activities.push({\r\n              content: '住院附加收入分解',\r\n              timestamp: 'ok',\r\n              // idea1: '住院附加收入数据计算完成',\r\n              // idea2: '分解前金额'+this.form.forward,\r\n              // idea3: '分解后金额'+this.form.back,\r\n              size: 'large',\r\n              type: 'success',\r\n              icon: 'el-icon-check',\r\n              flag:true\r\n            })\r\n            reslove()\r\n          }else{\r\n            reject(response)\r\n          }\r\n        }).catch((res)=>{\r\n          this.percentage = 90\r\n          this.activities.push({\r\n            content: '住院附加收入分解',\r\n            timestamp: 'Error',\r\n            size: 'large',\r\n            type: 'danger',\r\n            color:\"red\",\r\n            icon: 'el-icon-close',\r\n            flag:false\r\n          })\r\n          reject(res)\r\n        })\r\n      })\r\n    },\r\n    // saveStepTow2(data){\r\n    //   return new Promise((reslove,reject)=>{\r\n    //     addApportEjftjs(data).then(response =>{\r\n    //       this.form = response.data;\r\n    //       if(response.code == 200){\r\n    //         this.percentage = 90\r\n    //         this.activities.push({\r\n    //           content: '折算成本',\r\n    //           timestamp: 'ok',\r\n    //           idea1: '折算成本数据计算完成',\r\n    //           // idea2: '分解前金额'+this.form.forward,\r\n    //           // idea3: '分解后金额'+this.form.back,\r\n    //           size: 'large',\r\n    //           type: 'success',\r\n    //           icon: 'el-icon-check',\r\n    //           flag:true\r\n    //         })\r\n    //         reslove()\r\n    //       }else{\r\n    //         reject(response)\r\n    //       }\r\n    //     }).catch((res)=>{\r\n    //       this.percentage = 70\r\n    //       this.activities.push({\r\n    //         content: '折算成本',\r\n    //         timestamp: 'Error',\r\n    //         size: 'large',\r\n    //         type: 'danger',\r\n    //         color:\"red\",\r\n    //         icon: 'el-icon-close',\r\n    //         flag:false\r\n    //       })\r\n    //       reject(res)\r\n    //     })\r\n    //   })\r\n    // },\r\n    // saveStepTow3(data){\r\n    //   return new Promise((reslove,reject)=>{\r\n    //     addApportSjftjs(data).then(response =>{\r\n    //       this.form = response.data;\r\n    //       if(response.code == 200){\r\n    //         this.percentage = 100\r\n    //         this.activities.push({\r\n    //           content: '完成生成',\r\n    //           timestamp: 'ok',\r\n    //           idea1: '数据计算完成',\r\n    //           // idea2: '分解前金额'+this.form.forward,\r\n    //           // idea3: '分解后金额'+this.form.back,\r\n    //           size: 'large',\r\n    //           type: 'success',\r\n    //           icon: 'el-icon-check',\r\n    //           flag:true\r\n    //         })\r\n    //         reslove()\r\n    //       }else{\r\n    //         reject(response)\r\n    //       }\r\n    //     }).catch((res)=>{\r\n    //       this.percentage = 80\r\n    //       this.activities.push({\r\n    //         content: '完成生成',\r\n    //         timestamp: 'Error',\r\n    //         size: 'large',\r\n    //         type: 'danger',\r\n    //         color:\"red\",\r\n    //         icon: 'el-icon-close',\r\n    //         flag:false\r\n    //       })\r\n    //       reject(res)\r\n    //     })\r\n    //   })\r\n    // },\r\n}};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n  ::v-deep .el-dialog {\r\n    min-height: 10%;\r\n    overflow: hidden;\r\n    .el-dialog__body {\r\n      height: calc(100% - 100px);\r\n      overflow: auto;\r\n      padding: 30px 20px 0 !important;\r\n    }\r\n  }\r\n</style>"]}]}