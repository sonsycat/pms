{"remainingRequest":"D:\\work\\pms_oracle\\pms_UI\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\work\\pms_oracle\\pms_UI\\src\\views\\quality\\index\\addEdit.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\work\\pms_oracle\\pms_UI\\src\\views\\quality\\index\\addEdit.vue","mtime":1693362205000},{"path":"D:\\work\\pms_oracle\\pms_UI\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1693361924000},{"path":"D:\\work\\pms_oracle\\pms_UI\\node_modules\\babel-loader\\lib\\index.js","mtime":1693361909000},{"path":"D:\\work\\pms_oracle\\pms_UI\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1693361924000},{"path":"D:\\work\\pms_oracle\\pms_UI\\node_modules\\vue-loader\\lib\\index.js","mtime":1693362179000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGdldERlcHRCeUNvbXAgfSBmcm9tICdAL2FwaS9zeXN0ZW0vZGljdC9kYXRhJwppbXBvcnQgeyBhZGRJbmRleCwgZ2V0SW5kZXgsIGdldFRlbXBDb2RlLCB1cGRhdGVJbmRleCB9IGZyb20gJ0AvYXBpL3F1YWxpdHkvaW5kZXgnCmltcG9ydCB7IGxpc3RGb3JtRGVzaWduIH0gZnJvbSAnQC9hcGkvZm9ybURlc2lnbi9mb3JtRGVzaWduJwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdhZGRFZGl0JywKICBwcm9wczogewogICAgb3BlbjogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0OiBmYWxzZQogICAgfSwKICAgIGlkOiB7CiAgICAgIHR5cGU6IFtTdHJpbmcsIE51bWJlcl0sCiAgICAgIGRlZmF1bHQ6ICcnCiAgICB9CiAgfSwKICB3YXRjaDogewogICAgaWQ6IHsKICAgICAgaGFuZGxlcih2YWwpIHsKICAgICAgICB0aGlzLnJlc2V0KCkKICAgICAgICBpZiAodmFsKSB7CiAgICAgICAgICB0aGlzLmlkID0gdmFsCiAgICAgICAgICB0aGlzLnRpdGxlID0gJ+i0qOmHj+iAg+ivhOaMh+agh+euoeeQhi3nvJbovpEnCiAgICAgICAgICB0aGlzLmdldERldGFpbEluZm8oKQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmlkID0gJycKICAgICAgICAgIHRoaXMudGl0bGUgPSAn6LSo6YeP6ICD6K+E5oyH5qCH566h55CGLeaWsOWinicKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGRlZXA6IHRydWUsCiAgICAgIGltbWVkaWF0ZTogdHJ1ZQogICAgfSwKICAgIG9wZW46IHsKICAgICAgaGFuZGxlcih2YWwpIHsKICAgICAgICB0aGlzLm9wZW5EaWFsb2cgPSB2YWwKICAgICAgfSwKICAgICAgZGVlcDogdHJ1ZQogICAgfQogIH0sCiAgY29tcG9uZW50czoge30sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHRpdGxlOiAn6LSo6YeP6ICD6K+E5oyH5qCH566h55CGLeaWsOWinicsCiAgICAgIG9wZW5EaWFsb2c6IHRoaXMub3BlbiwKICAgICAgc2F2ZUxvYWRpbmc6IGZhbHNlLAogICAgICBhZGRTYXZlTG9hZGluZzogZmFsc2UsCiAgICAgIGRlcHRMaXN0OiBbXSwKICAgICAgLy/mqKHmnb/mlbDmja4KICAgICAgbW9kZWxDb2RlT3B0aW9uOiBbXSwKICAgICAgLy8g6KGo5Y2V5Y+C5pWwCiAgICAgIGZvcm06IHt9LAogICAgICAvLyDooajljZXmoKHpqowKICAgICAgcnVsZXM6IHsKICAgICAgICBpbmRleE5hbWU6IFsKICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfmjIfmoIflkI3np7DkuI3og73kuLrnqbonLCB0cmlnZ2VyOiAnYmx1cicgfQogICAgICAgIF0sCiAgICAgICAgZGVwdE5hbWU6IFsKICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfkuLvnrqHpg6jpl6jkuI3og73kuLrnqbonLCB0cmlnZ2VyOiBbJ2JsdXInLCAnY2hhbmdlJ10gfQogICAgICAgIF0sCiAgICAgICAgaW5kZXhTY29yZTogWwogICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+aMh+agh+WIhuWAvOS4jeiDveS4uuepuicsIHRyaWdnZXI6ICdibHVyJyB9CiAgICAgICAgXQogICAgICAgIC8vIHRlbXBDb2RlOlsKICAgICAgICAvLyAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICLmqKHmnb/nvJbnoIHkuI3og73kuLrnqboiLCB0cmlnZ2VyOiBbImJsdXIiLCJjaGFuZ2UiXSB9CiAgICAgICAgLy8gXSwKICAgICAgICAvLyBkYXRlQ29sTmFtZTpbCiAgICAgICAgLy8gICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAi5pe26Ze05YiX5LiN6IO95Li656m6IiwgdHJpZ2dlcjogWyJibHVyIiwiY2hhbmdlIl0gfQogICAgICAgIC8vIF0sCiAgICAgICAgLy8gZGVwdENvbE5hbWU6WwogICAgICAgIC8vICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogIumDqOmXqOWIl+S4jeiDveS4uuepuiIsIHRyaWdnZXI6IFsiYmx1ciIsImNoYW5nZSJdIH0KICAgICAgICAvLyBdLAogICAgICAgIC8vIG51bUNvbE5hbWU6WwogICAgICAgIC8vICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogIuaVsOWAvOWIl+S4jeiDveS4uuepuiIsIHRyaWdnZXI6IFsiYmx1ciIsImNoYW5nZSJdIH0KICAgICAgICAvLyBdLAogICAgICB9LAogICAgICBkYXRlQ29sSWQ6IG51bGwsCiAgICAgIGRlcHRDb2xJZDogbnVsbCwKICAgICAgbnVtQ29sSWQ6IG51bGwsCiAgICAgIC8vIOafpeivouWPguaVsAogICAgICBxdWVyeVBhcmFtczogewogICAgICAgIC8vIHBhZ2VOdW06IDEsCiAgICAgICAgLy8gcGFnZVNpemU6IDMwLAogICAgICAgIGNvbXBDb2RlOiB0aGlzLiRzdG9yZS5zdGF0ZS51c2VyLnVzZXJJbmZvLmRlcHRJZAogICAgICB9CiAgICB9CiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5nZXREZXB0QnlDb21wKCkKICAgIHRoaXMuZ2V0VGVtcExpc3QoKQogIH0sCiAgbWV0aG9kczogewogICAgZ2V0RGV0YWlsSW5mbygpIHsKICAgICAgZ2V0SW5kZXgodGhpcy5pZCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgdGhpcy5mb3JtID0gcmVzcG9uc2UuZGF0YQogICAgICB9KQogICAgfSwKICAgIC8vIOiOt+WPluW9k+WJjeeZu+W9leeUqOaIt+WNleS9jeS4i+eahOenkeWupAogICAgZ2V0RGVwdEJ5Q29tcChjb21wQ29kZSkgewogICAgICBsZXQgZGF0YSA9IHsKICAgICAgICBjb21wQ29kZTogdGhpcy4kc3RvcmUuc3RhdGUudXNlci51c2VySW5mby5kZXB0SWQKICAgICAgfQogICAgICBnZXREZXB0QnlDb21wKGRhdGEpLnRoZW4ocmVzID0+IHsKICAgICAgICB0aGlzLmRlcHRMaXN0ID0gcmVzLmRhdGEKICAgICAgfSkKICAgIH0sCiAgICAvL+iOt+WPluaooeadv+e8lueggeS/oeaBrwogICAgZ2V0VGVtcExpc3QoaWQpIHsKICAgICAgbGV0IG9iaiA9IHsgZm9ybURlc2lnbklkOiBpZCB9CiAgICAgIGxpc3RGb3JtRGVzaWduKHRoaXMucXVlcnlQYXJhbXMpLnRoZW4ocmVzID0+IHsKICAgICAgICBpZiAocmVzLmNvZGUgPT0gMjAwKSB7CiAgICAgICAgICB0aGlzLm1vZGVsQ29kZU9wdGlvbiA9IHJlcy5yb3dzCiAgICAgICAgfQogICAgICB9KQogICAgICB0aGlzLmNoYW5nZVRlbXBGdW4ob2JqKQogICAgfSwKICAgIC8v6I635Y+W5qih5p2/57yW56CB55u45YWz5YiX5L+h5oGvCiAgICBjaGFuZ2VUZW1wRnVuKGlkKSB7CiAgICAgIGdldFRlbXBDb2RlKGlkKS50aGVuKHJlcyA9PiB7CiAgICAgICAgaWYgKHJlcy5jb2RlID09IDIwMCkgewogICAgICAgICAgcmVzLmRhdGEuZm9yRWFjaChpdGVtID0+IHsKICAgICAgICAgICAgaWYgKGl0ZW0uZmllbGROYW1lID09ICdjc19kYXRlJykgewogICAgICAgICAgICAgIHRoaXMuZm9ybS5kYXRlQ29sTmFtZSA9IGl0ZW0uZmllbGREZXNjCiAgICAgICAgICAgICAgdGhpcy5kYXRlQ29sSWQgPSBpdGVtLmlkCiAgICAgICAgICAgIH0gZWxzZSBpZiAoaXRlbS5maWVsZE5hbWUgPT0gJ2NzX2RlcHQnKSB7CiAgICAgICAgICAgICAgdGhpcy5mb3JtLmRlcHRDb2xOYW1lID0gaXRlbS5maWVsZERlc2MKICAgICAgICAgICAgICB0aGlzLmRlcHRDb2xJZCA9IGl0ZW0uaWQKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0aGlzLmZvcm0ubnVtQ29sTmFtZSA9IGl0ZW0uZmllbGREZXNjCiAgICAgICAgICAgICAgdGhpcy5udW1Db2xJZCA9IGl0ZW0uaWQKICAgICAgICAgICAgfQogICAgICAgICAgfSkKICAgICAgICB9CiAgICAgIH0pCgogICAgfSwKICAgIC8vIOW8ueahhuWFs+mXrQogICAgaGFuZGxlRGlhbG9nQ2xvc2UoKSB7CiAgICAgIHRoaXMuJGVtaXQoJ2NhbmNlbCcsIGZhbHNlKQogICAgfSwKICAgIC8vIOWPlua2iAogICAgY2FuY2VsKCkgewogICAgICB0aGlzLiRlbWl0KCdjYW5jZWwnLCBmYWxzZSkKICAgIH0sCiAgICAvLyDooajljZXph43nva4KICAgIHJlc2V0KCkgewogICAgICB0aGlzLmZvcm0gPSB7CiAgICAgICAgaWQ6IG51bGwsCiAgICAgICAgY29tcENvZGU6IG51bGwsCiAgICAgICAgYWNjb3VudENvZGU6IG51bGwsCiAgICAgICAgZGVwdENvZGU6IG51bGwsCiAgICAgICAgZGVwdE5hbWU6IG51bGwsCiAgICAgICAgaW5kZXhDb2RlOiBudWxsLAogICAgICAgIGluZGV4TmFtZTogbnVsbCwKICAgICAgICBpbmRleFNjb3JlOiBudWxsLAogICAgICAgIHRlbXBDb2RlOiBudWxsLAogICAgICAgIGRhdGVDb2xOYW1lOiBudWxsLAogICAgICAgIGRlcHRDb2xOYW1lOiBudWxsLAogICAgICAgIG51bUNvbE5hbWU6IG51bGwsCiAgICAgICAgZGVsRmxhZzogbnVsbCwKICAgICAgICBjcmVhdGVCeTogbnVsbCwKICAgICAgICBjcmVhdGVUaW1lOiBudWxsLAogICAgICAgIHVwZGF0ZUJ5OiBudWxsLAogICAgICAgIHVwZGF0ZVRpbWU6IG51bGwsCiAgICAgICAgcmVtYXJrOiBudWxsCiAgICAgIH0KICAgICAgdGhpcy5yZXNldEZvcm0oJ2Zvcm0nKQogICAgfSwKICAgIC8qKiDmj5DkuqTmjInpkq4gKi8KICAgIHN1Ym1pdEZvcm0odHlwZSkgewogICAgICB0aGlzLiRyZWZzWydmb3JtJ10udmFsaWRhdGUodmFsaWQgPT4gewogICAgICAgIGlmICh2YWxpZCkgewogICAgICAgICAgdGhpcy5mb3JtLmRhdGVDb2xOYW1lID0gdGhpcy5kYXRlQ29sSWQKICAgICAgICAgIHRoaXMuZm9ybS5kZXB0Q29sTmFtZSA9IHRoaXMuZGVwdENvbElkCiAgICAgICAgICB0aGlzLmZvcm0ubnVtQ29sTmFtZSA9IHRoaXMubnVtQ29sSWQKICAgICAgICAgIHRoaXMuZm9ybS5jb21wQ29kZSA9IHRoaXMuJHN0b3JlLnN0YXRlLnVzZXIudXNlckluZm8uZGVwdElkCiAgICAgICAgICBpZiAodGhpcy5mb3JtLmlkICE9IG51bGwpIHsKICAgICAgICAgICAgaWYgKHR5cGUpIHsKICAgICAgICAgICAgICB0aGlzLmFkZFNhdmVMb2FkaW5nID0gdHJ1ZQogICAgICAgICAgICAgIHVwZGF0ZUluZGV4KHRoaXMuZm9ybSkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLm1zZ1N1Y2Nlc3MoJ+S/ruaUueaIkOWKnycpCiAgICAgICAgICAgICAgICB0aGlzLnJlc2V0KCkKICAgICAgICAgICAgICAgIHRoaXMuYWRkU2F2ZUxvYWRpbmcgPSBmYWxzZQogICAgICAgICAgICAgICAgdGhpcy4kZW1pdCgnc3VjY2VzcycsIHRydWUpCiAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0aGlzLnNhdmVMb2FkaW5nID0gdHJ1ZQogICAgICAgICAgICAgIHVwZGF0ZUluZGV4KHRoaXMuZm9ybSkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLm1zZ1N1Y2Nlc3MoJ+S/ruaUueaIkOWKnycpCiAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdzdWNjZXNzJywgZmFsc2UpCiAgICAgICAgICAgICAgICB0aGlzLnNhdmVMb2FkaW5nID0gZmFsc2UKICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAodHlwZSkgewogICAgICAgICAgICAgIHRoaXMuYWRkU2F2ZUxvYWRpbmcgPSB0cnVlCiAgICAgICAgICAgICAgYWRkSW5kZXgodGhpcy5mb3JtKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgICAgICAgIHRoaXMubXNnU3VjY2Vzcygn5paw5aKe5oiQ5YqfJykKICAgICAgICAgICAgICAgIHRoaXMuYWRkU2F2ZUxvYWRpbmcgPSBmYWxzZQogICAgICAgICAgICAgICAgdGhpcy5yZXNldCgpCiAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdzdWNjZXNzJywgdHJ1ZSkKICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRoaXMuc2F2ZUxvYWRpbmcgPSB0cnVlCiAgICAgICAgICAgICAgYWRkSW5kZXgodGhpcy5mb3JtKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgICAgICAgIHRoaXMubXNnU3VjY2Vzcygn5paw5aKe5oiQ5YqfJykKICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ3N1Y2Nlc3MnLCBmYWxzZSkKICAgICAgICAgICAgICAgIHRoaXMuc2F2ZUxvYWRpbmcgPSBmYWxzZQogICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pCiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["addEdit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"addEdit.vue","sourceRoot":"src/views/quality/index","sourcesContent":["<template>\n  <el-dialog :title=\"title\" :visible.sync=\"openDialog\" width=\"50%\" custom-class=\"el-button--primary\" append-to-body\n             :close-on-click-modal=\"false\" @close=\"handleDialogClose\"\n  >\n    <el-form ref=\"form\" :model=\"form\" :rules=\"rules\" label-width=\"80px\">\n      <el-row :gutter=\"24\">\n        <el-col :span=\"12\">\n          <el-form-item label=\"指标名称\" prop=\"indexName\">\n            <el-input v-model=\"form.indexName\" placeholder=\"请输入指标名称\" maxlength=\"100\" show-word-limit/>\n          </el-form-item>\n        </el-col>\n        <el-col :span=\"12\">\n          <el-form-item label=\"主管部门\" prop=\"deptCode\">\n            <el-select clearable remote v-model=\"form.deptCode\" placeholder=\"请选择主管部门\" class=\"w100\" filterable>\n              <el-option\n                v-for=\"dict in deptList\"\n                :key=\"dict.dictValue\"\n                :label=\"dict.dictLabel\"\n                :value=\"dict.dictValue\"\n              ></el-option>\n            </el-select>\n          </el-form-item>\n        </el-col>\n        <el-col :span=\"12\">\n          <el-form-item label=\"指标分值\" prop=\"indexScore\">\n            <el-input-number controls-position=\"right\" :min=\"0\" :max=\"100\" :precision=\"2\" v-model=\"form.indexScore\"\n                             placeholder=\"请输入指标分值\"\n            />\n          </el-form-item>\n        </el-col>\n        <el-col :span=\"12\">\n          <el-form-item label=\"模板编码\" prop=\"tempCode\">\n            <el-select clearable filterable remote v-model=\"form.tempCode\" placeholder=\"请选择模板编码\" @change=\"getTempList\">\n              <el-option\n                v-for=\"dict in modelCodeOption\"\n                :key=\"dict.id\"\n                :label=\"dict.formName\"\n                :value=\"dict.id\"\n              ></el-option>\n            </el-select>\n          </el-form-item>\n        </el-col>\n        <el-col :span=\"12\">\n          <el-form-item label=\"时间列\" prop=\"dateColName\">\n            <el-input v-model=\"form.dateColName\" placeholder=\"请输入时间列\" disabled/>\n          </el-form-item>\n        </el-col>\n        <el-col :span=\"12\">\n          <el-form-item label=\"部门列\" prop=\"deptColName\">\n            <el-input v-model=\"form.deptColName\" placeholder=\"请输入部门列\" disabled/>\n          </el-form-item>\n        </el-col>\n        <el-col :span=\"12\">\n          <el-form-item label=\"数值列\" prop=\"numColName\">\n            <el-input v-model=\"form.numColName\" placeholder=\"请输入数值列\" disabled/>\n          </el-form-item>\n        </el-col>\n      </el-row>\n    </el-form>\n    <div slot=\"footer\" class=\"dialog-footer\">\n      <el-button type=\"primary\" @click=\"submitForm(true)\" :loading=\"addSaveLoading\">保存并继续添加</el-button>\n      <el-button type=\"primary\" @click=\"submitForm(false)\" :loading=\"saveLoading\">保 存</el-button>\n      <el-button @click=\"cancel\">取 消</el-button>\n    </div>\n  </el-dialog>\n</template>\n\n<script>\nimport { getDeptByComp } from '@/api/system/dict/data'\nimport { addIndex, getIndex, getTempCode, updateIndex } from '@/api/quality/index'\nimport { listFormDesign } from '@/api/formDesign/formDesign'\n\nexport default {\n  name: 'addEdit',\n  props: {\n    open: {\n      type: Boolean,\n      default: false\n    },\n    id: {\n      type: [String, Number],\n      default: ''\n    }\n  },\n  watch: {\n    id: {\n      handler(val) {\n        this.reset()\n        if (val) {\n          this.id = val\n          this.title = '质量考评指标管理-编辑'\n          this.getDetailInfo()\n        } else {\n          this.id = ''\n          this.title = '质量考评指标管理-新增'\n        }\n      },\n      deep: true,\n      immediate: true\n    },\n    open: {\n      handler(val) {\n        this.openDialog = val\n      },\n      deep: true\n    }\n  },\n  components: {},\n  data() {\n    return {\n      title: '质量考评指标管理-新增',\n      openDialog: this.open,\n      saveLoading: false,\n      addSaveLoading: false,\n      deptList: [],\n      //模板数据\n      modelCodeOption: [],\n      // 表单参数\n      form: {},\n      // 表单校验\n      rules: {\n        indexName: [\n          { required: true, message: '指标名称不能为空', trigger: 'blur' }\n        ],\n        deptName: [\n          { required: true, message: '主管部门不能为空', trigger: ['blur', 'change'] }\n        ],\n        indexScore: [\n          { required: true, message: '指标分值不能为空', trigger: 'blur' }\n        ]\n        // tempCode:[\n        //   { required: true, message: \"模板编码不能为空\", trigger: [\"blur\",\"change\"] }\n        // ],\n        // dateColName:[\n        //   { required: true, message: \"时间列不能为空\", trigger: [\"blur\",\"change\"] }\n        // ],\n        // deptColName:[\n        //   { required: true, message: \"部门列不能为空\", trigger: [\"blur\",\"change\"] }\n        // ],\n        // numColName:[\n        //   { required: true, message: \"数值列不能为空\", trigger: [\"blur\",\"change\"] }\n        // ],\n      },\n      dateColId: null,\n      deptColId: null,\n      numColId: null,\n      // 查询参数\n      queryParams: {\n        // pageNum: 1,\n        // pageSize: 30,\n        compCode: this.$store.state.user.userInfo.deptId\n      }\n    }\n  },\n  created() {\n    this.getDeptByComp()\n    this.getTempList()\n  },\n  methods: {\n    getDetailInfo() {\n      getIndex(this.id).then(response => {\n        this.form = response.data\n      })\n    },\n    // 获取当前登录用户单位下的科室\n    getDeptByComp(compCode) {\n      let data = {\n        compCode: this.$store.state.user.userInfo.deptId\n      }\n      getDeptByComp(data).then(res => {\n        this.deptList = res.data\n      })\n    },\n    //获取模板编码信息\n    getTempList(id) {\n      let obj = { formDesignId: id }\n      listFormDesign(this.queryParams).then(res => {\n        if (res.code == 200) {\n          this.modelCodeOption = res.rows\n        }\n      })\n      this.changeTempFun(obj)\n    },\n    //获取模板编码相关列信息\n    changeTempFun(id) {\n      getTempCode(id).then(res => {\n        if (res.code == 200) {\n          res.data.forEach(item => {\n            if (item.fieldName == 'cs_date') {\n              this.form.dateColName = item.fieldDesc\n              this.dateColId = item.id\n            } else if (item.fieldName == 'cs_dept') {\n              this.form.deptColName = item.fieldDesc\n              this.deptColId = item.id\n            } else {\n              this.form.numColName = item.fieldDesc\n              this.numColId = item.id\n            }\n          })\n        }\n      })\n\n    },\n    // 弹框关闭\n    handleDialogClose() {\n      this.$emit('cancel', false)\n    },\n    // 取消\n    cancel() {\n      this.$emit('cancel', false)\n    },\n    // 表单重置\n    reset() {\n      this.form = {\n        id: null,\n        compCode: null,\n        accountCode: null,\n        deptCode: null,\n        deptName: null,\n        indexCode: null,\n        indexName: null,\n        indexScore: null,\n        tempCode: null,\n        dateColName: null,\n        deptColName: null,\n        numColName: null,\n        delFlag: null,\n        createBy: null,\n        createTime: null,\n        updateBy: null,\n        updateTime: null,\n        remark: null\n      }\n      this.resetForm('form')\n    },\n    /** 提交按钮 */\n    submitForm(type) {\n      this.$refs['form'].validate(valid => {\n        if (valid) {\n          this.form.dateColName = this.dateColId\n          this.form.deptColName = this.deptColId\n          this.form.numColName = this.numColId\n          this.form.compCode = this.$store.state.user.userInfo.deptId\n          if (this.form.id != null) {\n            if (type) {\n              this.addSaveLoading = true\n              updateIndex(this.form).then(response => {\n                this.msgSuccess('修改成功')\n                this.reset()\n                this.addSaveLoading = false\n                this.$emit('success', true)\n              })\n            } else {\n              this.saveLoading = true\n              updateIndex(this.form).then(response => {\n                this.msgSuccess('修改成功')\n                this.$emit('success', false)\n                this.saveLoading = false\n              })\n            }\n          } else {\n            if (type) {\n              this.addSaveLoading = true\n              addIndex(this.form).then(response => {\n                this.msgSuccess('新增成功')\n                this.addSaveLoading = false\n                this.reset()\n                this.$emit('success', true)\n              })\n            } else {\n              this.saveLoading = true\n              addIndex(this.form).then(response => {\n                this.msgSuccess('新增成功')\n                this.$emit('success', false)\n                this.saveLoading = false\n              })\n            }\n          }\n        }\n      })\n    }\n  }\n}\n</script>\n<style lang=\"scss\" scoped>\n::v-deep .el-dialog {\n  min-height: 20%;\n  overflow: hidden;\n\n  .el-dialog__body {\n    height: calc(100% - 100px);\n    overflow: auto;\n\n    .el-select {\n      width: 100%;\n    }\n\n    .el-input-number--mini {\n      width: 100%;\n    }\n  }\n}\n</style>\n"]}]}