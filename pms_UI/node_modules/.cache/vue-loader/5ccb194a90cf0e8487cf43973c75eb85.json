{"remainingRequest":"D:\\hrp\\zjry-pms-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\hrp\\zjry-pms-ui\\src\\views\\quality\\detail\\index.vue?vue&type=style&index=0&id=1ce225be&lang=scss&scoped=true&","dependencies":[{"path":"D:\\hrp\\zjry-pms-ui\\src\\views\\quality\\detail\\index.vue","mtime":1682043107598},{"path":"D:\\hrp\\zjry-pms-ui\\node_modules\\css-loader\\dist\\cjs.js","mtime":1682058377861},{"path":"D:\\hrp\\zjry-pms-ui\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1682058382042},{"path":"D:\\hrp\\zjry-pms-ui\\node_modules\\postcss-loader\\src\\index.js","mtime":1682058378631},{"path":"D:\\hrp\\zjry-pms-ui\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1682058378517},{"path":"D:\\hrp\\zjry-pms-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1682058377348},{"path":"D:\\hrp\\zjry-pms-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":1682058381348}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCjo6di1kZWVwIC5lbC1kaWFsb2cgewogIG1pbi1oZWlnaHQ6IDIwJTsKICBvdmVyZmxvdzogaGlkZGVuOwogIC5lbC1kaWFsb2dfX2JvZHkgewogICAgaGVpZ2h0OiBjYWxjKDEwMCUgLSAxMDBweCk7CiAgICBvdmVyZmxvdzogYXV0bzsKICAgIC5hcHAtY29udGFpbmVyewogICAgICAuZWwtZm9ybS1pdGVtewogICAgICAgIHdpZHRoOiAxMDAlOwogICAgICB9CiAgICAgIC5lbC1mb3JtLWl0ZW1fX2NvbnRlbnR7CiAgICAgICAgbWFyZ2luLWxlZnQ6IDAgIWltcG9ydGFudDsKICAgICAgICB3aWR0aDo3MCU7CiAgICAgIH0KICAgICAgLmVsLXNlbGVjdHsKICAgICAgICB3aWR0aDogMTAwJTsKICAgICAgfQoKICAgIH0KICB9Cn0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2RA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/quality/detail","sourcesContent":["<template>\r\n  <el-dialog :title=\"title\" :visible.sync=\"openDialog\" width=\"60%\" custom-class=\"el-button--primary\" append-to-body :close-on-click-modal=\"false\" @close=\"handleDialogClose\">\r\n      <div ref=\"btns\">\r\n        <el-row :gutter=\"10\" class=\"mb8\">\r\n          <el-col :span=\"1.5\">\r\n            <el-button\r\n              type=\"primary\"\r\n              icon=\"el-icon-plus\"\r\n              size=\"mini\"\r\n              @click=\"handleAdd\"\r\n              v-hasPermi=\"['quality:index:add']\"\r\n            >新增</el-button>\r\n          </el-col>\r\n          <el-col :span=\"1.5\">\r\n            <el-button\r\n              type=\"success\"\r\n              icon=\"el-icon-edit\"\r\n              size=\"mini\"\r\n              :disabled=\"single\"\r\n              @click=\"handleUpdate\"\r\n              v-hasPermi=\"['quality:index:edit']\"\r\n            >修改</el-button>\r\n          </el-col>\r\n          <el-col :span=\"1.5\">\r\n            <el-button\r\n              type=\"danger\"\r\n              icon=\"el-icon-delete\"\r\n              size=\"mini\"\r\n              :disabled=\"multiple\"\r\n              @click=\"handleDelete\"\r\n              v-hasPermi=\"['quality:index:remove']\"\r\n            >删除</el-button>\r\n          </el-col>\r\n          <right-toolbar :showSearch.sync=\"showSearch\" @queryTable=\"getList\"></right-toolbar>\r\n        </el-row>\r\n      </div>\r\n    \r\n      <el-table style=\"overflow:hidden\" border stripe min-height=\"100px\" max-height=\"600px\" v-loading=\"loading\" :data=\"detailList\" @selection-change=\"handleSelectionChange\" ref=\"multipleTable\" @row-click=\"rowClick\" :row-style=\"rowStyle\" :row-class-name=\"rowClassName\">\r\n        <el-table-column type=\"selection\" width=\"55\" align=\"center\" />\r\n        <el-table-column show-overflow-tooltip sortable label=\"考评内容\" align=\"left\" prop=\"evaCont\">\r\n          <template slot-scope=\"scope\">\r\n            <el-link type=\"primary\" :underline=\"false\" v-html=\"scope.row.evaCont\" @click.stop=\"handleClickTableName(scope.row)\" class=\"displayBlock text-ellipsis \"></el-link>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column show-overflow-tooltip sortable label=\"考评标准\" align=\"left\" prop=\"evaCriteria\" />\r\n        <el-table-column show-overflow-tooltip sortable label=\"考评办法\" align=\"left\" prop=\"evaMethod\" />\r\n      </el-table>\r\n\r\n    <addEdit v-if=\"addOpen\" :open=\"addOpen\" :indexCodeDatas=\"datas\" :id=\"addEditId\" @cancel=\"cancel\" @success=\"successSubmit\"></addEdit>\r\n    \r\n    <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"handleDialogClose\">关 闭</el-button>\r\n      </div>\r\n  </el-dialog>\r\n</template>\r\n\r\n<script>\r\nimport { listDetail, getDetail, delDetail, addDetail, updateDetail, exportDetail } from \"@/api/quality/detail\";\r\nimport addEdit from \"./addEdit\";\r\n\r\nexport default {\r\n  name: \"Detail\",\r\n  props: {\r\n    open: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    id: {\r\n      type: [String, Number],\r\n      default: \"\"\r\n    },\r\n    datas:{\r\n      type:Array,\r\n      default:[]\r\n    }\r\n  },\r\n  watch: {\r\n    id: {\r\n      handler(val) {\r\n        this.reset();\r\n        if (val) {\r\n          this.id = val;\r\n          this.title = \"质量考评指标设置 / 编辑指标内容\";\r\n          // this.getDetailInfo();\r\n        } else {\r\n          this.id = \"\";\r\n          this.title = \"质量考评指标设置 / 编辑指标内容\";\r\n        }\r\n      },\r\n      deep: true,\r\n      immediate: true\r\n    },\r\n    open: {\r\n      handler(val) {\r\n        this.openDialog = val;\r\n      },\r\n      deep: true\r\n    },\r\n  },\r\n  components: {\r\n    addEdit\r\n  },\r\n  data() {\r\n    return {\r\n      // 遮罩层\r\n      loading: true,\r\n      openDialog: this.open,\r\n      // 导出遮罩层\r\n      exportLoading: false,\r\n      // 选中数组\r\n      ids: [],\r\n      // 非单个禁用\r\n      single: true,\r\n      // 非多个禁用\r\n      multiple: true,\r\n      // 显示搜索条件\r\n      showSearch: false,\r\n      // 总条数\r\n      total: 0,\r\n      // 质量考评指标明细表格数据\r\n      detailList: [],\r\n      selectionRow: [],\r\n      // 弹出层标题\r\n      title: \"\",\r\n      // 是否显示弹出层\r\n      addOpen: false,\r\n      // 是否KPI字典\r\n      isKpiOptions: [],\r\n      // 查询参数\r\n      queryParams: {\r\n        pageNum: 1,\r\n        pageSize: 30,\r\n        compCode:this.$store.state.user.userInfo.deptId,\r\n        indexCode: this.datas[0].indexCode,\r\n        evaCont: null,\r\n        evaCriteria: null,\r\n        evaMethod: null,\r\n        isKpi: null,\r\n      },\r\n      // 表单参数\r\n      form: {},\r\n      // 表单校验\r\n      rules: {\r\n      },\r\n    };\r\n  },\r\n  created() {\r\n    this.getList();\r\n    this.getDicts(\"hr_is_change\").then(response => {\r\n      this.isKpiOptions = response.data;\r\n    });\r\n  },\r\n  methods: {\r\n    handleClickTableName(data) {\r\n        // 选中当前行\r\n        this.rowClick(data, false);\r\n        this.handleUpdate(data);\r\n    },\r\n    /** 查询质量考评指标明细列表 */\r\n    getList() {\r\n      this.loading = true;\r\n      listDetail(this.queryParams).then(response => {\r\n        if(response.code===200){\r\n          this.detailList = response.rows;\r\n          this.total = response.total;\r\n          this.loading = false;\r\n        }\r\n      });\r\n    },\r\n    // 是否KPI字典翻译\r\n    isKpiFormat(row, column) {\r\n      return this.selectDictLabel(this.isKpiOptions, row.isKpi);\r\n    },\r\n    successSubmit(flag) {\r\n      this.addOpen = flag;\r\n      this.getList();\r\n    },\r\n    // 取消按钮\r\n    cancel() {\r\n      this.addOpen = false;\r\n      this.reset();\r\n      this.getList();\r\n    },\r\n    // 弹框关闭\r\n    handleDialogClose() {\r\n      this.$emit(\"cancel\", false);\r\n    },\r\n    // 表单重置\r\n    reset() {\r\n      this.form = {\r\n        id: null,\r\n        indexCode: null,\r\n        evaCont: null,\r\n        evaCriteria: null,\r\n        evaMethod: null,\r\n        isKpi: \"0\",\r\n        delFlag: null,\r\n        createBy: null,\r\n        createTime: null,\r\n        updateBy: null,\r\n        updateTime: null,\r\n        remark: null\r\n      };\r\n      this.resetForm(\"form\");\r\n    },\r\n    /** 搜索按钮操作 */\r\n    handleQuery() {\r\n      this.queryParams.pageNum = 1;\r\n      this.getList();\r\n    },\r\n    /** 重置按钮操作 */\r\n    resetQuery() {\r\n      this.resetForm(\"queryForm\");\r\n      this.handleQuery();\r\n    },\r\n    // 多选框选中数据\r\n    handleSelectionChange(selection) {\r\n      this.ids = selection.map(item => item.id)\r\n      this.single = selection.length!==1\r\n      this.multiple = !selection.length\r\n      this.selectionRow=selection\r\n    },\r\n    rowClick(row, column, event) {\r\n      let refsElTable = this.$refs.multipleTable;\r\n      let findRow = this.selectionRow.find(c => c.rowIndex == row.rowIndex);\r\n      if (findRow && this.selectionRow.length == 1) {\r\n        refsElTable.toggleRowSelection(row, false);\r\n        return;\r\n      }\r\n      refsElTable.clearSelection();\r\n      refsElTable.toggleRowSelection(row);\r\n    },\r\n    rowStyle({\r\n      row,\r\n      rowIndex\r\n    }) {\r\n      Object.defineProperty(row, 'rowIndex', {\r\n        value: rowIndex,\r\n        writable: true,\r\n        enumerable: false\r\n      })\r\n    },\r\n    rowClassName({\r\n      row,\r\n      rowIndex\r\n    }) {\r\n      let rowName = \"\",\r\n        findRow = this.selectionRow.find(c => c.rowIndex === row.rowIndex);\r\n      if (findRow) {\r\n        rowName = \"current-row \";\r\n      }\r\n      return rowName;\r\n    },\r\n    /** 新增按钮操作 */\r\n    handleAdd() {\r\n      this.addOpen = true; // 弹框点开\r\n      this.addEditId = \"\"; // addEditId 是新增  去子组件方便区分新增编辑\r\n    },\r\n    handleUpdate(row) {\r\n      this.reset();\r\n      const id = row.id || this.ids[0];\r\n      this.addOpen = true;\r\n      this.addEditId = id; // id赋值\r\n      console.log(\"addEditId---\" + addEdit);\r\n    },\r\n    /** 删除按钮操作 */\r\n    handleDelete(row) {\r\n      const ids = row.id || this.ids;\r\n      this.$confirm('是否确认删除质量考评指标明细编号为\"' + ids + '\"的数据项?', \"警告\", {\r\n          confirmButtonText: \"确定\",\r\n          cancelButtonText: \"取消\",\r\n          type: \"warning\"\r\n        }).then(function() {\r\n          return delDetail(ids);\r\n        }).then(() => {\r\n          this.getList();\r\n          this.msgSuccess(\"删除成功\");\r\n        }).catch(() => {});\r\n    },\r\n  }\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n  ::v-deep .el-dialog {\r\n    min-height: 20%;\r\n    overflow: hidden;\r\n    .el-dialog__body {\r\n      height: calc(100% - 100px);\r\n      overflow: auto;\r\n      .app-container{\r\n        .el-form-item{\r\n          width: 100%;\r\n        }\r\n        .el-form-item__content{\r\n          margin-left: 0 !important;\r\n          width:70%;\r\n        }\r\n        .el-select{\r\n          width: 100%;\r\n        }\r\n\r\n      }\r\n    }\r\n  }\r\n</style>\r\n\r\n"]}]}