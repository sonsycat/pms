{"remainingRequest":"D:\\hrp\\zjry-pms-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\hrp\\zjry-pms-ui\\src\\views\\skill\\monograph\\addEdit.vue?vue&type=style&index=0&id=ea1abac2&lang=scss&scoped=true&","dependencies":[{"path":"D:\\hrp\\zjry-pms-ui\\src\\views\\skill\\monograph\\addEdit.vue","mtime":1682043108637},{"path":"D:\\hrp\\zjry-pms-ui\\node_modules\\css-loader\\dist\\cjs.js","mtime":1682058377861},{"path":"D:\\hrp\\zjry-pms-ui\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1682058382042},{"path":"D:\\hrp\\zjry-pms-ui\\node_modules\\postcss-loader\\src\\index.js","mtime":1682058378631},{"path":"D:\\hrp\\zjry-pms-ui\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1682058378517},{"path":"D:\\hrp\\zjry-pms-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1682058377348},{"path":"D:\\hrp\\zjry-pms-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":1682058381348}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCjo6di1kZWVwIC5lbC1kaWFsb2cgewogIGhlaWdodDogNjAlOwogIG92ZXJmbG93OiBoaWRkZW47CiAgLmVsLWRpYWxvZ19fYm9keSB7CiAgICBoZWlnaHQ6IGNhbGMoMTAwJSAtIDEwMHB4KTsKICAgIG92ZXJmbG93OiBhdXRvOwogIH0KICAuZWwtaW5wdXQtbnVtYmVyLS1taW5pewogICAgd2lkdGg6IDEwMCU7CiAgfQp9Cg=="},{"version":3,"sources":["addEdit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAubA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"addEdit.vue","sourceRoot":"src/views/skill/monograph","sourcesContent":["<template>\n    <el-dialog :title=\"title\" :visible.sync=\"openDialog\" width=\"50%\" custom-class=\"el-button--primary\" append-to-body :close-on-click-modal=\"false\" @close=\"handleDialogClose\">\n      <el-form ref=\"form\" :model=\"form\" :rules=\"rules\" label-width=\"80px\">\n        <el-row>\n          <el-col :span=\"12\">\n            <el-form-item label=\"科室\" prop=\"deptCode\">\n              <el-select v-model=\"form.deptCode\" clearable placeholder=\"请选择科室\" class=\"w100\" filterable clearable>\n                <el-option\n                  v-for=\"item in deptList\"\n                  :key=\"item.deptRoomId\"\n                  :label=\"item.deptRoomName\"\n                  :value=\"item.deptRoomId\">\n                </el-option>\n              </el-select>\n            </el-form-item>\n          </el-col>\n          <el-col :span=\"12\">\n            <el-form-item label=\"专著名称\" prop=\"monographName\">\n              <el-input v-model=\"form.monographName\" placeholder=\"请输入专著名称\"  maxlength=\"100\" show-word-limit  />\n            </el-form-item>\n          </el-col>\n          <el-col :span=\"12\">\n            <el-form-item label=\"专著级别\" prop=\"monographType\">\n              <el-select v-model=\"form.monographType\" placeholder=\"请选择专著级别\" class=\"w100\">\n                <el-option\n                  v-for=\"dict in monographTypeOptions\"\n                  :key=\"dict.dictValue\"\n                  :label=\"dict.dictLabel\"\n                  :value=\"dict.dictValue\"\n                ></el-option>\n              </el-select>\n            </el-form-item>\n          </el-col>\n          <el-col :span=\"12\">\n            <el-form-item label=\"出版社\" prop=\"publish\">\n              <el-input v-model=\"form.publish\" placeholder=\"请输入出版社\"  maxlength=\"50\" show-word-limit  />\n            </el-form-item>\n          </el-col>\n          <el-col :span=\"12\">\n            <el-form-item label=\"出版时间\" prop=\"publisTime\">\n              <el-date-picker clearable size=\"small\" class=\"w100\"\n                              v-model=\"form.publisTime\"\n                              type=\"date\"\n                              value-format=\"yyyy-MM-dd\"\n                              placeholder=\"选择出版时间\">\n              </el-date-picker>\n            </el-form-item>\n          </el-col>\n          <el-col :span=\"12\">\n            <el-form-item label=\"期刊号\" prop=\"issn\">\n              <el-input v-model=\"form.issn\" placeholder=\"请输入期刊号\"  maxlength=\"20\" show-word-limit  />\n            </el-form-item>\n          </el-col>\n        </el-row>\n        <el-row>\n          <el-col :span=\"12\">\n            <el-form-item label=\"杂志名称\" prop=\"magazine\">\n              <el-input v-model=\"form.magazine\" placeholder=\"请输入杂志名称\"  maxlength=\"120\" show-word-limit  />\n            </el-form-item>\n          </el-col>\n          <el-col :span=\"12\">\n            <el-form-item label=\"字数\" prop=\"wordNum\">\n              <el-input-number v-model=\"form.wordNum\" max=\"9999999\" :min=\"1\" :step=\"1\" placeholder=\"请输入字数\" maxlength=\"10\" controls-position=\"right\" step-strictly/>\n            </el-form-item>\n          </el-col>\n          <el-col :span=\"12\">\n            <el-form-item label=\"图书编号\" prop=\"bookNumber\">\n              <el-input v-model=\"form.bookNumber\" placeholder=\"请输入图书编号\"  maxlength=\"100\" show-word-limit  />\n            </el-form-item>\n          </el-col>\n          <el-col :span=\"12\">\n            <el-form-item label=\"开本\" prop=\"folio\">\n              <el-select v-model=\"form.folio\" placeholder=\"请选择开本\" class=\"w100\">\n                <el-option\n                  v-for=\"dict in folioOptions\"\n                  :key=\"dict.dictValue\"\n                  :label=\"dict.dictLabel\"\n                  :value=\"dict.dictValue\"\n                ></el-option>\n              </el-select>\n            </el-form-item>\n          </el-col>\n          <el-col :span=\"12\">\n            <el-form-item label=\"印刷数量\" prop=\"priteNum\">\n              <el-input-number v-model=\"form.priteNum\" max=\"9999999\" :min=\"1\" :step=\"1\" placeholder=\"请输入印刷数量\" maxlength=\"10\" controls-position=\"right\" step-strictly show-word-limit/>\n            </el-form-item>\n          </el-col>\n          <el-col :span=\"12\">\n            <el-form-item label=\"会议名称\" prop=\"meetName\">\n              <el-input v-model=\"form.meetName\" placeholder=\"请输入会议名称\"  maxlength=\"100\" show-word-limit  />\n            </el-form-item>\n          </el-col>\n          <el-col :span=\"12\">\n            <el-form-item label=\"作者\" prop=\"author\">\n              <el-input v-model=\"form.author\" placeholder=\"请输入作者\"  maxlength=\"50\" show-word-limit  />\n            </el-form-item>\n          </el-col>\n          <el-col :span=\"12\">\n            <el-form-item label=\"担任职务\" prop=\"position\">\n              <el-select v-model=\"form.position\" placeholder=\"请选择担任职务\" class=\"w100\">\n                <el-option\n                  v-for=\"dict in positionOptions\"\n                  :key=\"dict.dictValue\"\n                  :label=\"dict.dictLabel\"\n                  :value=\"dict.dictValue\"\n                ></el-option>\n              </el-select>\n            </el-form-item>\n          </el-col>\n          <el-col :span=\"12\">\n            <el-form-item label=\"会议时间\" prop=\"meetTime\">\n              <el-date-picker clearable size=\"small\" class=\"w100\"\n                              v-model=\"form.meetTime\"\n                              type=\"date\"\n                              value-format=\"yyyy-MM-dd\"\n                              placeholder=\"选择会议时间\">\n              </el-date-picker>\n            </el-form-item>\n          </el-col>\n        </el-row>\n        <formItem  :showDialog.sync=\"showDialog\" :showBaseInfo=\"btn3\" :open=\"btn4\" :open2=\"btn5\" :comment = \"form\" :userOptions=\"userOptions\" @success=\"formItemSuccess\"></formItem>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <btns v-if=\"btn3\" @success=\"successSubmit\" :open=\"btn3\" :id=\"id\" :proclnsIds=\"proclnsIds\" :comment=\"form.comment\" :assignee=\"form.assignee\" ></btns>\n        <el-button v-if=\"btn2\"  type=\"primary\" @click=\"submitFormContinue\" >保存并提交</el-button>\n        <el-button v-if=\"btn1\"  type=\"primary\" @click=\"submitForm\" >保 存</el-button>\n        <el-button @click=\"cancel\">取 消</el-button>\n      </div>\n    </el-dialog>\n</template>\n\n<script>\nimport { validEmail } from'@/utils/validate'\nimport { listMonograph, getMonograph, delMonograph, addMonograph, updateMonograph, updateMonograph1, exportMonograph } from \"@/api/skill/monograph\";\nimport { treeRoom, getEmpList } from \"@/api/until\";\nimport btns from \"@/views/skill/monograph/btns\";\nimport formItem from \"@/views/components/formItemNew\";\n\nexport default {\n  name: \"addEdit\",\n  props: {\n    open: {\n      type: Boolean,\n      default: false\n    },\n    id: {\n      type: [String, Number],\n      default: \"\"\n    },\n    proclnsIds: {\n      type: [String, Number],\n      default: \"\"\n    },\n  },\n  watch: {\n    \"form.compCode\": {\n      handler(val) {\n        this.getTreeDept(val);\n      },\n      deep: true,\n      immediate: true\n    },\n    id: {\n      handler(val) {\n        this.reset();\n        if (val) {\n          this.id = val;\n          if(val!=0){\n            this.title = \"专著管理 / 修改\";\n          }else{\n            this.title = \"专著管理 / 新增\";\n          }\n          this.getDetailInfo();\n        } else {\n          this.id = \"\";\n          this.title = \"专著管理-新增\";\n        }\n      },\n      deep: true,\n      immediate: true\n    },\n    open: {\n      handler(val) {\n        this.openDialog = val;\n      },\n      deep: true\n    }\n  },\n  components: {\n    btns,formItem\n  },\n  data() {\n    return {\n      showDialog:false,\n      title: \"专著管理-新增\",\n      openDialog: this.open,\n      // 表单参数\n      form: {},\n      monographTypeOptions: [],\n      folioOptions: [],\n      positionOptions: [],\n      deptList: [],\n      //用户列表\n      userOptions: [],\n\t  \t  \t  \t  \t  \t  \t  \t  \t  \t  \t  \t  \t  \t  \t  \t  \t  \t  \t  \t  \t  \t  \t  \t        // 表单校验\n      rules: {\n        monographCode: [\n          { required: true, message: \"专著编码不能为空\", trigger: \"blur\" }\n        ],\n        monographName: [\n          { required: true, message: \"专著名称不能为空\", trigger: \"blur\" }\n        ],\n        monographType: [\n          { required: true, message: \"专著级别不能为空\", trigger: \"change\" }\n        ],\n        deptCode: [\n          { required: true, message: \"科室编码不能为空\", trigger: \"blur\" }\n        ],\n        publish: [\n          { required: true, message: \"出版社不能为空\", trigger: \"blur\" }\n        ],\n        publisTime: [\n          { required: true, message: \"出版时间不能为空\", trigger: \"blur\" }\n        ],\n        issn: [\n          { required: true, message: \"期刊号不能为空\", trigger: \"blur\" }\n        ],\n        magazine: [\n          { required: true, message: \"杂志名称不能为空\", trigger: \"blur\" }\n        ],\n        wordNum: [\n          { required: true, message: \"字数不能为空\", trigger: \"blur\" }\n        ],\n        author: [\n          { required: true, message: \"作者不能为空\", trigger: \"blur\" }\n        ],\n        bookNumber: [\n          { required: true, message: \"图书编号不能为空\", trigger: \"blur\" }\n        ],\n        folio: [\n          { required: true, message: \"开本不能为空\", trigger: \"change\" }\n        ],\n        priteNum: [\n          { required: true, message: \"印刷数量不能为空\", trigger: \"blur\" }\n        ],\n        position: [\n          { required: true, message: \"担任职务不能为空\", trigger: \"change\" }\n        ],\n        meetName: [\n          { required: true, message: \"会议名称不能为空\", trigger: \"blur\" }\n        ],\n        meetTime: [\n          { required: true, message: \"会议时间不能为空\", trigger: \"blur\" }\n        ],\n        annex: [\n          { required: true, message: \"附件不能为空\", trigger: \"blur\" }\n        ],\n        assignee: [\n          {\n            required: true,\n            message: \"下一节点审核人不能为空\",\n            trigger: \"change\"\n          }\n        ],\n      },\n      // 下级节点办理人\n      nextAssignee: [],\n      // 按钮编码\n      btn1: false,\n      btn2: false,\n      btn3: false,\n      btn4: false,\n      btn5: false,\n      datas: {},\n\n    };\n  },\n  created() {\n    this.getList();\n    this.getDicts(\"skill_lwjb\").then(response => {\n      this.monographTypeOptions = response.data;\n    });\n    this.getDicts(\"SKILL_FOLIO\").then(response => {\n      this.folioOptions = response.data;\n    });\n    this.getDicts(\"SKILL_POSITION\").then(response => {\n      this.positionOptions = response.data;\n    });\n  },\n  methods: {\n    successSubmit() {\n      this.$emit(\"success\", false);\n    },\n    //获取科室列表\n    getTreeDept(deptId) {\n      let data = {\n        deptId: this.$store.state.user.userInfo.deptId\n      };\n      this.formDeptList = [];\n      treeRoom(data).then(response => {\n        if (response.code == 200) {\n          this.deptList = response.rows;\n        } else {\n          this.msgError(response.msg);\n        }\n      });\n    },\n  \tgetDetailInfo() {\n      getMonograph(this.id).then(response => {\n        console.log(response);\n        this.form = response.data;\n        let that = this;\n        let proclnsIds = response.data.procedureId;\n        this.datas = {\n        };\n        getEmpList(\n          that,\n          this.$store.state.user.name,\n          proclnsIds,\n          this.userOptions,\n          this.btn1,\n          this.btn2,\n          this.btn3,\n          this.btn4,\n          this.btn5\n        );\n      });\n    },\n    /** 查询专著列表 */\n    getList() {\n      this.loading = true;\n      listMonograph(this.queryParams).then(response => {\n        this.monographList = response.rows;\n        this.total = response.total;\n        this.loading = false;\n      });\n    },\n    // 专著级别字典翻译\n    monographTypeFormat(row, column) {\n      return this.selectDictLabel(this.monographTypeOptions, row.monographType);\n    },\n    // 开本字典翻译\n    folioFormat(row, column) {\n      return this.selectDictLabel(this.folioOptions, row.folio);\n    },\n    // 担任职务字典翻译\n    positionFormat(row, column) {\n      return this.selectDictLabel(this.positionOptions, row.position);\n    },\n    // 弹框关闭\n    handleDialogClose() {\n      this.$emit(\"cancel\", false);\n    },\n    // 取消\n    cancel() {\n      this.$emit(\"cancel\", false);\n    },\n    // 表单重置\n    reset() {\n      this.form = {\n        id: null,\n        compCode: this.$store.state.user.userInfo.deptId,\n        accountCode: null,\n        monographCode: null,\n        monographName: null,\n        monographType: null,\n        deptCode: null,\n        publish: null,\n        publisTime: null,\n        issn: null,\n        magazine: null,\n        wordNum: null,\n        author: null,\n        bookNumber: null,\n        folio: null,\n        priteNum: null,\n        position: null,\n        meetName: null,\n        meetTime: null,\n        annex: null,\n        auditState: null,\n        procedureId: null,\n        delFlag: null,\n        createBy: null,\n        createTime: null,\n        updateBy: null,\n        updateTime: null,\n        remark: null\n      };\n      this.resetForm(\"form\");\n    },\n    /** 提交按钮 */\n    submitForm() {\n      this.$refs[\"form\"].validate(valid => {\n        if (valid) {\n        let saveLoading = this.saveLoading();\n          this.form.compCode = this.$store.state.user.userInfo.deptId;\n          if (this.form.id != null) {\n            updateMonograph(this.form).then(response => {\n              this.msgSuccess(\"修改成功\");\n              this.$emit(\"success\", false);\n              saveLoading.close();\n            });\n          } else {\n            addMonograph(this.form).then(response => {\n              this.msgSuccess(\"新增成功\");\n              this.$emit(\"success\", false);\n              saveLoading.close();\n            });\n          }\n        }\n      });\n    },\n    submitFormContinue() {\n      this.$refs[\"form\"].validate(valid => {\n        if (valid) {\n          // 下级审核人弹框\n          this.showDialog = true\n        }else{\n          this.msgError(\"请输入必填项\");\n        }\n      });\n    },\n    formItemSuccess(data) {\n      this.form = JSON.parse(JSON.stringify(data))\n      this.form.compCode = this.$store.state.user.userInfo.deptId;\n      let saveLoading = this.saveLoading();\n      updateMonograph1(this.form).then(response => {\n        this.msgSuccess(\"修改成功\");\n        this.$emit(\"success\", false);\n        saveLoading.close()\n      }).catch(()=>{\n        saveLoading.close()\n      });\n\n    },\n}};\n</script>\n<style lang=\"scss\" scoped>\n  ::v-deep .el-dialog {\n    height: 60%;\n    overflow: hidden;\n    .el-dialog__body {\n      height: calc(100% - 100px);\n      overflow: auto;\n    }\n    .el-input-number--mini{\n      width: 100%;\n    }\n  }\n</style>\n"]}]}