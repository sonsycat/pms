{"remainingRequest":"D:\\ys+jx\\ys+jx\\zjry-pms-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\ys+jx\\ys+jx\\zjry-pms-ui\\src\\views\\revenue\\revenue\\revenueDept.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\ys+jx\\ys+jx\\zjry-pms-ui\\src\\views\\revenue\\revenue\\revenueDept.vue","mtime":1682043106419},{"path":"D:\\ys+jx\\ys+jx\\zjry-pms-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1682058377348},{"path":"D:\\ys+jx\\ys+jx\\zjry-pms-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":1682058380827},{"path":"D:\\ys+jx\\ys+jx\\zjry-pms-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1682058377348},{"path":"D:\\ys+jx\\ys+jx\\zjry-pms-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":1682058381348}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQoNCmltcG9ydCB7IGdldFJldmVudWVEZXB0LGdldERlcHRMaXN0LGFkZERlcHRMaXN0IH0gZnJvbSAiQC9hcGkvcmV2ZW51ZS9yZXZlbnVlIjsNCg0KDQpleHBvcnQgZGVmYXVsdCB7DQogICAgbmFtZTogJ3JldmVudWVEZXB0JywNCiAgICBwcm9wczp7DQogICAgICAgIC8vIOS8oOWPguS4umZvcm3ooajljZUg5pa55L6/5pWw5o2u5Zue5pi+5riy5p+TDQogICAgICAgIHF1ZXJ5UGFyYW1zOiB7DQogICAgICAgICAgICB0eXBlOiBbT2JqZWN0LCBBcnJheV0NCiAgICAgICAgfSwNCiAgICAgICAgb3Blbjogew0KICAgICAgICAgICAgdHlwZTogQm9vbGVhbiwNCiAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlDQogICAgICAgIH0sDQogICAgICAgIGlkOiB7DQogICAgICAgICAgICB0eXBlOiBbU3RyaW5nLCBOdW1iZXJdLA0KICAgICAgICAgICAgZGVmYXVsdDogIiINCiAgICAgICAgfSwNCiAgICB9LA0KICAgIHdhdGNoOnsNCiAgICAgICAgIG9wZW46IHsNCiAgICAgICAgICAgIGhhbmRsZXIodmFsKSB7DQogICAgICAgICAgICAgICAgdGhpcy5vcGVuRGlhbG9nID0gdmFsOw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIGRlZXA6IHRydWUNCiAgICAgICAgfQ0KICAgIH0sDQogICAgZGF0YSgpIHsNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIHRpdGxlOifmlLblhaXmoLjnrpfmlrnmoYgt56ys5LiJ5pa556eR5a6kJywgICAgICAgIA0KICAgICAgICAgICAgb3BlbkRpYWxvZzogdGhpcy5vcGVuLCAgDQogICAgICAgICAgICBsb2FkaW5nOmZhbHNlLA0KICAgICAgICAgICAgbG9hZGluZzE6ZmFsc2UsDQogICAgICAgICAgICBsb2FkaW5nMjpmYWxzZSwNCiAgICAgICAgICAgIGxvYWRpbmczOmZhbHNlLA0KICAgICAgICAgICAgY2xpY2tDb3VudDowLA0KICAgICAgICAgICAgYWN0aXZlTmFtZTogIm91dFBhdGllbnQiLCANCiAgICAgICAgICAgIHBhdFRvUmlnaHRCb29sOnRydWUsDQogICAgICAgICAgICBwYXRUb0xlZnRCb29sOnRydWUsDQogICAgICAgICAgICBob3NUb1JpZ2h0Qm9vbDp0cnVlLA0KICAgICAgICAgICAgaG9zVG9MZWZ0Qm9vbDp0cnVlLA0KICAgICAgICAgICAgZm9ybTp7DQogICAgICAgICAgICAgICAgb3V0cGF0aWVudFNlcnZpY2VMZWZ0OltdLC8v6Zeo6K+K5bem5L6n5pWw5o2uDQogICAgICAgICAgICAgICAgb3V0cGF0aWVudFNlcnZpY2VSaWdodDpbXSwvL+mXqOiviuWPs+S+p+aVsOaNrg0KICAgICAgICAgICAgICAgIGhvc3BpdGFsU2VydmljZUxlZnQ6W10sLy/kvY/pmaLlt6bkvqfmlbDmja4NCiAgICAgICAgICAgICAgICBob3NwaXRhbFNlcnZpY2VSaWdodDpbXSwvL+S9j+mZouWPs+S+p+aVsOaNrg0KICAgICAgICAgICAgfSwgICAgICAgIA0KICAgICAgICAgICAgcnVsZXM6e30sDQogICAgICAgICAgICBkZXB0RGF0YXM6W10sLy/pl6jor4rnp5HlrqTliJfooajmlbDmja4NCiAgICAgICAgICAgIGRlcHREYXRhc0xlbmd0aDowLC8v6Zeo6K+K56eR5a6k5YiX6KGo5pWw5o2u55So5LqO5q+U6L6D5YWo6YCJ5pWw5o2uDQogICAgICAgICAgICBjaGFuZ2VEZXB0TGlzdDE6W10sDQogICAgICAgICAgICBjaGFuZ2VEZXB0TGlzdDpbXSwNCiAgICAgICAgICAgIGRlcHREYXRhc0hvczpbXSwvL+mXqOiviuenkeWupOWIl+ihqOaVsOaNrg0KICAgICAgICAgICAgY2hhbmdlSG9zRGVwdExpc3Q6W10sDQogICAgICAgICAgICBjaGFuZ2VIb3NEZXB0TGlzdDE6W10sDQogICAgICAgICAgICBvdXRwYXRpZW50UmlnaHRMZW5ndGg6W10sDQogICAgICAgICAgICBob3NwaXRhbFJpZ2h0TGVuZ3RoOltdLA0KICAgICAgICAgICAgc2VsZWN0aW9uUm93b3V0cGF0aWVudExlZnQ6W10sLy/pl6jor4rlt6bkvqflpI3pgInmoYbmlbDmja4NCiAgICAgICAgICAgIHNlbGVjdGlvblJvd091dHBhdGllbnRSaWdodDpbXSwvL+mXqOiviuWPs+S+p+WkjemAieahhuaVsOaNrg0KICAgICAgICAgICAgc2VsZWN0aW9uUm93aG9zcGl0YWxMZWZ0OltdLC8v5L2P6Zmi5bem5L6n5aSN6YCJ5qGG5pWw5o2uDQogICAgICAgICAgICBzZWxlY3Rpb25Sb3dob3NwaXRhbFJpZ2h0OltdLC8v5L2P6Zmi5Y+z5L6n5aSN6YCJ5qGG5pWw5o2uDQogICAgICAgIH07DQogICAgfSwNCiAgICBjb21wdXRlZDp7DQogICAgICAgIG51bSgpey8v6K6h566X5bGe5oCn5Lyg6YCS5Y+C5pWw77yM5qC55o2u5Lyg5YWl55qE5pWw57uE6L+U5Zue56ym5ZCI5p2h5Lu255qE6ZW/5bqmDQoJCSAgcmV0dXJuIGRhdGEgPT4gIHRoaXMuZm9ybS5vdXRwYXRpZW50U2VydmljZUxlZnQmJnRoaXMuc2VsZWN0aW9uUm93b3V0cGF0aWVudExlZnQubGVuZ3RoDQogICAgICAgIH0sDQogICAgICAgIG51bTEoKXsvL+iuoeeul+WxnuaAp+S8oOmAkuWPguaVsO+8jOagueaNruS8oOWFpeeahOaVsOe7hOi/lOWbnuespuWQiOadoeS7tueahOmVv+W6pg0KICAgICAgICAgICAgcmV0dXJuIGRhdGEgPT4gIHRoaXMuZm9ybS5ob3NwaXRhbFNlcnZpY2VMZWZ0JiZ0aGlzLnNlbGVjdGlvblJvd091dHBhdGllbnRSaWdodC5sZW5ndGgNCiAgICAgICAgfSwNCiAgICAgICAgbnVtMigpey8v6K6h566X5bGe5oCn5Lyg6YCS5Y+C5pWw77yM5qC55o2u5Lyg5YWl55qE5pWw57uE6L+U5Zue56ym5ZCI5p2h5Lu255qE6ZW/5bqmDQogICAgICAgICAgICByZXR1cm4gZGF0YSA9PiAgdGhpcy5mb3JtLmhvc3BpdGFsU2VydmljZUxlZnQmJnRoaXMuc2VsZWN0aW9uUm93aG9zcGl0YWxMZWZ0Lmxlbmd0aA0KICAgICAgICB9LA0KICAgICAgICBudW0zKCl7Ly/orqHnrpflsZ7mgKfkvKDpgJLlj4LmlbDvvIzmoLnmja7kvKDlhaXnmoTmlbDnu4Tov5Tlm57nrKblkIjmnaHku7bnmoTplb/luqYNCiAgICAgICAgICAgIHJldHVybiBkYXRhID0+ICB0aGlzLmZvcm0uaG9zcGl0YWxTZXJ2aWNlTGVmdCYmdGhpcy5zZWxlY3Rpb25Sb3dob3NwaXRhbFJpZ2h0Lmxlbmd0aA0KICAgICAgICB9DQogICAgfSwNCiAgICBjcmVhdGVkKCl7DQogICAgICAgICB0aGlzLmdldERldGFpbCgxKSAgICAgICAgDQogICAgICAgICB0aGlzLmdldFRyZWVEZXB0KHsgY29tcENvZGU6IHRoaXMuJHN0b3JlLnN0YXRlLnVzZXIuYWNjb3VudEluZm8uZGVwdElkICxjbGluaWNUeXBlOjF9KQ0KICAgIH0sDQogICAgbW91bnRlZCgpIHsNCiAgICB9LA0KICAgIG1ldGhvZHM6IHsNCiAgICAgICAgLy/np5HlrqTmn6Xor6LkuIvmi4nmoYbkuovku7YNCiAgICAgICAgY2hhbmdlRGVwdChlKXsNCiAgICAgICAgICAgIGlmKHRoaXMuYWN0aXZlTmFtZT09J291dFBhdGllbnQnKXsNCiAgICAgICAgICAgICAgICBsZXQgZGF0YQ0KICAgICAgICAgICAgICAgIGlmKGUpew0KICAgICAgICAgICAgICAgICAgICBkYXRhID0geyBjb21wQ29kZTogdGhpcy4kc3RvcmUuc3RhdGUudXNlci5hY2NvdW50SW5mby5kZXB0SWQgLGNsaW5pY1R5cGU6MSxkZXB0TmFtZTplfTsNCiAgICAgICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHsgY29tcENvZGU6IHRoaXMuJHN0b3JlLnN0YXRlLnVzZXIuYWNjb3VudEluZm8uZGVwdElkICxjbGluaWNUeXBlOjF9OyAgICAgIA0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB0aGlzLmdldFRyZWVEZXB0KGRhdGEpDQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZih0aGlzLmFjdGl2ZU5hbWU9PSdob3NwaXRhbCcpew0KICAgICAgICAgICAgICAgbGV0IGRhdGENCiAgICAgICAgICAgICAgICBpZihlKXsNCiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHsgY29tcENvZGU6IHRoaXMuJHN0b3JlLnN0YXRlLnVzZXIuYWNjb3VudEluZm8uZGVwdElkICxjbGluaWNUeXBlOjIsZGVwdE5hbWU6ZX07DQogICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgIGRhdGEgPSB7IGNvbXBDb2RlOiB0aGlzLiRzdG9yZS5zdGF0ZS51c2VyLmFjY291bnRJbmZvLmRlcHRJZCAsY2xpbmljVHlwZToyfTsgICAgICANCiAgICAgICAgICAgICAgICB9IA0KICAgICAgICAgICAgICAgIHRoaXMuZ2V0VHJlZURlcHQoZGF0YSkgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICAvL3RhYuWIh+aNouS6i+S7tg0KICAgICAgIGFzeW5jIGhhbmRsZUNsaWNrKHRhYil7DQogICAgICAgICAgICBpZih0YWIubGFiZWw9PSLkvY/pmaIiKXsNCiAgICAgICAgICAgICAgICB0aGlzLmNoYW5nZUhvc0RlcHRMaXN0PVtdDQogICAgICAgICAgICAgICAgdGhpcy5jaGFuZ2VIb3NEZXB0TGlzdDE9W10NCiAgICAgICAgICAgICAgICAvLyB0aGlzLmZvcm0uaG9zcGl0YWxTZXJ2aWNlTGVmdD1bXSAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZU5hbWU9J2hvc3BpdGFsJw0KICAgICAgICAgICAgICAgIGlmKHRoaXMuY2xpY2tDb3VudD09MCl7DQogICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZ2V0RGV0YWlsKDIpICANCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdGhpcy5jbGlja0NvdW50Kz0xDQogICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5nZXRUcmVlRGVwdCh7IGNvbXBDb2RlOiB0aGlzLiRzdG9yZS5zdGF0ZS51c2VyLmFjY291bnRJbmZvLmRlcHRJZCAsY2xpbmljVHlwZToyfSkNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmKHRhYi5sYWJlbD09J+mXqOiviicpew0KICAgICAgICAgICAgICAgIC8vIHRoaXMuZm9ybS5vdXRwYXRpZW50U2VydmljZUxlZnQ9W10NCiAgICAgICAgICAgICAgICB0aGlzLmNoYW5nZURlcHRMaXN0MT1bXQ0KICAgICAgICAgICAgICAgIHRoaXMuY2hhbmdlRGVwdExpc3Q9W10NCiAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZU5hbWU9J291dFBhdGllbnQnICAgDQogICAgICAgICAgICAgICBhd2FpdCB0aGlzLmdldFRyZWVEZXB0KHsgY29tcENvZGU6IHRoaXMuJHN0b3JlLnN0YXRlLnVzZXIuYWNjb3VudEluZm8uZGVwdElkICxjbGluaWNUeXBlOjF9KSANCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgLy/ojrflj5bpl6jor4rlj4rkvY/pmaLlj7PkvqfliJfooajmlbDmja4NCiAgICAgICAgYXN5bmMgZ2V0RGV0YWlsKHR5cGUpew0KICAgICAgICAgICAgbGV0IHBhcmFtcz17DQogICAgICAgICAgICAgICAgY29tcENvZGU6dGhpcy5xdWVyeVBhcmFtcy5jb21wQ29kZSwNCiAgICAgICAgICAgICAgICByZXZlbnVlQ29kZTp0aGlzLnF1ZXJ5UGFyYW1zLnJldmVudWVDb2RlLA0KICAgICAgICAgICAgICAgIGRlcHRUeXBlOnR5cGUNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmKHR5cGU9PTEpew0KICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZzE9dHJ1ZQ0KICAgICAgICAgICAgICAgIGxldCBhcnI9W10NCiAgICAgICAgICAgICAgICBhd2FpdCBnZXRSZXZlbnVlRGVwdChwYXJhbXMpLnRoZW4ocmVzcG9uc2UgPT4geyAgICAgICANCiAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBpPTA7aTxyZXNwb25zZS50b3RhbDtpKyspew0KICAgICAgICAgICAgICAgICAgICAgICAgYXJyLmluZGV4T2YocmVzcG9uc2Uucm93c1tpXSk9PT0tMT9hcnIucHVzaCh7cmF0aW86cmVzcG9uc2Uucm93c1tpXS5yYXRpbyxkaWN0VmFsdWU6cmVzcG9uc2Uucm93c1tpXS5kZXB0Q29kZSxkaWN0TGFiZWw6cmVzcG9uc2Uucm93c1tpXS5kZXB0TmFtZX0pOmFycg0KICAgICAgICAgICAgICAgICAgICB9IA0KICAgICAgICAgICAgICAgICAgICB0aGlzLmZvcm0ub3V0cGF0aWVudFNlcnZpY2VSaWdodCA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYXJyKSk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMub3V0cGF0aWVudFJpZ2h0TGVuZ3RoPXJlc3BvbnNlLnRvdGFsDQogICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZzE9ZmFsc2UgDQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgcmV0dXJuDQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZih0eXBlPT0yKXsNCiAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmczPXRydWUNCiAgICAgICAgICAgICAgICBsZXQgYXJyPVtdDQogICAgICAgICAgICAgICBhd2FpdCBnZXRSZXZlbnVlRGVwdChwYXJhbXMpLnRoZW4ocmVzcG9uc2UgPT4gew0KICAgICAgICAgICAgICAgICAgIGZvcihsZXQgaT0wO2k8cmVzcG9uc2UudG90YWw7aSsrKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFyci5pbmRleE9mKHJlc3BvbnNlLnJvd3NbaV0pPT09LTE/YXJyLnB1c2goe3JhdGlvOnJlc3BvbnNlLnJvd3NbaV0ucmF0aW8sZGljdFZhbHVlOnJlc3BvbnNlLnJvd3NbaV0uZGVwdENvZGUsZGljdExhYmVsOnJlc3BvbnNlLnJvd3NbaV0uZGVwdE5hbWV9KTphcnINCiAgICAgICAgICAgICAgICAgICAgfSANCiAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtLmhvc3BpdGFsU2VydmljZVJpZ2h0ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShhcnIpKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5ob3NwaXRhbFJpZ2h0TGVuZ3RoPXJlc3BvbnNlLnRvdGFsIA0KICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmczPWZhbHNlICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIHJldHVybg0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgIA0KICAgICAgICB9LA0KICAgICAgICAvL+iOt+WPluenkeWupOWIl+ihqOWPiumXqOiviuWSjOS9j+mZouW3puS+p+aVsOaNrg0KICAgICAgICBhc3luYyBnZXRUcmVlRGVwdChkYXRhKSB7DQogICAgICAgICAgICAgdGhpcy5sb2FkaW5nPXRydWUNCiAgICAgICAgICAgICB0aGlzLmxvYWRpbmcyPXRydWUNCiAgICAgICAgICAgICBpZih0aGlzLmNsaWNrQ291bnQ9PTApew0KICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZ2V0RGV0YWlsKDIpDQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGlzLmNsaWNrQ291bnQrPTENCiAgICAgICAgICAgIGF3YWl0IGdldERlcHRMaXN0KGRhdGEpLnRoZW4ocmVzcG9uc2UgPT4gew0KICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5jb2RlID09IDIwMCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRlcHREYXRhc0xlbmd0aD1yZXNwb25zZS5kYXRhLmxlbmd0aA0KICAgICAgICAgICAgICAgICAgICBpZihkYXRhLmNsaW5pY1R5cGU9PTEpew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5mb3JtLm91dHBhdGllbnRTZXJ2aWNlTGVmdD1bXQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGFuZ2VEZXB0TGlzdDE9W10NCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhbmdlRGVwdExpc3Q9W10NCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGVwdERhdGFzPUpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocmVzcG9uc2UuZGF0YS5tYXAoaXRlPT57DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlLnJhdGlvPTANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlDQogICAgICAgICAgICAgICAgICAgICAgICB9KSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5vdXRwYXRpZW50UmlnaHRMZW5ndGghPT0wIHx8IHRoaXMuZm9ybS5vdXRwYXRpZW50U2VydmljZVJpZ2h0Lmxlbmd0aD09MSl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGFuZ2VEZXB0TGlzdDE9SlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShyZXNwb25zZS5kYXRhLm1hcChpdGU9PnsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGUucmF0aW89MA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGUNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBpIGluIHRoaXMuZm9ybS5vdXRwYXRpZW50U2VydmljZVJpZ2h0KXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcihsZXQgayBpbiB0aGlzLmNoYW5nZURlcHRMaXN0MSl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih0aGlzLmZvcm0ub3V0cGF0aWVudFNlcnZpY2VSaWdodFtpXS5kaWN0VmFsdWUgPT0gdGhpcy5jaGFuZ2VEZXB0TGlzdDFba10uZGljdFZhbHVlKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNoYW5nZURlcHRMaXN0MS5zcGxpY2UoaywxKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtLm91dHBhdGllbnRTZXJ2aWNlTGVmdD1KU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuY2hhbmdlRGVwdExpc3QxKSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZz1mYWxzZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuDQogICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZSBpZih0aGlzLm91dHBhdGllbnRSaWdodExlbmd0aD4xKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNoYW5nZURlcHRMaXN0PUpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocmVzcG9uc2UuZGF0YS5tYXAoaXRlPT57DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlLnJhdGlvPTANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlDQogICAgICAgICAgICAgICAgICAgICAgICB9KSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcihsZXQgaSBpbiB0aGlzLmZvcm0ub3V0cGF0aWVudFNlcnZpY2VSaWdodCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IobGV0IGsgaW4gdGhpcy5jaGFuZ2VEZXB0TGlzdCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih0aGlzLmZvcm0ub3V0cGF0aWVudFNlcnZpY2VSaWdodFtpXS5kaWN0VmFsdWUgPT0gdGhpcy5jaGFuZ2VEZXB0TGlzdFtrXS5kaWN0VmFsdWUpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhbmdlRGVwdExpc3Quc3BsaWNlKGssMSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZm9ybS5vdXRwYXRpZW50U2VydmljZUxlZnQ9SlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmNoYW5nZURlcHRMaXN0KSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZz1mYWxzZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuDQogICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZSBpZih0aGlzLm91dHBhdGllbnRSaWdodExlbmd0aD09MCYmdGhpcy5mb3JtLm91dHBhdGllbnRTZXJ2aWNlUmlnaHQubGVuZ3RoPT0wKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZvcm0ub3V0cGF0aWVudFNlcnZpY2VMZWZ0PUpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5kZXB0RGF0YXMpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZz1mYWxzZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybg0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmKGRhdGEuY2xpbmljVHlwZT09Mil7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNoYW5nZUhvc0RlcHRMaXN0PVtdDQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNoYW5nZUhvc0RlcHRMaXN0MT1bXQ0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5mb3JtLmhvc3BpdGFsU2VydmljZUxlZnQ9W10NCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGVwdERhdGFzSG9zPUpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocmVzcG9uc2UuZGF0YS5tYXAoaXRlPT57DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlLnJhdGlvPTANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlDQogICAgICAgICAgICAgICAgICAgICAgICB9KSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5ob3NwaXRhbFJpZ2h0TGVuZ3RoIT09MCB8fCB0aGlzLmZvcm0uaG9zcGl0YWxTZXJ2aWNlUmlnaHQubGVuZ3RoPT0xKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGFuZ2VIb3NEZXB0TGlzdDE9SlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShyZXNwb25zZS5kYXRhLm1hcChpdGU9PnsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGUucmF0aW89MA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGUNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBpIGluIHRoaXMuZm9ybS5ob3NwaXRhbFNlcnZpY2VSaWdodCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IobGV0IGsgaW4gdGhpcy5jaGFuZ2VIb3NEZXB0TGlzdDEpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5mb3JtLmhvc3BpdGFsU2VydmljZVJpZ2h0W2ldLmRpY3RWYWx1ZSA9PSB0aGlzLmNoYW5nZUhvc0RlcHRMaXN0MVtrXS5kaWN0VmFsdWUpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhbmdlSG9zRGVwdExpc3QxLnNwbGljZShrLDEpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtLmhvc3BpdGFsU2VydmljZUxlZnQ9SlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmNoYW5nZUhvc0RlcHRMaXN0MSkpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nMj1mYWxzZSAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2UgaWYodGhpcy5mb3JtLmhvc3BpdGFsU2VydmljZVJpZ2h0Lmxlbmd0aD4xKXsgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhbmdlSG9zRGVwdExpc3Q9SlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShyZXNwb25zZS5kYXRhLm1hcChpdGU9PnsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGUucmF0aW89MA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGUNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBpIGluIHRoaXMuZm9ybS5ob3NwaXRhbFNlcnZpY2VSaWdodCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IobGV0IGsgaW4gdGhpcy5jaGFuZ2VIb3NEZXB0TGlzdCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih0aGlzLmZvcm0uaG9zcGl0YWxTZXJ2aWNlUmlnaHRbaV0uZGljdFZhbHVlID09IHRoaXMuY2hhbmdlSG9zRGVwdExpc3Rba10uZGljdFZhbHVlKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNoYW5nZUhvc0RlcHRMaXN0LnNwbGljZShrLDEpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nMj1mYWxzZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZm9ybS5ob3NwaXRhbFNlcnZpY2VMZWZ0PUpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5jaGFuZ2VIb3NEZXB0TGlzdCkpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2UgaWYodGhpcy5ob3NwaXRhbFJpZ2h0TGVuZ3RoPT0wICYmIHRoaXMuZm9ybS5ob3NwaXRhbFNlcnZpY2VSaWdodC5sZW5ndGg9PTApew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZm9ybS5ob3NwaXRhbFNlcnZpY2VMZWZ0PUpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5kZXB0RGF0YXNIb3MpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZzI9ZmFsc2UNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubXNnRXJyb3IocmVzcG9uc2UubXNnKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgDQogICAgICAgIH0sDQogICAgICAgIGhvc3BpdGFsVG9yaWdodCgpew0KICAgICAgICAgICAgLy/lsIbov4fmu6TlkI7nmoTmlbDnu4TpnIDopoHmt7vliqDliLDlj7PovrnnmoTmlbDnu4TkuK0NCiAgICAgICAgICAgIGZvcihsZXQgaSA9IDA7aTx0aGlzLnNlbGVjdGlvblJvd2hvc3BpdGFsTGVmdC5sZW5ndGg7aSsrKXsNCiAgICAgICAgICAgICAgICAgdGhpcy5mb3JtLmhvc3BpdGFsU2VydmljZVJpZ2h0LmluZGV4T2YodGhpcy5zZWxlY3Rpb25Sb3dob3NwaXRhbExlZnRbaV0pID09PSAtMSA/ICB0aGlzLmZvcm0uaG9zcGl0YWxTZXJ2aWNlUmlnaHQucHVzaCh0aGlzLnNlbGVjdGlvblJvd2hvc3BpdGFsTGVmdFtpXSkgOiAgdGhpcy5mb3JtLmhvc3BpdGFsU2VydmljZVJpZ2h0DQogICAgICAgICAgICB9OyAgICAgICAgDQogICAgICAgICAgICAvL+WJqeS9meW3pui+ueaVsOaNrg0KICAgICAgICAgICAgZm9yKGxldCBpPTA7aTx0aGlzLmZvcm0uaG9zcGl0YWxTZXJ2aWNlTGVmdC5sZW5ndGg7aSsrKXsNCiAgICAgICAgICAgICAgICAgdGhpcy5mb3JtLmhvc3BpdGFsU2VydmljZVJpZ2h0LmZvckVhY2goaXRlPT57DQogICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuZm9ybS5ob3NwaXRhbFNlcnZpY2VMZWZ0W2ldJiZ0aGlzLmZvcm0uaG9zcGl0YWxTZXJ2aWNlTGVmdFtpXS5kaWN0VmFsdWU9PWl0ZS5kaWN0VmFsdWUpeyAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZm9ybS5ob3NwaXRhbFNlcnZpY2VMZWZ0LnNwbGljZShpLDEpDQogICAgICAgICAgICAgICAgICAgICAgICAgIGktPTENCiAgICAgICAgICAgICAgICAgICAgICAgICAgaTwwPzA6aQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgaG9zcGl0YWxUb0xlZnQoKXsNCiAgICAgICAgICAgIGZvcihsZXQgaSA9IDA7aTx0aGlzLnNlbGVjdGlvblJvd2hvc3BpdGFsUmlnaHQubGVuZ3RoO2krKyl7DQogICAgICAgICAgICAgICAgdGhpcy5mb3JtLmhvc3BpdGFsU2VydmljZUxlZnQuaW5kZXhPZih0aGlzLnNlbGVjdGlvblJvd2hvc3BpdGFsUmlnaHRbaV0pID09PSAtMSA/ICB0aGlzLmZvcm0uaG9zcGl0YWxTZXJ2aWNlTGVmdC5wdXNoKHRoaXMuc2VsZWN0aW9uUm93aG9zcGl0YWxSaWdodFtpXSkgOiAgdGhpcy5mb3JtLmhvc3BpdGFsU2VydmljZUxlZnQNCiAgICAgICAgICAgIH07DQogICAgICAgICAgICAvL+WJqeS9meWPs+i+ueaVsOaNrg0KICAgICAgICAgICAgZm9yKGxldCBpPTA7aTx0aGlzLmZvcm0uaG9zcGl0YWxTZXJ2aWNlUmlnaHQubGVuZ3RoO2krKyl7DQogICAgICAgICAgICAgICAgIHRoaXMuZm9ybS5ob3NwaXRhbFNlcnZpY2VMZWZ0LmZvckVhY2goaXRlPT57DQogICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuZm9ybS5ob3NwaXRhbFNlcnZpY2VSaWdodFtpXSYmdGhpcy5mb3JtLmhvc3BpdGFsU2VydmljZVJpZ2h0W2ldLmRpY3RWYWx1ZT09aXRlLmRpY3RWYWx1ZSl7ICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtLmhvc3BpdGFsU2VydmljZVJpZ2h0LnNwbGljZShpLDEpDQogICAgICAgICAgICAgICAgICAgICAgICAgIGktPTENCiAgICAgICAgICAgICAgICAgICAgICAgICAgaTwwPzA6aQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgb3V0cGF0aWVudFRvcmlnaHQoKXsNCiAgICAgICAgICAvL+Wwhui/h+a7pOWQjueahOaVsOe7hOmcgOimgea3u+WKoOWIsOWPs+i+ueeahOaVsOe7hOS4rQ0KICAgICAgICAgICAgZm9yKGxldCBpID0gMDtpPHRoaXMuc2VsZWN0aW9uUm93b3V0cGF0aWVudExlZnQubGVuZ3RoO2krKyl7DQogICAgICAgICAgICAgICAgIHRoaXMuZm9ybS5vdXRwYXRpZW50U2VydmljZVJpZ2h0LmluZGV4T2YodGhpcy5zZWxlY3Rpb25Sb3dvdXRwYXRpZW50TGVmdFtpXSkgPT09IC0xID8gIHRoaXMuZm9ybS5vdXRwYXRpZW50U2VydmljZVJpZ2h0LnB1c2godGhpcy5zZWxlY3Rpb25Sb3dvdXRwYXRpZW50TGVmdFtpXSkgOiAgdGhpcy5mb3JtLm91dHBhdGllbnRTZXJ2aWNlUmlnaHQNCiAgICAgICAgICAgIH07ICAgIA0KICAgICAgICAgICAgLy/liankvZnlt6bovrnmlbDmja4NCiAgICAgICAgICAgIGZvcihsZXQgaT0wO2k8dGhpcy5mb3JtLm91dHBhdGllbnRTZXJ2aWNlTGVmdC5sZW5ndGg7aSsrKXsNCiAgICAgICAgICAgICAgICAgdGhpcy5mb3JtLm91dHBhdGllbnRTZXJ2aWNlUmlnaHQuZm9yRWFjaChpdGU9PnsNCiAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5mb3JtLm91dHBhdGllbnRTZXJ2aWNlTGVmdFtpXSYmdGhpcy5mb3JtLm91dHBhdGllbnRTZXJ2aWNlTGVmdFtpXS5kaWN0VmFsdWU9PWl0ZS5kaWN0VmFsdWUpew0KICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZvcm0ub3V0cGF0aWVudFNlcnZpY2VMZWZ0LnNwbGljZShpLDEpDQogICAgICAgICAgICAgICAgICAgICAgICAgIGktPTENCiAgICAgICAgICAgICAgICAgICAgICAgICAgaTwwPzA6aQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIH0NCgkJfSwNCiAgICAgICAgLy/lsIblj7PovrnmlbDmja7mlL7liLDlt6bovrkNCiAgICAgICAgb3V0cGF0aWVudFRvbGVmdCgpew0KICAgICAgICAgICAgZm9yKGxldCBpID0gMDtpPHRoaXMuc2VsZWN0aW9uUm93T3V0cGF0aWVudFJpZ2h0Lmxlbmd0aDtpKyspew0KICAgICAgICAgICAgICAgICB0aGlzLmZvcm0ub3V0cGF0aWVudFNlcnZpY2VMZWZ0LmluZGV4T2YodGhpcy5zZWxlY3Rpb25Sb3dPdXRwYXRpZW50UmlnaHRbaV0pID09PSAtMSA/ICB0aGlzLmZvcm0ub3V0cGF0aWVudFNlcnZpY2VMZWZ0LnB1c2godGhpcy5zZWxlY3Rpb25Sb3dPdXRwYXRpZW50UmlnaHRbaV0pIDogIHRoaXMuZm9ybS5vdXRwYXRpZW50U2VydmljZUxlZnQNCiAgICAgICAgICAgIH07DQogICAgICAgICAgICAvL+WJqeS9meWPs+i+ueaVsOaNrg0KICAgICAgICAgICAgZm9yKGxldCBpPTA7aTx0aGlzLmZvcm0ub3V0cGF0aWVudFNlcnZpY2VSaWdodC5sZW5ndGg7aSsrKXsNCiAgICAgICAgICAgICAgICAgdGhpcy5mb3JtLm91dHBhdGllbnRTZXJ2aWNlTGVmdC5mb3JFYWNoKGl0ZT0+ew0KICAgICAgICAgICAgICAgICAgICBpZih0aGlzLmZvcm0ub3V0cGF0aWVudFNlcnZpY2VSaWdodFtpXSYmdGhpcy5mb3JtLm91dHBhdGllbnRTZXJ2aWNlUmlnaHRbaV0uZGljdFZhbHVlPT1pdGUuZGljdFZhbHVlKXsgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtLm91dHBhdGllbnRTZXJ2aWNlUmlnaHQuc3BsaWNlKGksMSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaS09MQ0KICAgICAgICAgICAgICAgICAgICAgICAgICBpPDA/aT0wOmkNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIC8vIOmXqOiviuWkmumAieahhumAieS4reaVsOaNrg0KICAgICAgICBoYW5kbGVTZWxlY3Rpb25PdXRwYXRpZW50Q2hhbmdlKHNlbGVjdGlvbikgew0KICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25Sb3dvdXRwYXRpZW50TGVmdD1zZWxlY3Rpb24ubWFwKGl0ZT0+ew0KICAgICAgICAgICAgICAgIGl0ZS5yYXRpbz0wDQogICAgICAgICAgICAgICAgcmV0dXJuIGl0ZQ0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICBpZihzZWxlY3Rpb24ubGVuZ3RoIT09MCl7DQogICAgICAgICAgICAgICAgdGhpcy5wYXRUb1JpZ2h0Qm9vbD1mYWxzZTsNCiAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgIHRoaXMucGF0VG9SaWdodEJvb2w9dHJ1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgLy/pl6jor4rlj7PkvqflpJrpgInmoYbmlbDmja4NCiAgICAgICAgaGFuZGxlU2VsZWN0aW9uQ2hhbmdlUmlnaHQoc2VsZWN0aW9uKXsNCiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uUm93T3V0cGF0aWVudFJpZ2h0PXNlbGVjdGlvbjsNCiAgICAgICAgICAgIGlmKHNlbGVjdGlvbi5sZW5ndGghPT0wKXsNCiAgICAgICAgICAgICAgICB0aGlzLnBhdFRvTGVmdEJvb2w9ZmFsc2U7DQogICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICB0aGlzLnBhdFRvTGVmdEJvb2w9dHJ1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgLy/kvY/pmaLlt6bkvqflpJrpgInmoYYNCiAgICAgICAgaGFuZGxlU2VsZWN0aW9uSG9zcGl0YWxDaGFuZ2Uoc2VsZWN0aW9uKXsNCiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uUm93aG9zcGl0YWxMZWZ0PXNlbGVjdGlvbi5tYXAoaXRlPT57DQogICAgICAgICAgICAgICAgaXRlLnJhdGlvPTANCiAgICAgICAgICAgICAgICByZXR1cm4gaXRlDQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIGlmKHNlbGVjdGlvbi5sZW5ndGghPT0wKXsNCiAgICAgICAgICAgICAgICB0aGlzLmhvc1RvUmlnaHRCb29sPWZhbHNlOw0KICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgdGhpcy5ob3NUb1JpZ2h0Qm9vbD10cnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICAvL+S9j+mZouWPs+S+p+WkmumAieahhg0KICAgICAgICBoYW5kbGVTZWxlY3Rpb25Ib3NwaXRhbENoYW5nZVJpZ2h0KHNlbGVjdGlvbil7DQogICAgICAgICAgICB0aGlzLnNlbGVjdGlvblJvd2hvc3BpdGFsUmlnaHQ9c2VsZWN0aW9uOw0KICAgICAgICAgICAgaWYoc2VsZWN0aW9uLmxlbmd0aCE9PTApew0KICAgICAgICAgICAgICAgIHRoaXMuaG9zVG9MZWZ0Qm9vbD1mYWxzZTsNCiAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgdGhpcy5ob3NUb0xlZnRCb29sPXRydWU7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIHJvd0NsaWNrKHJvdywgY29sdW1uLCBldmVudCkgew0KICAgICAgICAgICAgbGV0IHJlZnNFbFRhYmxlID0gdGhpcy4kcmVmcy5tdWx0aXBsZVRhYmxlOw0KICAgICAgICAgICAgbGV0IGZpbmRSb3cgPSB0aGlzLnNlbGVjdGlvblJvd291dHBhdGllbnRMZWZ0LmZpbmQoYyA9PiBjLnJvd0luZGV4ID09IHJvdy5yb3dJbmRleCk7DQogICAgICAgICAgICBpZiAoZmluZFJvdyAmJiB0aGlzLnNlbGVjdGlvblJvd291dHBhdGllbnRMZWZ0Lmxlbmd0aCA9PSAxKSB7DQogICAgICAgICAgICAgICAgcmVmc0VsVGFibGUudG9nZ2xlUm93U2VsZWN0aW9uKHJvdywgZmFsc2UpOw0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJlZnNFbFRhYmxlLmNsZWFyU2VsZWN0aW9uKCk7DQogICAgICAgICAgICByZWZzRWxUYWJsZS50b2dnbGVSb3dTZWxlY3Rpb24ocm93KTsNCiAgICAgICAgfSwNCiAgICAgICAgcm93Q2xpY2tQYXRSaWdodChyb3csIGNvbHVtbiwgZXZlbnQpew0KICAgICAgICAgICAgbGV0IHJlZnNFbFRhYmxlID0gdGhpcy4kcmVmcy5tdWx0aXBsZVRhYmxlUmlnaHQ7DQogICAgICAgICAgICBsZXQgZmluZFJvdyA9IHRoaXMuc2VsZWN0aW9uUm93T3V0cGF0aWVudFJpZ2h0LmZpbmQoYyA9PiBjLnJvd0luZGV4ID09IHJvdy5yb3dJbmRleCk7DQogICAgICAgICAgICBpZiAoZmluZFJvdyAmJiB0aGlzLnNlbGVjdGlvblJvd091dHBhdGllbnRSaWdodC5sZW5ndGggPT0gMSkgew0KICAgICAgICAgICAgICAgIHJlZnNFbFRhYmxlLnRvZ2dsZVJvd1NlbGVjdGlvbihyb3csIGZhbHNlKTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZWZzRWxUYWJsZS5jbGVhclNlbGVjdGlvbigpOw0KICAgICAgICAgICAgcmVmc0VsVGFibGUudG9nZ2xlUm93U2VsZWN0aW9uKHJvdyk7DQogICAgICAgIH0sDQogICAgICAgIHJvd0NsaWNrSG9zKHJvdywgY29sdW1uLCBldmVudCl7DQogICAgICAgICAgICBsZXQgcmVmc0VsVGFibGUgPSB0aGlzLiRyZWZzLm11bHRpcGxlVGFibGVIb3M7DQogICAgICAgICAgICBsZXQgZmluZFJvdyA9IHRoaXMuc2VsZWN0aW9uUm93aG9zcGl0YWxMZWZ0LmZpbmQoYyA9PiBjLnJvd0luZGV4ID09IHJvdy5yb3dJbmRleCk7DQogICAgICAgICAgICBpZiAoZmluZFJvdyAmJiB0aGlzLnNlbGVjdGlvblJvd2hvc3BpdGFsTGVmdC5sZW5ndGggPT0gMSkgew0KICAgICAgICAgICAgICAgIHJlZnNFbFRhYmxlLnRvZ2dsZVJvd1NlbGVjdGlvbihyb3csIGZhbHNlKTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZWZzRWxUYWJsZS5jbGVhclNlbGVjdGlvbigpOw0KICAgICAgICAgICAgcmVmc0VsVGFibGUudG9nZ2xlUm93U2VsZWN0aW9uKHJvdyk7DQogICAgICAgIH0sDQogICAgICAgIHJvd0NsaWNrSG9zUmlnaHQocm93LCBjb2x1bW4sIGV2ZW50KXsNCiAgICAgICAgICAgIGxldCByZWZzRWxUYWJsZSA9IHRoaXMuJHJlZnMubXVsdGlwbGVUYWJsZVJpZ2h0SG9zOw0KICAgICAgICAgICAgbGV0IGZpbmRSb3cgPSB0aGlzLnNlbGVjdGlvblJvd2hvc3BpdGFsUmlnaHQuZmluZChjID0+IGMucm93SW5kZXggPT0gcm93LnJvd0luZGV4KTsNCiAgICAgICAgICAgIGlmIChmaW5kUm93ICYmIHRoaXMuc2VsZWN0aW9uUm93aG9zcGl0YWxSaWdodC5sZW5ndGggPT0gMSkgew0KICAgICAgICAgICAgICAgIHJlZnNFbFRhYmxlLnRvZ2dsZVJvd1NlbGVjdGlvbihyb3csIGZhbHNlKTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZWZzRWxUYWJsZS5jbGVhclNlbGVjdGlvbigpOw0KICAgICAgICAgICAgcmVmc0VsVGFibGUudG9nZ2xlUm93U2VsZWN0aW9uKHJvdyk7DQogICAgICAgIH0sDQogICAgICAgIHJlc2V0KCl7DQogICAgICAgICAgICB0aGlzLmZvcm09ew0KICAgICAgICAgICAgICAgIG91dHBhdGllbnRTZXJ2aWNlTGVmdDpbXSwvL+mXqOiviuW3puS+p+aVsOaNrg0KICAgICAgICAgICAgICAgIG91dHBhdGllbnRTZXJ2aWNlUmlnaHQ6W10sLy/pl6jor4rlj7PkvqfmlbDmja4NCiAgICAgICAgICAgICAgICBob3NwaXRhbFNlcnZpY2VMZWZ0OltdLC8v5L2P6Zmi5bem5L6n5pWw5o2uDQogICAgICAgICAgICAgICAgaG9zcGl0YWxTZXJ2aWNlUmlnaHQ6W10sLy/kvY/pmaLlj7PkvqfmlbDmja4NCiAgICAgICAgICAgIH07DQogICAgICAgICAgICB0aGlzLmNsaWNrQ291bnQ9MA0KICAgICAgICB9LA0KICAgICAgICAvKiog56eR5a6k5o+Q5Lqk5oyJ6ZKuICovDQogICAgICAgIHN1Ym1pdEZvcm1EZXB0KCkgew0KICAgICAgICAgICAgdGhpcy4kcmVmc1sicXVlcnlGb3JtIl0udmFsaWRhdGUodmFsaWQgPT4gew0KICAgICAgICAgICAgICAgIGlmICh2YWxpZCkgew0KICAgICAgICAgICAgICAgIGxldCBwYXJhbXMsYXJyPVtdLGFycjE9W10sc3VtPTAsc3VtMT0wOw0KICAgICAgICAgICAgICAgICAgICBpZih0aGlzLmZvcm0ub3V0cGF0aWVudFNlcnZpY2VSaWdodC5sZW5ndGg9PTAgJiYgdGhpcy5mb3JtLmhvc3BpdGFsU2VydmljZVJpZ2h0PT0wKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcz17DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV2ZW51ZUNvZGU6dGhpcy5xdWVyeVBhcmFtcy5yZXZlbnVlQ29kZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbXNSZXZlbnVlRGVwdHM6W10sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcENvZGU6dGhpcy5xdWVyeVBhcmFtcy5jb21wQ29kZSwNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzYXZlTG9hZGluZyA9IHRoaXMuc2F2ZUxvYWRpbmcoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGREZXB0TGlzdChwYXJhbXMpLnRoZW4ocmVzcG9uc2UgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1zZ1N1Y2Nlc3MoIuaUtuWFpeaguOeul+enkeWupOiuvue9ruaIkOWKnyIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCJzdWNjZXNzIiwgZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYXZlTG9hZGluZy5jbG9zZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5mb3JtLm91dHBhdGllbnRTZXJ2aWNlUmlnaHQubGVuZ3RoPT0wICYmIHRoaXMuZm9ybS5ob3NwaXRhbFNlcnZpY2VSaWdodCE9MCl7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZvcm0uaG9zcGl0YWxTZXJ2aWNlUmlnaHQuZm9yRWFjaChpdGU9PnsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdW0xKz1OdW1iZXIoaXRlLnJhdGlvKSAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFycjEucHVzaCh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlcHROYW1lOml0ZS5kaWN0TGFiZWwsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlcHRDb2RlOml0ZS5kaWN0VmFsdWUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhdGlvOml0ZS5yYXRpbw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zPXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXZlbnVlQ29kZTp0aGlzLnF1ZXJ5UGFyYW1zLnJldmVudWVDb2RlLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBtc1JldmVudWVEZXB0czphcnIxLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBDb2RlOnRoaXMucXVlcnlQYXJhbXMuY29tcENvZGUsDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZihzdW0xPjEwMCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tc2dFcnJvcigi5L2P6Zmi5bey6YCJ56eR5a6k5YiG5pGK5q+U5L6L55qE5oC75ZKM5bqU5bCP5LqO5oiW562J5LqOMTAwIikNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4NCiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzYXZlTG9hZGluZyA9IHRoaXMuc2F2ZUxvYWRpbmcoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGREZXB0TGlzdChwYXJhbXMpLnRoZW4ocmVzcG9uc2UgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1zZ1N1Y2Nlc3MoIuaUtuWFpeaguOeul+enkeWupOiuvue9ruaIkOWKnyIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCJzdWNjZXNzIiwgZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYXZlTG9hZGluZy5jbG9zZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuZm9ybS5vdXRwYXRpZW50U2VydmljZVJpZ2h0Lmxlbmd0aCE9MCAmJiB0aGlzLmZvcm0uaG9zcGl0YWxTZXJ2aWNlUmlnaHQ9PTApew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtLm91dHBhdGllbnRTZXJ2aWNlUmlnaHQuZm9yRWFjaChpdGU9PnsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdW0rPU51bWJlcihpdGUucmF0aW8pDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJyLnB1c2goew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXB0TmFtZTppdGUuZGljdExhYmVsLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXB0Q29kZTppdGUuZGljdFZhbHVlLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYXRpbzppdGUucmF0aW8NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcz17DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV2ZW51ZUNvZGU6dGhpcy5xdWVyeVBhcmFtcy5yZXZlbnVlQ29kZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbXNSZXZlbnVlRGVwdHM6YXJyLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBDb2RlOnRoaXMucXVlcnlQYXJhbXMuY29tcENvZGUsDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZihzdW0+MTAwKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1zZ0Vycm9yKCLpl6jor4rlt7LpgInnp5HlrqTliIbmkYrmr5TkvovnmoTmgLvlkozlupTlsI/kuo7miJbnrYnkuo4xMDAiKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybg0KICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNhdmVMb2FkaW5nID0gdGhpcy5zYXZlTG9hZGluZygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZERlcHRMaXN0KHBhcmFtcykudGhlbihyZXNwb25zZSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubXNnU3VjY2Vzcygi5pS25YWl5qC4566X56eR5a6k6K6+572u5oiQ5YqfIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoInN1Y2Nlc3MiLCBmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhdmVMb2FkaW5nLmNsb3NlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5mb3JtLm91dHBhdGllbnRTZXJ2aWNlUmlnaHQubGVuZ3RoIT0wICYmIHRoaXMuZm9ybS5ob3NwaXRhbFNlcnZpY2VSaWdodC5sZW5ndGghPTApew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtLm91dHBhdGllbnRTZXJ2aWNlUmlnaHQuZm9yRWFjaChpdGU9PnsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdW0rPU51bWJlcihpdGUucmF0aW8pDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJyLnB1c2goew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXB0TmFtZTppdGUuZGljdExhYmVsLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXB0Q29kZTppdGUuZGljdFZhbHVlLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYXRpbzppdGUucmF0aW8NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZm9ybS5ob3NwaXRhbFNlcnZpY2VSaWdodC5mb3JFYWNoKGl0ZT0+ew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1bTErPU51bWJlcihpdGUucmF0aW8pICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJyMS5wdXNoKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVwdE5hbWU6aXRlLmRpY3RMYWJlbCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVwdENvZGU6aXRlLmRpY3RWYWx1ZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmF0aW86aXRlLnJhdGlvDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXM9ew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldmVudWVDb2RlOnRoaXMucXVlcnlQYXJhbXMucmV2ZW51ZUNvZGUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcG1zUmV2ZW51ZURlcHRzOlsuLi5hcnIxLC4uLmFycl0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcENvZGU6dGhpcy5xdWVyeVBhcmFtcy5jb21wQ29kZSwNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHN1bT4xMDB8fHN1bTE+MTAwKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1zZ0Vycm9yKCLpl6jor4rlj4rkvY/pmaLlt7LpgInnp5HlrqTliIbmkYrmr5TkvovnmoTmgLvlkozlupTliIbliKvlsI/kuo7miJbnrYnkuo4xMDAiKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybg0KICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNhdmVMb2FkaW5nID0gdGhpcy5zYXZlTG9hZGluZygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZERlcHRMaXN0KHBhcmFtcykudGhlbihyZXNwb25zZSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubXNnU3VjY2Vzcygi5pS25YWl5qC4566X56eR5a6k6K6+572u5oiQ5YqfIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoInN1Y2Nlc3MiLCBmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhdmVMb2FkaW5nLmNsb3NlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0sDQogICAgICAvLyDlvLnmoYblhbPpl60NCiAgICAgICAgaGFuZGxlRGlhbG9nQ2xvc2UoKSB7DQogICAgICAgICAgICB0aGlzLiRlbWl0KCJjYW5jZWwiLCBmYWxzZSk7DQogICAgICAgICAgICB0aGlzLnJlc2V0KCkNCiAgICAgICAgfSwNCiAgICAgICAgLy8g5Y+W5raIDQogICAgICAgIGNhbmNlbCgpIHsNCiAgICAgICAgICAgIHRoaXMuJGVtaXQoImNhbmNlbCIsIGZhbHNlKTsNCiAgICAgICAgICAgIHRoaXMucmVzZXQoKQ0KICAgICAgICB9LA0KICAgIH0sDQp9Ow0K"},{"version":3,"sources":["revenueDept.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiJA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"revenueDept.vue","sourceRoot":"src/views/revenue/revenue","sourcesContent":["<template>\r\n    <!-- 科室设置 -->\r\n  <el-dialog custom-class=\"el-button--primary\" :title=\"title\" :close-on-click-modal=\"false\" @close=\"handleDialogClose\" :visible.sync=\"openDialog\" width=\"50%\" append-to-body>\r\n      <el-form ref=\"queryForm\" :model=\"queryParams\" :rules=\"rules\" label-width=\"80px\">\r\n        <el-row :gutter=\"24\">\r\n          <el-col :span=\"10\">\r\n            <el-form-item label=\"项目编码\" prop=\"revenueCode\">\r\n              <el-input v-model=\"queryParams.revenueCode\" placeholder=\"系统自动生成\"  maxlength=\"50\" show-word-limit disabled />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"10\">\r\n            <el-form-item label=\"项目名称\" prop=\"revenueName\">\r\n              <el-input v-model=\"queryParams.revenueName\" placeholder=\"请输入项目名称\"  maxlength=\"100\" show-word-limit disabled />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"24\">\r\n            <el-tabs v-model=\"activeName\"  @tab-click=\"handleClick\" >\r\n                <el-tab-pane label=\"门诊\" name=\"outPatient\">\r\n                    <el-col :span=\"24\">\r\n                        <div class=\"hello\">\r\n                            <div class=\"transfer\">\r\n                                <div class=\"transfer_left\">\r\n                                    <div class=\"transfer_left_top\">\r\n                                        <p>\r\n                                            <label for=\"\">待选科室</label>\r\n                                            <span>{{num(selectionRowoutpatientLeft)}}/{{form.outpatientServiceLeft.length}}</span>\r\n                                        </p>\r\n                                        <el-select v-model=\"queryParams.deptCode1\" @change=\"changeDept\" @click=\"changeDept\" clearable automatic-dropdown=\"\" :filterable=\"true\" :remote=\"true\" placeholder=\"请选择科室\" size=\"small\">\r\n                                            <el-option\r\n                                            v-for=\"item in deptDatas\"\r\n                                            :key=\"item.dictValue\"\r\n                                            :label=\"item.dictLabel\"\r\n                                            :value=\"item.dictLabel\"\r\n                                            ></el-option>\r\n                                        </el-select>\r\n                                    </div>\r\n                                    <div class=\"checkbox_left\">\r\n                                        <el-form  ref=\"outPatientLeft\" :model=\"form\">\r\n                                            <el-table ref=\"multipleTable\" height=\"410\" :style=\"{width: '100%'}\" :show-overflow-tooltip=\"true\" tooltip-effect=\"dark\" stripe v-loading=\"loading\" :data=\"form.outpatientServiceLeft\" @selection-change=\"handleSelectionOutpatientChange\" @row-click=\"rowClick\">\r\n                                                <el-table-column type=\"selection\" width=\"55\" align=\"center\" fixed />\r\n                                                <el-table-column label=\"科室名称\" align=\"center\" prop=\"dictLabel\" />\r\n                                            </el-table>\r\n                                        </el-form>\r\n                                    </div>\r\n                                </div>\r\n                                <div class=\"transfer_main\">\r\n                                    <el-button-group>\r\n                                        <el-button type=\"primary\" size=\"small\" icon=\"el-icon-arrow-right\" @click=\"outpatientToright\" :disabled=\"patToRightBool\"></el-button>\r\n                                        <el-button type=\"primary\"  size=\"small\" @click=\"outpatientToleft\" icon=\"el-icon-arrow-left\" :disabled=\"patToLeftBool\"></el-button>\r\n                                    </el-button-group>\r\n                                </div>\r\n                                <div class=\"transfer_right\">\r\n                                    <div class=\"transfer_right_top\">\r\n                                        <p>\r\n                                            <label for=\"\">已选科室</label> \r\n                                            <span>{{num1(selectionRowOutpatientRight)}}/{{form.outpatientServiceRight.length}}</span>\r\n                                        </p>                        \r\n                                    </div>\r\n                                    <div class=\"checkbox_left\">\r\n                                        <el-form  ref=\"outPatientRight\" :model=\"form\">\r\n                                            <el-table ref=\"multipleTableRight\" v-loading=\"loading1\" :style=\"{width: '100%'}\" height=\"450\" tooltip-effect=\"dark\" stripe :data=\"form.outpatientServiceRight\" @selection-change=\"handleSelectionChangeRight\" @row-click=\"rowClickPatRight\">\r\n                                                <el-table-column type=\"selection\" width=\"55\" align=\"center\" fixed />\r\n                                                <el-table-column label=\"科室名称\" align=\"center\" prop=\"dictLabel\" />\r\n                                                <el-table-column label=\"分摊比例\" align=\"center\" prop=\"ratio\">\r\n                                                    <template slot-scope=\"scope\">\r\n                                                        <el-input-number v-model=\"scope.row.ratio\" :min=\"0\" :max=\"100\" :precision=\"2\" />\r\n                                                    </template>\r\n                                                </el-table-column>\r\n                                            </el-table>\r\n                                        </el-form>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </el-col>\r\n                </el-tab-pane>\r\n                <!-- 住院 -->\r\n                <el-tab-pane label=\"住院\" name=\"hospital\">\r\n                    <el-col :span=\"24\">\r\n                        <div class=\"hello\">\r\n                            <div class=\"transfer\">\r\n                                <div class=\"transfer_left\">\r\n                                    <div class=\"transfer_left_top\">\r\n                                        <p>\r\n                                            <label for=\"\">待选科室</label>\r\n                                            <span>{{num2(selectionRowhospitalLeft)}}/{{form.hospitalServiceLeft.length}}</span>\r\n                                        </p>\r\n                                        <el-select v-model=\"queryParams.deptCode2\" @change=\"changeDept\" clearable automatic-dropdown=\"\" :filterable=\"true\" :remote=\"true\" placeholder=\"请选择科室\" size=\"small\">\r\n                                            <el-option\r\n                                            v-for=\"item in deptDatasHos\"\r\n                                            :key=\"item.dictValue\"\r\n                                            :label=\"item.dictLabel\"\r\n                                            :value=\"item.dictLabel\"\r\n                                            ></el-option>\r\n                                        </el-select>\r\n                                    </div>\r\n                                    <div class=\"checkbox_left\">\r\n                                        <el-table ref=\"multipleTableHos\" height=\"410\" :style=\"{width: '100%'}\" :show-overflow-tooltip=\"true\" tooltip-effect=\"dark\" stripe v-loading=\"loading2\" :data=\"form.hospitalServiceLeft\"  @selection-change=\"handleSelectionHospitalChange\" @row-click=\"rowClickHos\">\r\n                                            <el-table-column type=\"selection\" width=\"55\" align=\"center\" fixed />\r\n                                            <el-table-column label=\"科室名称\" align=\"center\" prop=\"dictLabel\" />\r\n                                        </el-table>\r\n                                    </div>\r\n                                </div>\r\n                                <div class=\"transfer_main\">\r\n                                    <el-button-group>\r\n                                        <el-button type=\"primary\" size=\"small\" icon=\"el-icon-arrow-right\" @click=\"hospitalToright\" :disabled=\"hosToRightBool\"></el-button>\r\n                                        <el-button type=\"primary\"  size=\"small\" @click=\"hospitalToLeft\" icon=\"el-icon-arrow-left\" :disabled=\"hosToLeftBool\"></el-button>\r\n                                    </el-button-group>\r\n                                </div>\r\n                                <div class=\"transfer_right\">\r\n                                    <div class=\"transfer_right_top\">\r\n                                        <p>\r\n                                            <label for=\"\">已选科室</label> \r\n                                            <span>{{num3(selectionRowhospitalRight)}}/{{form.hospitalServiceRight.length}}</span>\r\n                                        </p>                        \r\n                                    </div>\r\n                                    <div class=\"checkbox_left\">\r\n                                        <el-table v-loading=\"loading3\" ref=\"multipleTableRightHos\" :style=\"{width: '100%'}\" height=\"450\" tooltip-effect=\"dark\" stripe :data=\"form.hospitalServiceRight\" @selection-change=\"handleSelectionHospitalChangeRight\" @row-click=\"rowClickHosRight\">\r\n                                            <el-table-column type=\"selection\" width=\"55\" align=\"center\" fixed />\r\n                                            <el-table-column label=\"科室名称\" align=\"center\" prop=\"dictLabel\" />\r\n                                            <el-table-column label=\"分摊比例\" align=\"center\" prop=\"ratio\">\r\n                                                <template slot-scope=\"scope\">\r\n                                                    <el-input-number v-model=\"scope.row.ratio\" :min=\"0\" :max=\"100\" :precision=\"2\" />\r\n                                                </template>\r\n                                            </el-table-column>\r\n                                        </el-table>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </el-col>\r\n                </el-tab-pane>\r\n            </el-tabs>\r\n          </el-col>                \r\n        </el-row>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button type=\"primary\" @click=\"submitFormDept()\" >保 存</el-button>\r\n        <el-button @click=\"cancel\">取 消</el-button>\r\n      </div>\r\n    </el-dialog>\r\n</template>\r\n\r\n<script>\r\n\r\nimport { getRevenueDept,getDeptList,addDeptList } from \"@/api/revenue/revenue\";\r\n\r\n\r\nexport default {\r\n    name: 'revenueDept',\r\n    props:{\r\n        // 传参为form表单 方便数据回显渲染\r\n        queryParams: {\r\n            type: [Object, Array]\r\n        },\r\n        open: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        id: {\r\n            type: [String, Number],\r\n            default: \"\"\r\n        },\r\n    },\r\n    watch:{\r\n         open: {\r\n            handler(val) {\r\n                this.openDialog = val;\r\n            },\r\n            deep: true\r\n        }\r\n    },\r\n    data() {\r\n        return {\r\n            title:'收入核算方案-第三方科室',        \r\n            openDialog: this.open,  \r\n            loading:false,\r\n            loading1:false,\r\n            loading2:false,\r\n            loading3:false,\r\n            clickCount:0,\r\n            activeName: \"outPatient\", \r\n            patToRightBool:true,\r\n            patToLeftBool:true,\r\n            hosToRightBool:true,\r\n            hosToLeftBool:true,\r\n            form:{\r\n                outpatientServiceLeft:[],//门诊左侧数据\r\n                outpatientServiceRight:[],//门诊右侧数据\r\n                hospitalServiceLeft:[],//住院左侧数据\r\n                hospitalServiceRight:[],//住院右侧数据\r\n            },        \r\n            rules:{},\r\n            deptDatas:[],//门诊科室列表数据\r\n            deptDatasLength:0,//门诊科室列表数据用于比较全选数据\r\n            changeDeptList1:[],\r\n            changeDeptList:[],\r\n            deptDatasHos:[],//门诊科室列表数据\r\n            changeHosDeptList:[],\r\n            changeHosDeptList1:[],\r\n            outpatientRightLength:[],\r\n            hospitalRightLength:[],\r\n            selectionRowoutpatientLeft:[],//门诊左侧复选框数据\r\n            selectionRowOutpatientRight:[],//门诊右侧复选框数据\r\n            selectionRowhospitalLeft:[],//住院左侧复选框数据\r\n            selectionRowhospitalRight:[],//住院右侧复选框数据\r\n        };\r\n    },\r\n    computed:{\r\n        num(){//计算属性传递参数，根据传入的数组返回符合条件的长度\r\n\t\t  return data =>  this.form.outpatientServiceLeft&&this.selectionRowoutpatientLeft.length\r\n        },\r\n        num1(){//计算属性传递参数，根据传入的数组返回符合条件的长度\r\n            return data =>  this.form.hospitalServiceLeft&&this.selectionRowOutpatientRight.length\r\n        },\r\n        num2(){//计算属性传递参数，根据传入的数组返回符合条件的长度\r\n            return data =>  this.form.hospitalServiceLeft&&this.selectionRowhospitalLeft.length\r\n        },\r\n        num3(){//计算属性传递参数，根据传入的数组返回符合条件的长度\r\n            return data =>  this.form.hospitalServiceLeft&&this.selectionRowhospitalRight.length\r\n        }\r\n    },\r\n    created(){\r\n         this.getDetail(1)        \r\n         this.getTreeDept({ compCode: this.$store.state.user.accountInfo.deptId ,clinicType:1})\r\n    },\r\n    mounted() {\r\n    },\r\n    methods: {\r\n        //科室查询下拉框事件\r\n        changeDept(e){\r\n            if(this.activeName=='outPatient'){\r\n                let data\r\n                if(e){\r\n                    data = { compCode: this.$store.state.user.accountInfo.deptId ,clinicType:1,deptName:e};\r\n                }else{\r\n                    data = { compCode: this.$store.state.user.accountInfo.deptId ,clinicType:1};      \r\n                }\r\n                this.getTreeDept(data)\r\n            }\r\n            if(this.activeName=='hospital'){\r\n               let data\r\n                if(e){\r\n                    data = { compCode: this.$store.state.user.accountInfo.deptId ,clinicType:2,deptName:e};\r\n                }else{\r\n                    data = { compCode: this.$store.state.user.accountInfo.deptId ,clinicType:2};      \r\n                } \r\n                this.getTreeDept(data)                       \r\n            }\r\n        },\r\n        //tab切换事件\r\n       async handleClick(tab){\r\n            if(tab.label==\"住院\"){\r\n                this.changeHosDeptList=[]\r\n                this.changeHosDeptList1=[]\r\n                // this.form.hospitalServiceLeft=[]                \r\n                this.activeName='hospital'\r\n                if(this.clickCount==0){\r\n                 await this.getDetail(2)  \r\n                }\r\n                this.clickCount+=1\r\n                await this.getTreeDept({ compCode: this.$store.state.user.accountInfo.deptId ,clinicType:2})\r\n            }\r\n            if(tab.label=='门诊'){\r\n                // this.form.outpatientServiceLeft=[]\r\n                this.changeDeptList1=[]\r\n                this.changeDeptList=[]\r\n                this.activeName='outPatient'   \r\n               await this.getTreeDept({ compCode: this.$store.state.user.accountInfo.deptId ,clinicType:1}) \r\n            }\r\n        },\r\n        //获取门诊及住院右侧列表数据\r\n        async getDetail(type){\r\n            let params={\r\n                compCode:this.queryParams.compCode,\r\n                revenueCode:this.queryParams.revenueCode,\r\n                deptType:type\r\n            }\r\n            if(type==1){\r\n                this.loading1=true\r\n                let arr=[]\r\n                await getRevenueDept(params).then(response => {       \r\n                    for(let i=0;i<response.total;i++){\r\n                        arr.indexOf(response.rows[i])===-1?arr.push({ratio:response.rows[i].ratio,dictValue:response.rows[i].deptCode,dictLabel:response.rows[i].deptName}):arr\r\n                    } \r\n                    this.form.outpatientServiceRight = JSON.parse(JSON.stringify(arr));\r\n                    this.outpatientRightLength=response.total\r\n                    this.loading1=false \r\n                });\r\n                return\r\n            }\r\n            if(type==2){\r\n                this.loading3=true\r\n                let arr=[]\r\n               await getRevenueDept(params).then(response => {\r\n                   for(let i=0;i<response.total;i++){\r\n                        arr.indexOf(response.rows[i])===-1?arr.push({ratio:response.rows[i].ratio,dictValue:response.rows[i].deptCode,dictLabel:response.rows[i].deptName}):arr\r\n                    } \r\n                    this.form.hospitalServiceRight = JSON.parse(JSON.stringify(arr));\r\n                    this.hospitalRightLength=response.total \r\n                    this.loading3=false                                                       \r\n                });\r\n                return\r\n            }\r\n             \r\n        },\r\n        //获取科室列表及门诊和住院左侧数据\r\n        async getTreeDept(data) {\r\n             this.loading=true\r\n             this.loading2=true\r\n             if(this.clickCount==0){\r\n                await this.getDetail(2)\r\n            }\r\n            this.clickCount+=1\r\n            await getDeptList(data).then(response => {\r\n                if (response.code == 200) {\r\n                    this.deptDatasLength=response.data.length\r\n                    if(data.clinicType==1){\r\n                        // this.form.outpatientServiceLeft=[]\r\n                        this.changeDeptList1=[]\r\n                        this.changeDeptList=[]\r\n                        this.deptDatas=JSON.parse(JSON.stringify(response.data.map(ite=>{\r\n                            ite.ratio=0\r\n                            return ite\r\n                        })));\r\n                        if(this.outpatientRightLength!==0 || this.form.outpatientServiceRight.length==1){\r\n                            this.changeDeptList1=JSON.parse(JSON.stringify(response.data.map(ite=>{\r\n                            ite.ratio=0\r\n                            return ite\r\n                        })));\r\n                            for(let i in this.form.outpatientServiceRight){\r\n                                    for(let k in this.changeDeptList1){\r\n                                    if(this.form.outpatientServiceRight[i].dictValue == this.changeDeptList1[k].dictValue){\r\n                                        this.changeDeptList1.splice(k,1)\r\n                                    }\r\n                                }\r\n                            }\r\n                           this.form.outpatientServiceLeft=JSON.parse(JSON.stringify(this.changeDeptList1))\r\n                           this.loading=false\r\n                           return\r\n                        }else if(this.outpatientRightLength>1){\r\n                            this.changeDeptList=JSON.parse(JSON.stringify(response.data.map(ite=>{\r\n                            ite.ratio=0\r\n                            return ite\r\n                        })));\r\n                            for(let i in this.form.outpatientServiceRight){\r\n                                    for(let k in this.changeDeptList){\r\n                                    if(this.form.outpatientServiceRight[i].dictValue == this.changeDeptList[k].dictValue){\r\n                                        this.changeDeptList.splice(k,1)\r\n                                    }\r\n                                }\r\n                            }\r\n                           this.form.outpatientServiceLeft=JSON.parse(JSON.stringify(this.changeDeptList))\r\n                           this.loading=false\r\n                           return\r\n                        }else if(this.outpatientRightLength==0&&this.form.outpatientServiceRight.length==0){\r\n                            this.form.outpatientServiceLeft=JSON.parse(JSON.stringify(this.deptDatas))\r\n                            this.loading=false\r\n                            return\r\n                        }\r\n                    }\r\n                    if(data.clinicType==2){\r\n                        this.changeHosDeptList=[]\r\n                        this.changeHosDeptList1=[]\r\n                        // this.form.hospitalServiceLeft=[]\r\n                        this.deptDatasHos=JSON.parse(JSON.stringify(response.data.map(ite=>{\r\n                            ite.ratio=0\r\n                            return ite\r\n                        })));\r\n                        if(this.hospitalRightLength!==0 || this.form.hospitalServiceRight.length==1){\r\n                             this.changeHosDeptList1=JSON.parse(JSON.stringify(response.data.map(ite=>{\r\n                            ite.ratio=0\r\n                            return ite\r\n                        })));\r\n                            for(let i in this.form.hospitalServiceRight){\r\n                                    for(let k in this.changeHosDeptList1){\r\n                                    if(this.form.hospitalServiceRight[i].dictValue == this.changeHosDeptList1[k].dictValue){\r\n                                        this.changeHosDeptList1.splice(k,1)\r\n                                    }\r\n                                }\r\n                            }\r\n                            this.form.hospitalServiceLeft=JSON.parse(JSON.stringify(this.changeHosDeptList1))\r\n                            this.loading2=false        \r\n                            return                   \r\n                        }else if(this.form.hospitalServiceRight.length>1){              \r\n                            this.changeHosDeptList=JSON.parse(JSON.stringify(response.data.map(ite=>{\r\n                            ite.ratio=0\r\n                            return ite\r\n                        })));\r\n                            for(let i in this.form.hospitalServiceRight){\r\n                                    for(let k in this.changeHosDeptList){\r\n                                    if(this.form.hospitalServiceRight[i].dictValue == this.changeHosDeptList[k].dictValue){\r\n                                        this.changeHosDeptList.splice(k,1)\r\n                                    }\r\n                                }\r\n                            }\r\n                            this.loading2=false\r\n                            this.form.hospitalServiceLeft=JSON.parse(JSON.stringify(this.changeHosDeptList))\r\n                            return                                              \r\n                        }else if(this.hospitalRightLength==0 && this.form.hospitalServiceRight.length==0){\r\n                            this.form.hospitalServiceLeft=JSON.parse(JSON.stringify(this.deptDatasHos))\r\n                            this.loading2=false\r\n                            return                                               \r\n                        }\r\n                        \r\n                    }\r\n\r\n                } else {\r\n                    this.msgError(response.msg);\r\n                }\r\n            });\r\n            \r\n            \r\n        },\r\n        hospitalToright(){\r\n            //将过滤后的数组需要添加到右边的数组中\r\n            for(let i = 0;i<this.selectionRowhospitalLeft.length;i++){\r\n                 this.form.hospitalServiceRight.indexOf(this.selectionRowhospitalLeft[i]) === -1 ?  this.form.hospitalServiceRight.push(this.selectionRowhospitalLeft[i]) :  this.form.hospitalServiceRight\r\n            };        \r\n            //剩余左边数据\r\n            for(let i=0;i<this.form.hospitalServiceLeft.length;i++){\r\n                 this.form.hospitalServiceRight.forEach(ite=>{\r\n                    if(this.form.hospitalServiceLeft[i]&&this.form.hospitalServiceLeft[i].dictValue==ite.dictValue){        \r\n                          this.form.hospitalServiceLeft.splice(i,1)\r\n                          i-=1\r\n                          i<0?0:i\r\n                    }\r\n                })\r\n            }\r\n        },\r\n        hospitalToLeft(){\r\n            for(let i = 0;i<this.selectionRowhospitalRight.length;i++){\r\n                this.form.hospitalServiceLeft.indexOf(this.selectionRowhospitalRight[i]) === -1 ?  this.form.hospitalServiceLeft.push(this.selectionRowhospitalRight[i]) :  this.form.hospitalServiceLeft\r\n            };\r\n            //剩余右边数据\r\n            for(let i=0;i<this.form.hospitalServiceRight.length;i++){\r\n                 this.form.hospitalServiceLeft.forEach(ite=>{\r\n                    if(this.form.hospitalServiceRight[i]&&this.form.hospitalServiceRight[i].dictValue==ite.dictValue){     \r\n                          this.form.hospitalServiceRight.splice(i,1)\r\n                          i-=1\r\n                          i<0?0:i\r\n                    }\r\n                })\r\n            }\r\n        },\r\n        outpatientToright(){\r\n          //将过滤后的数组需要添加到右边的数组中\r\n            for(let i = 0;i<this.selectionRowoutpatientLeft.length;i++){\r\n                 this.form.outpatientServiceRight.indexOf(this.selectionRowoutpatientLeft[i]) === -1 ?  this.form.outpatientServiceRight.push(this.selectionRowoutpatientLeft[i]) :  this.form.outpatientServiceRight\r\n            };    \r\n            //剩余左边数据\r\n            for(let i=0;i<this.form.outpatientServiceLeft.length;i++){\r\n                 this.form.outpatientServiceRight.forEach(ite=>{\r\n                    if(this.form.outpatientServiceLeft[i]&&this.form.outpatientServiceLeft[i].dictValue==ite.dictValue){\r\n                          this.form.outpatientServiceLeft.splice(i,1)\r\n                          i-=1\r\n                          i<0?0:i\r\n                    }\r\n                })\r\n            }\r\n\t\t},\r\n        //将右边数据放到左边\r\n        outpatientToleft(){\r\n            for(let i = 0;i<this.selectionRowOutpatientRight.length;i++){\r\n                 this.form.outpatientServiceLeft.indexOf(this.selectionRowOutpatientRight[i]) === -1 ?  this.form.outpatientServiceLeft.push(this.selectionRowOutpatientRight[i]) :  this.form.outpatientServiceLeft\r\n            };\r\n            //剩余右边数据\r\n            for(let i=0;i<this.form.outpatientServiceRight.length;i++){\r\n                 this.form.outpatientServiceLeft.forEach(ite=>{\r\n                    if(this.form.outpatientServiceRight[i]&&this.form.outpatientServiceRight[i].dictValue==ite.dictValue){         \r\n                          this.form.outpatientServiceRight.splice(i,1)\r\n                          i-=1\r\n                          i<0?i=0:i\r\n                    }\r\n                })\r\n            }\r\n        },\r\n        // 门诊多选框选中数据\r\n        handleSelectionOutpatientChange(selection) {\r\n            this.selectionRowoutpatientLeft=selection.map(ite=>{\r\n                ite.ratio=0\r\n                return ite\r\n            });\r\n            if(selection.length!==0){\r\n                this.patToRightBool=false;\r\n            }else{\r\n                this.patToRightBool=true;\r\n            }\r\n        },\r\n        //门诊右侧多选框数据\r\n        handleSelectionChangeRight(selection){\r\n            this.selectionRowOutpatientRight=selection;\r\n            if(selection.length!==0){\r\n                this.patToLeftBool=false;\r\n            }else{\r\n                this.patToLeftBool=true;\r\n            }\r\n        },\r\n        //住院左侧多选框\r\n        handleSelectionHospitalChange(selection){\r\n            this.selectionRowhospitalLeft=selection.map(ite=>{\r\n                ite.ratio=0\r\n                return ite\r\n            });\r\n            if(selection.length!==0){\r\n                this.hosToRightBool=false;\r\n            }else{\r\n                this.hosToRightBool=true;\r\n            }\r\n        },\r\n        //住院右侧多选框\r\n        handleSelectionHospitalChangeRight(selection){\r\n            this.selectionRowhospitalRight=selection;\r\n            if(selection.length!==0){\r\n                this.hosToLeftBool=false;\r\n            }else{\r\n               this.hosToLeftBool=true;\r\n            }\r\n        },\r\n        rowClick(row, column, event) {\r\n            let refsElTable = this.$refs.multipleTable;\r\n            let findRow = this.selectionRowoutpatientLeft.find(c => c.rowIndex == row.rowIndex);\r\n            if (findRow && this.selectionRowoutpatientLeft.length == 1) {\r\n                refsElTable.toggleRowSelection(row, false);\r\n                return;\r\n            }\r\n            refsElTable.clearSelection();\r\n            refsElTable.toggleRowSelection(row);\r\n        },\r\n        rowClickPatRight(row, column, event){\r\n            let refsElTable = this.$refs.multipleTableRight;\r\n            let findRow = this.selectionRowOutpatientRight.find(c => c.rowIndex == row.rowIndex);\r\n            if (findRow && this.selectionRowOutpatientRight.length == 1) {\r\n                refsElTable.toggleRowSelection(row, false);\r\n                return;\r\n            }\r\n            refsElTable.clearSelection();\r\n            refsElTable.toggleRowSelection(row);\r\n        },\r\n        rowClickHos(row, column, event){\r\n            let refsElTable = this.$refs.multipleTableHos;\r\n            let findRow = this.selectionRowhospitalLeft.find(c => c.rowIndex == row.rowIndex);\r\n            if (findRow && this.selectionRowhospitalLeft.length == 1) {\r\n                refsElTable.toggleRowSelection(row, false);\r\n                return;\r\n            }\r\n            refsElTable.clearSelection();\r\n            refsElTable.toggleRowSelection(row);\r\n        },\r\n        rowClickHosRight(row, column, event){\r\n            let refsElTable = this.$refs.multipleTableRightHos;\r\n            let findRow = this.selectionRowhospitalRight.find(c => c.rowIndex == row.rowIndex);\r\n            if (findRow && this.selectionRowhospitalRight.length == 1) {\r\n                refsElTable.toggleRowSelection(row, false);\r\n                return;\r\n            }\r\n            refsElTable.clearSelection();\r\n            refsElTable.toggleRowSelection(row);\r\n        },\r\n        reset(){\r\n            this.form={\r\n                outpatientServiceLeft:[],//门诊左侧数据\r\n                outpatientServiceRight:[],//门诊右侧数据\r\n                hospitalServiceLeft:[],//住院左侧数据\r\n                hospitalServiceRight:[],//住院右侧数据\r\n            };\r\n            this.clickCount=0\r\n        },\r\n        /** 科室提交按钮 */\r\n        submitFormDept() {\r\n            this.$refs[\"queryForm\"].validate(valid => {\r\n                if (valid) {\r\n                let params,arr=[],arr1=[],sum=0,sum1=0;\r\n                    if(this.form.outpatientServiceRight.length==0 && this.form.hospitalServiceRight==0){\r\n                        params={\r\n                            revenueCode:this.queryParams.revenueCode,\r\n                            pmsRevenueDepts:[],\r\n                            compCode:this.queryParams.compCode,\r\n                        }\r\n                        let saveLoading = this.saveLoading();\r\n                            addDeptList(params).then(response => {\r\n                                this.msgSuccess(\"收入核算科室设置成功\");\r\n                                this.$emit(\"success\", false);\r\n                                saveLoading.close();\r\n                        });\r\n                    }\r\n                    if(this.form.outpatientServiceRight.length==0 && this.form.hospitalServiceRight!=0){\r\n                        this.form.hospitalServiceRight.forEach(ite=>{\r\n                            sum1+=Number(ite.ratio)                        \r\n                            arr1.push({\r\n                                deptName:ite.dictLabel,\r\n                                deptCode:ite.dictValue,\r\n                                ratio:ite.ratio\r\n                            })\r\n                        })\r\n                        params={\r\n                            revenueCode:this.queryParams.revenueCode,\r\n                            pmsRevenueDepts:arr1,\r\n                            compCode:this.queryParams.compCode,\r\n                        }\r\n                        if(sum1>100){\r\n                            this.msgError(\"住院已选科室分摊比例的总和应小于或等于100\")\r\n                            return\r\n                        }else{\r\n                            let saveLoading = this.saveLoading();\r\n                            addDeptList(params).then(response => {\r\n                                this.msgSuccess(\"收入核算科室设置成功\");\r\n                                this.$emit(\"success\", false);\r\n                                saveLoading.close();\r\n                            });\r\n                        }\r\n                    }\r\n                    if(this.form.outpatientServiceRight.length!=0 && this.form.hospitalServiceRight==0){\r\n                        this.form.outpatientServiceRight.forEach(ite=>{\r\n                            sum+=Number(ite.ratio)\r\n                            arr.push({\r\n                                deptName:ite.dictLabel,\r\n                                deptCode:ite.dictValue,\r\n                                ratio:ite.ratio\r\n                            })\r\n                        })\r\n                        params={\r\n                            revenueCode:this.queryParams.revenueCode,\r\n                            pmsRevenueDepts:arr,\r\n                            compCode:this.queryParams.compCode,\r\n                        }\r\n                        if(sum>100){\r\n                            this.msgError(\"门诊已选科室分摊比例的总和应小于或等于100\")\r\n                            return\r\n                        }else{\r\n                            let saveLoading = this.saveLoading();\r\n                            addDeptList(params).then(response => {\r\n                                this.msgSuccess(\"收入核算科室设置成功\");\r\n                                this.$emit(\"success\", false);\r\n                                saveLoading.close();\r\n                            });\r\n                        }\r\n                    }\r\n                    if(this.form.outpatientServiceRight.length!=0 && this.form.hospitalServiceRight.length!=0){\r\n                        this.form.outpatientServiceRight.forEach(ite=>{\r\n                            sum+=Number(ite.ratio)\r\n                            arr.push({\r\n                                deptName:ite.dictLabel,\r\n                                deptCode:ite.dictValue,\r\n                                ratio:ite.ratio\r\n                            })\r\n                        })\r\n                        this.form.hospitalServiceRight.forEach(ite=>{\r\n                            sum1+=Number(ite.ratio)                        \r\n                            arr1.push({\r\n                                deptName:ite.dictLabel,\r\n                                deptCode:ite.dictValue,\r\n                                ratio:ite.ratio\r\n                            })\r\n                        })\r\n                        params={\r\n                            revenueCode:this.queryParams.revenueCode,\r\n                            pmsRevenueDepts:[...arr1,...arr],\r\n                            compCode:this.queryParams.compCode,\r\n                        }\r\n                        if(sum>100||sum1>100){\r\n                            this.msgError(\"门诊及住院已选科室分摊比例的总和应分别小于或等于100\")\r\n                            return\r\n                        }else{\r\n                            let saveLoading = this.saveLoading();\r\n                            addDeptList(params).then(response => {\r\n                                this.msgSuccess(\"收入核算科室设置成功\");\r\n                                this.$emit(\"success\", false);\r\n                                saveLoading.close();\r\n                            });\r\n                        }\r\n                    }\r\n                    \r\n                }\r\n            });\r\n        },\r\n      // 弹框关闭\r\n        handleDialogClose() {\r\n            this.$emit(\"cancel\", false);\r\n            this.reset()\r\n        },\r\n        // 取消\r\n        cancel() {\r\n            this.$emit(\"cancel\", false);\r\n            this.reset()\r\n        },\r\n    },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n::v-deep .el-dialog{\r\n    .el-form-item__label{\r\n        width: 80px !important;\r\n    }\r\n    .el-form-item__content{\r\n        margin-left: 80px !important\r\n    }\r\n    .el-tabs__item.is-top{\r\n        font-size:16px;\r\n    }\r\n}\r\n.transfer{\r\n    width: 100%;\r\n    .transfer_left{\r\n        border: 1px solid #cccccc;\r\n        border-radius: 2%;\r\n        width: 45%;\r\n        float: left;\r\n        overflow: hidden;\r\n        height:500px;\r\n        .transfer_left_top{\r\n            padding: 0 10px;\r\n            p{\r\n                position: relative;\r\n                label{\r\n                    font-size: 16px;\r\n                    font-weight: normal;\r\n                    margin-left: 10px\r\n                }\r\n                span{\r\n                position: absolute;\r\n                right: 10px\r\n            }\r\n            }\r\n        }\r\n    }\r\n    .transfer_main{\r\n        width: 10%;\r\n        float: left;\r\n        line-height: 500px;\r\n        text-align: center;\r\n        position: relative;\r\n       ::v-deep .el-button-group .el-button--primary:first-child{\r\n           position: absolute;\r\n           top:40%;\r\n           left: 50%;\r\n           transform: translate(-50%,-50%);\r\n           border: 0;\r\n           border-radius: 4px;\r\n        }\r\n        ::v-deep .el-button-group .el-button--primary:last-child{\r\n           position: absolute;\r\n           top:50%;\r\n           left: 50%;\r\n           transform: translate(-50%,-50%);\r\n           border: 0;\r\n           border-radius: 4px;\r\n\r\n        }\r\n    }\r\n    .transfer_right{\r\n        border: 1px solid #cccccc;\r\n        border-radius: 2%;\r\n        width: 45%;\r\n        height: 500px;\r\n        overflow: hidden;\r\n        float: right;\r\n        .transfer_right_top{\r\n            padding: 0 10px;            \r\n            p{\r\n                position: relative;\r\n                label{\r\n                    font-weight: normal;\r\n                    font-size: 16px; \r\n                    margin-left: 10px\r\n                }\r\n                span{\r\n                    position: absolute;\r\n                    right: 10px\r\n                }\r\n            }\r\n        }\r\n    }\r\n    .checkbox_left{\r\n        margin-top: 10px;\r\n        padding:0 4px;\r\n        overflow: auto;\r\n        min-height:300px;\r\n    }\r\n}\r\n</style>"]}]}