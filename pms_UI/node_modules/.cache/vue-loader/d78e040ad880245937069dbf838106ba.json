{"remainingRequest":"E:\\HRP_JAVA_pms\\pms_UI\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\HRP_JAVA_pms\\pms_UI\\src\\views\\second\\dept\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\HRP_JAVA_pms\\pms_UI\\src\\views\\second\\dept\\index.vue","mtime":1693362205982},{"path":"E:\\HRP_JAVA_pms\\pms_UI\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1693361924439},{"path":"E:\\HRP_JAVA_pms\\pms_UI\\node_modules\\babel-loader\\lib\\index.js","mtime":1693361909992},{"path":"E:\\HRP_JAVA_pms\\pms_UI\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1693361924439},{"path":"E:\\HRP_JAVA_pms\\pms_UI\\node_modules\\vue-loader\\lib\\index.js","mtime":1693362179279}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGxpc3REZXB0QnlDb21wQ29kZSwgc2F2ZURlcHQsIGRlbERlcHQsIGFkZERlcHQsIHVwZGF0ZURlcHQsIGV4cG9ydERlcHQgfSBmcm9tICJAL2FwaS9zZWNvbmQvZGVwdCI7CmltcG9ydCB7Z2V0WWVhcn0gZnJvbSAiQC91dGlscy9kYXRlIjsKaW1wb3J0IHtnZXREaXN0cmlidXRpb259IGZyb20gIkAvYXBpL3N5c3RlbS9kaWN0L2RhdGEiOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJEZXB0IiwKICBjb21wb25lbnRzOiB7CiAgfSwKICBtb3VudGVkKCl7CiAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgIHRoaXMucmVzaXplSGFuZGxlcigpOwogICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigicmVzaXplIiwgdGhpcy5yZXNpemVIYW5kbGVyKTsKICAgIH0pOwogIH0sCiAgd2F0Y2g6IHsKICAgIGxpc3REYXRhKHZhbCkgewogICAgICBsZXQgdGhhdCA9IHRoaXM7CiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIHRoYXQucmVzaXplSGFuZGxlcigpOwogICAgICB9LCAzMDApOwogICAgfQogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIC8vIOmBrue9qeWxggogICAgICBsb2FkaW5nOiB0cnVlLAogICAgICAvLyDlr7zlh7rpga7nvanlsYIKICAgICAgZXhwb3J0TG9hZGluZzogZmFsc2UsCiAgICAgIC8vIOmAieS4reaVsOe7hAogICAgICBpZHM6IFtdLAogICAgICAvLyDpnZ7ljZXkuKrnpoHnlKgKICAgICAgc2luZ2xlOiB0cnVlLAogICAgICAvLyDpnZ7lpJrkuKrnpoHnlKgKICAgICAgbXVsdGlwbGU6IHRydWUsCiAgICAgIC8vIOaYvuekuuaQnOe0ouadoeS7tgogICAgICBzaG93U2VhcmNoOiB0cnVlLAogICAgICAvLyDmgLvmnaHmlbAKICAgICAgdG90YWw6IDAsCiAgICAgIC8vIOS6jOasoeWIhumFjeenkeWupOaMh+agh+ihqOagvOaVsOaNrgogICAgICBkZXB0TGlzdDogW10sCiAgICAgIHNlbGVjdGlvblJvdzogW10sCiAgICAgIC8v5oyH5qCH6ZuG5a2X5YW4CiAgICAgIGRpc3RyaWJ1dGlvbk9wdGlvbnM6IFtdLAogICAgICAvLyDlvLnlh7rlsYLmoIfpopgKICAgICAgdGl0bGU6ICIiLAogICAgICAvLyDmmK/lkKbmmL7npLrlvLnlh7rlsYIKICAgICAgb3BlbjogZmFsc2UsCiAgICAgIHRhYmxlSGVpZ2h0OiAiYXV0byIsCiAgICAgIC8vIOafpeivouWPguaVsAogICAgICBxdWVyeVBhcmFtczogewogICAgICAgIHBhZ2VOdW06IDEsCiAgICAgICAgcGFnZVNpemU6IDMwLAogICAgICAgIGNvbXBDb2RlOiB0aGlzLiRzdG9yZS5zdGF0ZS51c2VyLnVzZXJJbmZvLmRlcHRJZCwKICAgICAgICBhY2NvdW50Q29kZTogbnVsbCwKICAgICAgICBkZXB0Q29kZTogbnVsbCwKICAgICAgICBkaXNDb2RlOiBudWxsLAogICAgICAgIG5vd0RhdGU6IGdldFllYXIoKSwKICAgICAgICBkZXB0TGlzdDogW10sCiAgICAgIH0sCiAgICAgIC8vIOihqOWNleWPguaVsAogICAgICBmb3JtOiB7fSwKICAgICAgLy8g6KGo5Y2V5qCh6aqMCiAgICAgIHJ1bGVzOiB7CiAgICAgICAgbm93RGF0ZTogWwogICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+mAieaLqeW5tOaciCcsIHRyaWdnZXI6ICdjaGFuZ2UnIH0KICAgICAgICBdCiAgICAgIH0KICAgIH07CiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5nZXRMaXN0KCk7CiAgICBnZXREaXN0cmlidXRpb24odGhpcy5xdWVyeVBhcmFtcykudGhlbihyZXNwb25zZSA9PiB7CiAgICAgIHRoaXMuZGlzdHJpYnV0aW9uT3B0aW9ucyA9IHJlc3BvbnNlLmRhdGE7CiAgICB9KTsKICB9LAogIG1ldGhvZHM6IHsKICAgIC8qKiDmn6Xor6LkuozmrKHliIbphY3np5HlrqTmjIfmoIfliJfooaggKi8KICAgIGdldExpc3QoKSB7CiAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICAgIGxpc3REZXB0QnlDb21wQ29kZSh0aGlzLnF1ZXJ5UGFyYW1zKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICB0aGlzLmRlcHRMaXN0ID0gcmVzcG9uc2Uucm93czsKICAgICAgICB0aGlzLnRvdGFsID0gcmVzcG9uc2UudG90YWw7CiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgIH0pOwogICAgfSwKICAgIC8qKiDmkJzntKLmjInpkq7mk43kvZwgKi8KICAgIGhhbmRsZVF1ZXJ5KCkgewogICAgICB0aGlzLnF1ZXJ5UGFyYW1zLnBhZ2VOdW0gPSAxOwogICAgICB0aGlzLmdldExpc3QoKTsKICAgIH0sCiAgICAvKiog6YeN572u5oyJ6ZKu5pON5L2cICovCiAgICByZXNldFF1ZXJ5KCkgewogICAgICB0aGlzLnJlc2V0Rm9ybSgicXVlcnlGb3JtIik7CiAgICAgIHRoaXMuaGFuZGxlUXVlcnkoKTsKICAgIH0sCiAgICAvLyDlpJrpgInmoYbpgInkuK3mlbDmja4KICAgIGhhbmRsZVNlbGVjdGlvbkNoYW5nZShzZWxlY3Rpb24pIHsKICAgICAgdGhpcy5pZHMgPSBzZWxlY3Rpb24ubWFwKGl0ZW0gPT4gaXRlbS5pZCkKICAgICAgdGhpcy5zaW5nbGUgPSBzZWxlY3Rpb24ubGVuZ3RoIT09MQogICAgICB0aGlzLm11bHRpcGxlID0gIXNlbGVjdGlvbi5sZW5ndGgKICAgICAgdGhpcy5zZWxlY3Rpb25Sb3c9c2VsZWN0aW9uCiAgICB9LAogICAgcm93Q2xpY2socm93LCBjb2x1bW4sIGV2ZW50KSB7CiAgICAgIGxldCByZWZzRWxUYWJsZSA9IHRoaXMuJHJlZnMubXVsdGlwbGVUYWJsZTsKICAgICAgbGV0IGZpbmRSb3cgPSB0aGlzLnNlbGVjdGlvblJvdy5maW5kKGMgPT4gYy5yb3dJbmRleCA9PSByb3cucm93SW5kZXgpOwogICAgICBpZiAoZmluZFJvdyAmJiB0aGlzLnNlbGVjdGlvblJvdy5sZW5ndGggPT0gMSkgewogICAgICAgIHJlZnNFbFRhYmxlLnRvZ2dsZVJvd1NlbGVjdGlvbihyb3csIGZhbHNlKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgcmVmc0VsVGFibGUuY2xlYXJTZWxlY3Rpb24oKTsKICAgICAgcmVmc0VsVGFibGUudG9nZ2xlUm93U2VsZWN0aW9uKHJvdyk7CiAgICB9LAogICAgcm93U3R5bGUoewogICAgICByb3csCiAgICAgIHJvd0luZGV4CiAgICB9KSB7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyb3csICdyb3dJbmRleCcsIHsKICAgICAgICB2YWx1ZTogcm93SW5kZXgsCiAgICAgICAgd3JpdGFibGU6IHRydWUsCiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UKICAgICAgfSkKICAgIH0sCiAgICByb3dDbGFzc05hbWUoewogICAgICByb3csCiAgICAgIHJvd0luZGV4CiAgICB9KSB7CiAgICAgIGxldCByb3dOYW1lID0gIiIsCiAgICAgICAgZmluZFJvdyA9IHRoaXMuc2VsZWN0aW9uUm93LmZpbmQoYyA9PiBjLnJvd0luZGV4ID09PSByb3cucm93SW5kZXgpOwogICAgICBpZiAoZmluZFJvdykgewogICAgICAgIHJvd05hbWUgPSAiY3VycmVudC1yb3cgIjsKICAgICAgfQogICAgICByZXR1cm4gcm93TmFtZTsKICAgIH0sCiAgICAvKiog5paw5aKe5oyJ6ZKu5pON5L2cICovCiAgICBoYW5kbGVBZGQoKSB7CiAgICAgIHRoaXMuJHJlZnNbInF1ZXJ5Rm9ybSJdLnZhbGlkYXRlKHZhbGlkID0+IHsKICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgIGxldCBzYXZlTG9hZGluZyA9IHRoaXMuc2F2ZUxvYWRpbmcoKTsKICAgICAgICAgIHRoaXMucXVlcnlQYXJhbXMuZGVwdExpc3QgPSB0aGlzLmRlcHRMaXN0OwogICAgICAgICAgc2F2ZURlcHQodGhpcy5xdWVyeVBhcmFtcykudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgIHRoaXMubXNnU3VjY2Vzcygi5L+d5a2Y5oiQ5YqfIik7CiAgICAgICAgICAgIHRoaXMucXVlcnlQYXJhbXMuZGVwdExpc3QgPSBbXTsKICAgICAgICAgICAgc2F2ZUxvYWRpbmcuY2xvc2UoKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgLyoqIOWIt+aWsOaMiemSruaTjeS9nCAqLwogICAgaGFuZGxlUmVmcmVzaCgpIHsKICAgICAgdGhpcy4kY29uZmlybSgn56Gu5a6a5Yi35paw5b2T5YmN5pWw5o2u5ZCX77yM5pyq5L+d5a2Y5pWw5o2u5Y2z5bCG5riF56m677yBJywgIuitpuWRiiIsIHsKICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogIuehruWumiIsCiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogIuWPlua2iCIsCiAgICAgICAgdHlwZTogIndhcm5pbmciCiAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgIHRoaXMuaGFuZGxlUXVlcnkoKTsKICAgICAgfSkuY2F0Y2goKCkgPT4ge30pOwogICAgfSwKICAgIHJlc2l6ZUhhbmRsZXIoKSB7CiAgICAgIGxldCBhID0gdGhpcy4kcmVmcy5zZWFyY2gub2Zmc2V0SGVpZ2h0OwogICAgICBsZXQgYiA9IHRoaXMuJHJlZnMuYnRucy5vZmZzZXRIZWlnaHQ7CiAgICAgIGxldCBoID0gYSArIGIgKyAxOCArIDQ1ICsgODQgKyA0MCArIDIwOwogICAgICBoID0gaCArICJweCI7CiAgICAgIHRoaXMudGFibGVIZWlnaHQgPSBgY2FsYygxMDB2aCAtICR7aH0pYDsKICAgIH0sCiAgfQp9Owo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/second/dept","sourcesContent":["<template>\n  <div class=\"app-container\">\n  <div ref=\"search\">\n    <el-form :model=\"queryParams\" ref=\"queryForm\" :rules=\"rules\" :inline=\"true\" v-show=\"showSearch\" label-width=\"68px\">\n      <el-form-item label=\"年月\" prop=\"nowDate\">\n        <el-date-picker class=\"search_w220\" clearable\n                        v-model=\"queryParams.nowDate\"\n                        type=\"month\"\n                        value-format=\"yyyy-MM\"\n                        placeholder=\"选择年月\">\n        </el-date-picker>\n      </el-form-item>\n      <el-form-item>\n        <el-button type=\"primary\" icon=\"el-icon-search\" size=\"mini\" @click=\"handleQuery\">搜索</el-button>\n        <el-button icon=\"el-icon-refresh\" size=\"mini\" @click=\"resetQuery\">重置</el-button>\n      </el-form-item>\n    </el-form>\n\t</div>\n\t<div ref=\"btns\">\n    <el-row :gutter=\"10\" class=\"mb8\">\n      <el-col :span=\"1.5\">\n        <el-button\n          type=\"primary\"\n          icon=\"el-icon-box\"\n          size=\"mini\"\n          @click=\"handleAdd\"\n          v-hasPermi=\"['second:dept:add']\"\n        >保存</el-button>\n      </el-col>\n      <el-col :span=\"1.5\">\n        <el-button\n          size=\"mini\"\n          type=\"primary\"\n          icon=\"el-icon-refresh\"\n          @click=\"handleRefresh\"\n        >刷新</el-button>\n      </el-col>\n      <right-toolbar :showSearch.sync=\"showSearch\" @queryTable=\"getList\"></right-toolbar>\n    </el-row>\n\t</div>\n\n    <el-table border stripe v-loading=\"loading\" :data=\"deptList\" :height=\"tableHeight\" @selection-change=\"handleSelectionChange\" ref=\"multipleTable\" @row-click=\"rowClick\" :row-style=\"rowStyle\" :row-class-name=\"rowClassName\">\n      <el-table-column sortable label=\"核算科室编码\" align=\"center\" prop=\"deptCode\" />\n      <el-table-column sortable label=\"核算科室名称\" align=\"left\" prop=\"deptName\" />\n      <el-table-column sortable label=\"指标集编码\" align=\"center\" prop=\"disCode\" >\n        <template slot-scope=\"scope\">\n          <el-select class=\"w100\" v-model=\"scope.row.disCode\" placeholder=\"请选择指标集编码\">\n            <el-option\n              v-for=\"dict in distributionOptions\"\n              :key=\"dict.dictValue\"\n              :label=\"dict.dictLabel\"\n              :value=\"dict.dictValue\"\n            ></el-option>\n          </el-select>\n        </template>\n      </el-table-column>\n    </el-table>\n\n    <pagination\n      v-show=\"total>0\"\n      :total=\"total\"\n      :page.sync=\"queryParams.pageNum\"\n      :limit.sync=\"queryParams.pageSize\"\n      @pagination=\"getList\"\n    />\n\n  </div>\n</template>\n\n<script>\nimport { listDeptByCompCode, saveDept, delDept, addDept, updateDept, exportDept } from \"@/api/second/dept\";\nimport {getYear} from \"@/utils/date\";\nimport {getDistribution} from \"@/api/system/dict/data\";\n\nexport default {\n  name: \"Dept\",\n  components: {\n  },\n  mounted(){\n    this.$nextTick(() => {\n      this.resizeHandler();\n      window.addEventListener(\"resize\", this.resizeHandler);\n    });\n  },\n  watch: {\n    listData(val) {\n      let that = this;\n      setTimeout(function () {\n        that.resizeHandler();\n      }, 300);\n    }\n  },\n  data() {\n    return {\n      // 遮罩层\n      loading: true,\n      // 导出遮罩层\n      exportLoading: false,\n      // 选中数组\n      ids: [],\n      // 非单个禁用\n      single: true,\n      // 非多个禁用\n      multiple: true,\n      // 显示搜索条件\n      showSearch: true,\n      // 总条数\n      total: 0,\n      // 二次分配科室指标表格数据\n      deptList: [],\n      selectionRow: [],\n      //指标集字典\n      distributionOptions: [],\n      // 弹出层标题\n      title: \"\",\n      // 是否显示弹出层\n      open: false,\n      tableHeight: \"auto\",\n      // 查询参数\n      queryParams: {\n        pageNum: 1,\n        pageSize: 30,\n        compCode: this.$store.state.user.userInfo.deptId,\n        accountCode: null,\n        deptCode: null,\n        disCode: null,\n        nowDate: getYear(),\n        deptList: [],\n      },\n      // 表单参数\n      form: {},\n      // 表单校验\n      rules: {\n        nowDate: [\n          { required: true, message: '请选择年月', trigger: 'change' }\n        ]\n      }\n    };\n  },\n  created() {\n    this.getList();\n    getDistribution(this.queryParams).then(response => {\n      this.distributionOptions = response.data;\n    });\n  },\n  methods: {\n    /** 查询二次分配科室指标列表 */\n    getList() {\n      this.loading = true;\n      listDeptByCompCode(this.queryParams).then(response => {\n        this.deptList = response.rows;\n        this.total = response.total;\n        this.loading = false;\n      });\n    },\n    /** 搜索按钮操作 */\n    handleQuery() {\n      this.queryParams.pageNum = 1;\n      this.getList();\n    },\n    /** 重置按钮操作 */\n    resetQuery() {\n      this.resetForm(\"queryForm\");\n      this.handleQuery();\n    },\n    // 多选框选中数据\n    handleSelectionChange(selection) {\n      this.ids = selection.map(item => item.id)\n      this.single = selection.length!==1\n      this.multiple = !selection.length\n      this.selectionRow=selection\n    },\n    rowClick(row, column, event) {\n      let refsElTable = this.$refs.multipleTable;\n      let findRow = this.selectionRow.find(c => c.rowIndex == row.rowIndex);\n      if (findRow && this.selectionRow.length == 1) {\n        refsElTable.toggleRowSelection(row, false);\n        return;\n      }\n      refsElTable.clearSelection();\n      refsElTable.toggleRowSelection(row);\n    },\n    rowStyle({\n      row,\n      rowIndex\n    }) {\n      Object.defineProperty(row, 'rowIndex', {\n        value: rowIndex,\n        writable: true,\n        enumerable: false\n      })\n    },\n    rowClassName({\n      row,\n      rowIndex\n    }) {\n      let rowName = \"\",\n        findRow = this.selectionRow.find(c => c.rowIndex === row.rowIndex);\n      if (findRow) {\n        rowName = \"current-row \";\n      }\n      return rowName;\n    },\n    /** 新增按钮操作 */\n    handleAdd() {\n      this.$refs[\"queryForm\"].validate(valid => {\n        if (valid) {\n          let saveLoading = this.saveLoading();\n          this.queryParams.deptList = this.deptList;\n          saveDept(this.queryParams).then(response => {\n            this.msgSuccess(\"保存成功\");\n            this.queryParams.deptList = [];\n            saveLoading.close();\n          });\n        }\n      });\n    },\n    /** 刷新按钮操作 */\n    handleRefresh() {\n      this.$confirm('确定刷新当前数据吗，未保存数据即将清空！', \"警告\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\"\n      }).then(() => {\n        this.handleQuery();\n      }).catch(() => {});\n    },\n    resizeHandler() {\n      let a = this.$refs.search.offsetHeight;\n      let b = this.$refs.btns.offsetHeight;\n      let h = a + b + 18 + 45 + 84 + 40 + 20;\n      h = h + \"px\";\n      this.tableHeight = `calc(100vh - ${h})`;\n    },\n  }\n};\n</script>\n"]}]}