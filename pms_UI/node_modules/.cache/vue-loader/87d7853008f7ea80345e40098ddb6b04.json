{"remainingRequest":"D:\\work\\pms_oracle\\pms_UI\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\work\\pms_oracle\\pms_UI\\src\\views\\workload\\workload\\addEdit.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\work\\pms_oracle\\pms_UI\\src\\views\\workload\\workload\\addEdit.vue","mtime":1693362206000},{"path":"D:\\work\\pms_oracle\\pms_UI\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1693361924000},{"path":"D:\\work\\pms_oracle\\pms_UI\\node_modules\\babel-loader\\lib\\index.js","mtime":1693361909000},{"path":"D:\\work\\pms_oracle\\pms_UI\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1693361924000},{"path":"D:\\work\\pms_oracle\\pms_UI\\node_modules\\vue-loader\\lib\\index.js","mtime":1693362179000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGFkZFdvcmtsb2FkLCBnZXRXb3JrbG9hZCwgbGlzdFdvcmtsb2FkLCB1cGRhdGVXb3JrbG9hZCB9IGZyb20gJ0AvYXBpL3dvcmtsb2FkL3dvcmtsb2FkJwppbXBvcnQgeyBsaXN0VHlwZSB9IGZyb20gJ0AvYXBpL3dvcmtsb2FkL3R5cGUnCmltcG9ydCBwaW55aW4gZnJvbSAnanMtcGlueWluJwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdhZGRFZGl0JywKICBwcm9wczogewogICAgb3BlbjogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0OiBmYWxzZQogICAgfSwKICAgIGlkOiB7CiAgICAgIHR5cGU6IFtTdHJpbmcsIE51bWJlcl0sCiAgICAgIGRlZmF1bHQ6ICcnCiAgICB9CiAgfSwKICB3YXRjaDogewogICAgaWQ6IHsKICAgICAgaGFuZGxlcih2YWwpIHsKICAgICAgICB0aGlzLnJlc2V0KCkKICAgICAgICBpZiAodmFsKSB7CiAgICAgICAgICB0aGlzLmlkID0gdmFsCiAgICAgICAgICB0aGlzLnRpdGxlID0gJ+W3peS9nOmHj+euoeeQhi3nvJbovpEnCiAgICAgICAgICB0aGlzLmdldERldGFpbEluZm8oKQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmlkID0gJycKICAgICAgICAgIHRoaXMudGl0bGUgPSAn5bel5L2c6YeP566h55CGLeaWsOWinicKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGRlZXA6IHRydWUsCiAgICAgIGltbWVkaWF0ZTogdHJ1ZQogICAgfSwKICAgIG9wZW46IHsKICAgICAgaGFuZGxlcih2YWwpIHsKICAgICAgICB0aGlzLm9wZW5EaWFsb2cgPSB2YWwKICAgICAgfSwKICAgICAgZGVlcDogdHJ1ZQogICAgfQogIH0sCiAgY29tcG9uZW50czoge30sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHRpdGxlOiAn5bel5L2c6YeP566h55CGLeaWsOWinicsCiAgICAgIG9wZW5EaWFsb2c6IHRoaXMub3BlbiwKICAgICAgdHlwZUxpc3Q6IFtdLAogICAgICBzYXZlTG9hZGluZzogZmFsc2UsCiAgICAgIC8vIOihqOWNleWPguaVsAogICAgICBmb3JtOiB7fSwKICAgICAgLy8g6KGo5Y2V5qCh6aqMCiAgICAgIHJ1bGVzOiB7CiAgICAgICAgd29ya2xvYWREYXRlOiBbCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn5bm05pyIJywgdHJpZ2dlcjogWydibHVyJywgJ2NoYW5nZSddIH0KICAgICAgICBdLAogICAgICAgIHByb2plY3RDb2RlOiBbCiAgICAgICAgICB7cmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfpobnnm67nvJbnoIEnLCB0cmlnZ2VyOiBbJ2JsdXInLCAnY2hhbmdlJ10gfQogICAgICAgIF0sCiAgICAgICAgcHJvamVjdE5hbWU6IFsKICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfpobnnm67lkI3np7AnLCB0cmlnZ2VyOiBbJ2JsdXInLCAnY2hhbmdlJ10gfQogICAgICAgIF0sCiAgICAgICAgdHlwZTogWwogICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+exu+WeiycsIHRyaWdnZXI6IFsnYmx1cicsICdjaGFuZ2UnXSB9CiAgICAgICAgXSwKICAgICAgICBob3NwaXRhbFBvaW50czogWwogICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+S9j+mZouenr+WIhicsIHRyaWdnZXI6IFsnYmx1cicsICdjaGFuZ2UnXSB9CiAgICAgICAgXSwKICAgICAgICBvdXRwYXRpZW50UG9pbnRzOiBbCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6Zeo6K+KJywgdHJpZ2dlcjogWydibHVyJywgJ2NoYW5nZSddIH0KICAgICAgICBdCiAgICAgIH0KICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CgogICAgbGlzdFR5cGUobnVsbCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgIHRoaXMudHlwZUxpc3QgPSByZXNwb25zZS5yb3dzCiAgICB9KQogICAgdGhpcy5nZXRMaXN0KCkKICB9LAogIG1ldGhvZHM6IHsKICAgIGdldERldGFpbEluZm8oKSB7CiAgICAgIGdldFdvcmtsb2FkKHRoaXMuaWQpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKQogICAgICAgIHRoaXMuZm9ybSA9IHJlc3BvbnNlLmRhdGEKICAgICAgfSkKICAgIH0sCiAgICAvKiog5p+l6K+i5bel5L2c6YeP5YiX6KGoICovCiAgICBnZXRMaXN0KCkgewogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlCiAgICAgIGxpc3RXb3JrbG9hZCh0aGlzLnF1ZXJ5UGFyYW1zKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICB0aGlzLndvcmtsb2FkTGlzdCA9IHJlc3BvbnNlLnJvd3MKICAgICAgICB0aGlzLnRvdGFsID0gcmVzcG9uc2UudG90YWwKICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQogICAgICB9KQogICAgfSwKICAgIC8vIOW8ueahhuWFs+mXrQogICAgaGFuZGxlRGlhbG9nQ2xvc2UoKSB7CiAgICAgIHRoaXMuJGVtaXQoJ2NhbmNlbCcsIGZhbHNlKQogICAgfSwKICAgIC8vIOWPlua2iAogICAgY2FuY2VsKCkgewogICAgICB0aGlzLiRlbWl0KCdjYW5jZWwnLCBmYWxzZSkKICAgIH0sCiAgICAvLyDooajljZXph43nva4KICAgIHJlc2V0KCkgewogICAgICB0aGlzLmZvcm0gPSB7CiAgICAgICAgaWQ6IG51bGwsCiAgICAgICAgY29tcENvZGU6IG51bGwsCiAgICAgICAgYWNjb3VudENvZGU6IG51bGwsCiAgICAgICAgcHJvamVjdENvZGU6IG51bGwsCiAgICAgICAgcHJvamVjdE5hbWU6IG51bGwsCiAgICAgICAgdHlwZTogbnVsbCwKICAgICAgICBzcGVsbDogbnVsbCwKICAgICAgICBob3NwaXRhbFBvaW50czogbnVsbCwKICAgICAgICBvdXRwYXRpZW50UG9pbnRzOiBudWxsLAogICAgICAgIGRlbEZsYWc6IG51bGwsCiAgICAgICAgY3JlYXRlQnk6IG51bGwsCiAgICAgICAgY3JlYXRlVGltZTogbnVsbCwKICAgICAgICB1cGRhdGVCeTogbnVsbCwKICAgICAgICB1cGRhdGVUaW1lOiBudWxsLAogICAgICAgIHJlbWFyazogbnVsbCwKICAgICAgICB3b3JrbG9hZERhdGU6IG51bGwKICAgICAgfQogICAgICB0aGlzLnJlc2V0Rm9ybSgnZm9ybScpCiAgICB9LAogICAgZ2V0UHltKCkgewogICAgICAvLyDlhajmmK/lrZfmr43nmoTmg4XlhrXkuIss5ou86Z+z56CB562J5LqO5omA5pyJ5a2X5q+NCiAgICAgIGlmICgvXlthLXpBLVpdKiQvLnRlc3QodGhpcy5mb3JtLnByb2plY3ROYW1lKSkgewogICAgICAgIHRoaXMuZm9ybS5zcGVsbCA9IHRoaXMuZm9ybS5wcm9qZWN0TmFtZQogICAgICAgIHJldHVybgogICAgICB9CiAgICAgIC8vIOacieaxieWtl+eahOaDheWGteS4iyzovazkuLrpppblrZfmr40KICAgICAgbGV0IGZ1bGxOYW1lID0gcGlueWluLmdldENhbWVsQ2hhcnModGhpcy5mb3JtLnByb2plY3ROYW1lKS50b1VwcGVyQ2FzZSgpCiAgICAgIGxldCBweW0gPSAnJwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZ1bGxOYW1lLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmFyIGMgPSBmdWxsTmFtZS5jaGFyQXQoaSkKICAgICAgICBpZiAoL15bQS1aXSskLy50ZXN0KGMpKSB7CiAgICAgICAgICBweW0gKz0gYwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLmZvcm0uc3BlbGwgPSBweW0KICAgIH0sCiAgICAvKiog5o+Q5Lqk5oyJ6ZKuICovCiAgICBzdWJtaXRGb3JtKCkgewogICAgICB0aGlzLiRyZWZzWydmb3JtJ10udmFsaWRhdGUodmFsaWQgPT4gewogICAgICAgIGlmICh2YWxpZCkgewogICAgICAgICAgdGhpcy5zYXZlTG9hZGluZyA9IHRydWUKICAgICAgICAgIGlmICh0aGlzLmZvcm0uaWQgIT0gbnVsbCkgewogICAgICAgICAgICB1cGRhdGVXb3JrbG9hZCh0aGlzLmZvcm0pLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgICAgIHRoaXMubXNnU3VjY2Vzcygn5L+u5pS55oiQ5YqfJykKICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdzdWNjZXNzJywgZmFsc2UpCiAgICAgICAgICAgICAgdGhpcy5zYXZlTG9hZGluZyA9IGZhbHNlCiAgICAgICAgICAgIH0pLmNhdGNoKChlcnIpPT57CiAgICAgICAgICAgICAgdGhpcy5zYXZlTG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGFkZFdvcmtsb2FkKHRoaXMuZm9ybSkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgICAgdGhpcy5tc2dTdWNjZXNzKCfmlrDlop7miJDlip8nKQogICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ3N1Y2Nlc3MnLCBmYWxzZSkKICAgICAgICAgICAgICB0aGlzLnNhdmVMb2FkaW5nID0gZmFsc2UKICAgICAgICAgICAgfSkuY2F0Y2goKGVycik9PnsKICAgICAgICAgICAgICB0aGlzLnNhdmVMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSkKICAgIH0KICB9Cn0K"},{"version":3,"sources":["addEdit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6DA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"addEdit.vue","sourceRoot":"src/views/workload/workload","sourcesContent":["<template>\n  <el-dialog :title=\"title\" :visible.sync=\"openDialog\" width=\"40%\" custom-class=\"el-button--primary\" append-to-body\n             :close-on-click-modal=\"false\" @close=\"handleDialogClose\"\n  >\n    <el-form ref=\"form\" :model=\"form\" :rules=\"rules\" label-width=\"100px\">\n      <el-row>\n        <el-col :span=\"12\">\n          <el-form-item label=\"年月\" prop=\"workloadDate\">\n            <el-date-picker clearable size=\"mini\"\n                            v-model=\"form.workloadDate\"\n                            type=\"month\"\n                            value-format=\"yyyy-MM-dd\"\n                            placeholder=\"选择年月\"\n            >\n            </el-date-picker>\n          </el-form-item>\n        </el-col>\n        <el-col :span=\"12\">\n          <el-form-item label=\"项目编码\" prop=\"projectCode\">\n            <el-input v-model=\"form.projectCode\" placeholder=\"请输入项目编码\" maxlength=\"50\" show-word-limit/>\n          </el-form-item>\n        </el-col>\n        <el-col :span=\"12\">\n          <el-form-item label=\"项目名称\" prop=\"projectName\">\n            <el-input v-model=\"form.projectName\" placeholder=\"请输入项目名称\" maxlength=\"50\" show-word-limit @blur=\"getPym\"/>\n          </el-form-item>\n        </el-col>\n        <el-col :span=\"12\">\n          <el-form-item label=\"类别\" prop=\"type\">\n            <el-select v-model=\"form.type\" placeholder=\"请选择类别\">\n              <el-option label=\"请选择字典生成\" :value=\"item.typeCode\" v-for=\"item in typeList\" :label=\"item.typeName\"/>\n            </el-select>\n          </el-form-item>\n        </el-col>\n        <el-col :span=\"12\">\n          <el-form-item label=\"拼音码\" prop=\"spell\">\n            <el-input v-model=\"form.spell\" placeholder=\"请输入拼音码\" disabled maxlength=\"50\" show-word-limit/>\n          </el-form-item>\n        </el-col>\n        <el-col :span=\"12\">\n          <el-form-item label=\"住院积分\" prop=\"hospitalPoints\">\n            <el-input-number :precision=\"2\" :step=\"0.01\" :min=\"0\" controls-position=\"right\" v-model=\"form.hospitalPoints\"\n                             placeholder=\"请输入住院积分\" show-word-limit/>\n          </el-form-item>\n        </el-col>\n        <el-col :span=\"12\">\n          <el-form-item label=\"门诊积分\" prop=\"outpatientPoints\">\n            <el-input-number :precision=\"2\" :step=\"0.01\" :min=\"0\" controls-position=\"right\" v-model=\"form.outpatientPoints\"\n                             placeholder=\"请输入门诊积分\" show-word-limit/>\n          </el-form-item>\n        </el-col>\n      </el-row>\n    </el-form>\n    <div slot=\"footer\" class=\"dialog-footer\">\n      <el-button type=\"primary\" @click=\"submitForm\" :loading=\"saveLoading\">确 定</el-button>\n      <el-button @click=\"cancel\">取 消</el-button>\n    </div>\n  </el-dialog>\n</template>\n\n<script>\nimport { addWorkload, getWorkload, listWorkload, updateWorkload } from '@/api/workload/workload'\nimport { listType } from '@/api/workload/type'\nimport pinyin from 'js-pinyin'\n\nexport default {\n  name: 'addEdit',\n  props: {\n    open: {\n      type: Boolean,\n      default: false\n    },\n    id: {\n      type: [String, Number],\n      default: ''\n    }\n  },\n  watch: {\n    id: {\n      handler(val) {\n        this.reset()\n        if (val) {\n          this.id = val\n          this.title = '工作量管理-编辑'\n          this.getDetailInfo()\n        } else {\n          this.id = ''\n          this.title = '工作量管理-新增'\n        }\n      },\n      deep: true,\n      immediate: true\n    },\n    open: {\n      handler(val) {\n        this.openDialog = val\n      },\n      deep: true\n    }\n  },\n  components: {},\n  data() {\n    return {\n      title: '工作量管理-新增',\n      openDialog: this.open,\n      typeList: [],\n      saveLoading: false,\n      // 表单参数\n      form: {},\n      // 表单校验\n      rules: {\n        workloadDate: [\n          { required: true, message: '年月', trigger: ['blur', 'change'] }\n        ],\n        projectCode: [\n          {required: true, message: '项目编码', trigger: ['blur', 'change'] }\n        ],\n        projectName: [\n          { required: true, message: '项目名称', trigger: ['blur', 'change'] }\n        ],\n        type: [\n          { required: true, message: '类型', trigger: ['blur', 'change'] }\n        ],\n        hospitalPoints: [\n          { required: true, message: '住院积分', trigger: ['blur', 'change'] }\n        ],\n        outpatientPoints: [\n          { required: true, message: '门诊', trigger: ['blur', 'change'] }\n        ]\n      }\n    }\n  },\n  created() {\n\n    listType(null).then(response => {\n      this.typeList = response.rows\n    })\n    this.getList()\n  },\n  methods: {\n    getDetailInfo() {\n      getWorkload(this.id).then(response => {\n        console.log(response)\n        this.form = response.data\n      })\n    },\n    /** 查询工作量列表 */\n    getList() {\n      this.loading = true\n      listWorkload(this.queryParams).then(response => {\n        this.workloadList = response.rows\n        this.total = response.total\n        this.loading = false\n      })\n    },\n    // 弹框关闭\n    handleDialogClose() {\n      this.$emit('cancel', false)\n    },\n    // 取消\n    cancel() {\n      this.$emit('cancel', false)\n    },\n    // 表单重置\n    reset() {\n      this.form = {\n        id: null,\n        compCode: null,\n        accountCode: null,\n        projectCode: null,\n        projectName: null,\n        type: null,\n        spell: null,\n        hospitalPoints: null,\n        outpatientPoints: null,\n        delFlag: null,\n        createBy: null,\n        createTime: null,\n        updateBy: null,\n        updateTime: null,\n        remark: null,\n        workloadDate: null\n      }\n      this.resetForm('form')\n    },\n    getPym() {\n      // 全是字母的情况下,拼音码等于所有字母\n      if (/^[a-zA-Z]*$/.test(this.form.projectName)) {\n        this.form.spell = this.form.projectName\n        return\n      }\n      // 有汉字的情况下,转为首字母\n      let fullName = pinyin.getCamelChars(this.form.projectName).toUpperCase()\n      let pym = ''\n      for (var i = 0; i < fullName.length; i++) {\n        var c = fullName.charAt(i)\n        if (/^[A-Z]+$/.test(c)) {\n          pym += c\n        }\n      }\n      this.form.spell = pym\n    },\n    /** 提交按钮 */\n    submitForm() {\n      this.$refs['form'].validate(valid => {\n        if (valid) {\n          this.saveLoading = true\n          if (this.form.id != null) {\n            updateWorkload(this.form).then(response => {\n              this.msgSuccess('修改成功')\n              this.$emit('success', false)\n              this.saveLoading = false\n            }).catch((err)=>{\n              this.saveLoading = false;\n            });\n          } else {\n            addWorkload(this.form).then(response => {\n              this.msgSuccess('新增成功')\n              this.$emit('success', false)\n              this.saveLoading = false\n            }).catch((err)=>{\n              this.saveLoading = false;\n            });\n          }\n        }\n      })\n    }\n  }\n}\n</script>\n<style lang=\"scss\" scoped>\n::v-deep .el-dialog {\n  min-height: 20%;\n  overflow: hidden;\n  .el-dialog__body {\n    height: calc(100% - 100px);\n    overflow: auto;\n    .el-input--mini,.el-input-number--mini,.el-select--mini,.el-date-picker--mini{\n      width: 100%;\n    }\n  }\n}\n</style>\n"]}]}