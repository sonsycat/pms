{"remainingRequest":"D:\\work\\pms_oracle\\pms_UI\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\work\\pms_oracle\\pms_UI\\src\\views\\evaluate\\set\\bonusIndex.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\work\\pms_oracle\\pms_UI\\src\\views\\evaluate\\set\\bonusIndex.vue","mtime":1693362205000},{"path":"D:\\work\\pms_oracle\\pms_UI\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1693361924000},{"path":"D:\\work\\pms_oracle\\pms_UI\\node_modules\\babel-loader\\lib\\index.js","mtime":1693361909000},{"path":"D:\\work\\pms_oracle\\pms_UI\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1693361924000},{"path":"D:\\work\\pms_oracle\\pms_UI\\node_modules\\vue-loader\\lib\\index.js","mtime":1693362179000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7bGlzdEJvbnVzSW5kZXgsIHNhdmVCb251c0luZGV4fSBmcm9tICJAL2FwaS9ldmFsdWF0ZS9pbmRleCI7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ0JvbnVzSW5kZXgnLAogIHByb3BzOiB7CgogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGluZGV4U2VsZWN0ZWRMb2FkaW5nOmZhbHNlLAogICAgICBpbmRleExpc3RMb2FkaW5nOmZhbHNlLAogICAgICBmb3JtOnt9LAogICAgICBydWxlczp7fSwKICAgICAgc2hvd1NlYXJjaDp0cnVlLAogICAgICBkZXB0Um9vbVR5cGVEaWN0OltdLAogICAgICBkZXB0Um9vbVR5cGU6IG51bGwsCiAgICAgIGluZGV4TGlzdDogW10sCiAgICAgIC8vIOacqumAieaMh+aghwogICAgICBpbmRleFVuU2VsZWN0ZWRMaXN0OiBbXSwKICAgICAgLy8g5bey6YCJ5oyH5qCHCiAgICAgIGluZGV4U2VsZWN0ZWRMaXN0OiBbXSwKICAgICAgZGF0YUxpc3RzOltdLAogICAgfTsKICB9LAoKICBjcmVhdGVkKCl7CiAgICB0aGlzLmdldERpY3RzKCJKWEdMX0pKX0tTTEIiKS50aGVuKHJlc3BvbnNlPT57CiAgICAgIHRoaXMuZGVwdFJvb21UeXBlRGljdCA9IHJlc3BvbnNlLmRhdGE7CiAgICAgIHRoaXMuZGVwdFJvb21UeXBlID0gdGhpcy5kZXB0Um9vbVR5cGVEaWN0WzBdLmRpY3RWYWx1ZTsKICAgIH0pCiAgICB0aGlzLmdldEJvbnVzSW5kZXhMaXN0KCk7CiAgfSwKCiAgbW91bnRlZCgpIHsKCiAgfSwKCiAgbWV0aG9kczogewogICAgLyoqIOiOt+WPluWllumHkeaMh+agh+WIl+ihqCAqLwogICAgZ2V0Qm9udXNJbmRleExpc3QoKXsKICAgICAgbGV0IHBhcmFtID0ge29yZ1R5cGU6ICIyIn07Ly/np5EKICAgICAgbGlzdEJvbnVzSW5kZXgocGFyYW0pLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIHRoaXMuaW5kZXhMaXN0ID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICB0aGlzLmdldEJvbnVzSW5kZXhMaXN0U2VsZWN0ZWQodGhpcy5kZXB0Um9vbVR5cGUpCiAgICAgICAgdGhpcy5pbmRleFNlbGVjdGVkTG9hZGluZyA9IGZhbHNlCiAgICAgIH0pOwogICAgfSwKICAgIC8qKiDojrflj5blt7LpgInmjIfmoIfliJfooaggKi8KICAgIGdldEJvbnVzSW5kZXhMaXN0U2VsZWN0ZWQoZGVwdFJvb21UeXBlKXsKICAgICAgdGhpcy5pbmRleFVuU2VsZWN0ZWRMaXN0ID0gW107CiAgICAgIHRoaXMuaW5kZXhTZWxlY3RlZExpc3QgPSBbXTsKICAgICAgdGhpcy5pbmRleExpc3QuZm9yRWFjaChpdGVtPT57CiAgICAgICAgaWYoZGVwdFJvb21UeXBlID09ICcwJyl7CiAgICAgICAgICAvLyDni6znq4vmoLjnrpcKICAgICAgICAgIGlmKGl0ZW0uZGVwdFR5cGUgIT0gJzInKXsKCiAgICAgICAgICB9CiAgICAgICAgfWVsc2UgaWYoZGVwdFJvb21UeXBlID09ICcxJyl7CiAgICAgICAgICAvLyDlubPlnYflpZYKICAgICAgICAgIGlmKGl0ZW0uZGVwdFR5cGUgPT0gJzInKXsKCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmKChkZXB0Um9vbVR5cGUgPT0gJzAnICYmIGl0ZW0uZGVwdFR5cGUgIT0gJzInKSB8fCBkZXB0Um9vbVR5cGUgPT0gJzEnICYmIGl0ZW0uZGVwdFR5cGUgPT0gJzInKXsKICAgICAgICAgIGlmKCFpdGVtLmRlcHRSb29tVHlwZSl7CiAgICAgICAgICAgIHRoaXMuaW5kZXhVblNlbGVjdGVkTGlzdC5wdXNoKGl0ZW0pOwogICAgICAgICAgfWVsc2UgaWYoaXRlbS5kZXB0Um9vbVR5cGUgPT0gZGVwdFJvb21UeXBlKXsKICAgICAgICAgICAgdGhpcy5pbmRleFNlbGVjdGVkTGlzdC5wdXNoKGl0ZW0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSkKICAgIH0sCgogICAgdGFibGVSb3dDbGFzc05hbWUoeyByb3csIHJvd0luZGV4IH0pIHsKICAgICAgcm93LmluZGV4ID0gcm93SW5kZXg7CiAgICB9LAogICAgLy8g5b6F6YCJ6KeS6Imy5aSa6YCJ5qGG6YCJ5Lit5pWw5o2uCiAgICBzZWxlY3RJbmRleChzZWxlY3Rpb24sIHJvdykgewogICAgICB0aGlzLnJvd0NsaWNrV2FpdENsYXNzKHNlbGVjdGlvblswXSkKICAgIH0sCiAgICAvL+W+hemAieinkuiJsiDngrnlh7vooYwKICAgIHJvd0NsaWNrV2FpdENsYXNzKHNlbGVjdGlvbil7CiAgICAgIHRoaXMuaW5kZXhTZWxlY3RlZExpc3QucHVzaChzZWxlY3Rpb24pOwogICAgICB0aGlzLmluZGV4VW5TZWxlY3RlZExpc3Quc3BsaWNlKHNlbGVjdGlvbi5pbmRleCwgMSk7CiAgICB9LAogICAgLy8g5bey6YCJ6KeS6Imy5aSa6YCJ5qGG6YCJ5Lit5pWw5o2uCiAgICB1bnNlbGVjdEluZGV4KHNlbGVjdGlvbiwgcm93KSB7CiAgICAgIHRoaXMucm93Q2xpY2tIYXNDbGFzcyhzZWxlY3Rpb25bMF0pCiAgICB9LAogICAgLy8g5bey57uP6YCJ5oup54K55Ye76KGMCiAgICByb3dDbGlja0hhc0NsYXNzKHNlbGVjdGlvbil7CiAgICAgIHRoaXMuaW5kZXhVblNlbGVjdGVkTGlzdC5wdXNoKHNlbGVjdGlvbik7CiAgICAgIHRoaXMuaW5kZXhTZWxlY3RlZExpc3Quc3BsaWNlKHNlbGVjdGlvbi5pbmRleCwgMSk7CiAgICB9LAogICAgc3dpdGNoRGVwdFJvb21UeXBlKGFsbCl7CiAgICAgIHRoaXMuZ2V0Qm9udXNJbmRleExpc3RTZWxlY3RlZChhbGwpOwogICAgfSwKCiAgICBzdWJtaXRGb3JtKCl7CiAgICAgIGlmKCF0aGlzLmRlcHRSb29tVHlwZSl7CiAgICAgICAgdGhpcy5tc2dFcnJvcigi5pyq6YCJ5oup56eR5a6k57G75YirIik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGxldCBkYXRhID0gewogICAgICAgIGNvbXBDb2RlOiB0aGlzLiRzdG9yZS5zdGF0ZS51c2VyLnVzZXJJbmZvLmRlcHRJZCwKICAgICAgICBkZXB0Um9vbVR5cGU6IHRoaXMuZGVwdFJvb21UeXBlLAogICAgICAgIGV2YWx1YXRlSW5kZXhCb251c0xpc3Q6IHRoaXMuaW5kZXhTZWxlY3RlZExpc3QubWFwKGl0ZW09PnsKICAgICAgICAgIHRoaXMuZGF0YUxpc3RzLmZvckVhY2goaXRlPT57CiAgICAgICAgICAgIGlmKGl0ZS5pbmRleE5hbWU9PWl0ZW0uaW5kZXhOYW1lKXsKICAgICAgICAgICAgICBpdGVtLmluZGV4Q29kZT1pdGUuaW5kZXhDb2RlCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pCiAgICAgICAgICByZXR1cm4gaXRlbQogICAgICAgIH0pCiAgICAgIH0KICAgICAgY29uc3Qgc2F2ZUxvYWRpbmc9dGhpcy5zYXZlTG9hZGluZygpCiAgICAgIHNhdmVCb251c0luZGV4KGRhdGEpLnRoZW4ocmVzcG9uc2U9PnsKICAgICAgICBpZihyZXNwb25zZS5jb2RlPT0yMDApewogICAgICAgICAgdGhpcy5tc2dTdWNjZXNzKCLkv53lrZjmiJDlip8iKTsKICAgICAgICAgIHRoaXMuJGVtaXQoInN1Y2Nlc3MiLCBmYWxzZSk7CiAgICAgICAgICB0aGlzLmdldEJvbnVzSW5kZXhMaXN0KCk7CiAgICAgICAgICBzYXZlTG9hZGluZy5jbG9zZSgpCiAgICAgICAgfQogICAgICB9KQogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["bonusIndex.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+DA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"bonusIndex.vue","sourceRoot":"src/views/evaluate/set","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <div ref=\"search\">\n      <el-form ref=\"queryForm\" :inline=\"true\" v-show=\"showSearch\">\n        <el-form-item label=\"科室类别\" prop=\"deptRoomType\" >\n          <el-select class=\"w100\" v-model=\"deptRoomType\" @change=\"switchDeptRoomType($event)\"  placeholder=\"请选择科室类别\">\n            <el-option\n              v-for=\"dict in deptRoomTypeDict\"\n              :key=\"dict.dictValue\"\n              :label=\"dict.dictLabel\"\n              :value=\"dict.dictValue\"\n            />\n          </el-select>\n        </el-form-item>\n        <el-form-item>\n          <el-button type=\"primary\" icon=\"el-icon-document\" size=\"mini\" @click=\"submitForm\">保 存</el-button>\n        </el-form-item>\n      </el-form>\n    </div>\n    <el-row :gutter=\"20\">\n      <el-col :span=\"12\" class=\"mb10\">\n        <el-card>\n          <el-col :span=\"12\">\n            <span style=\"font-size:16px\">待选指标</span>\n          </el-col>\n          <el-table\n            v-loading=\"indexListLoading\"\n            :data=\"indexUnSelectedList\"\n            :row-class-name=\"tableRowClassName\"\n            @select=\"selectIndex\"\n            @row-dblclick=\"rowClickWaitClass\"\n            height=\"calc('100% - 48px')\"\n          >\n            <el-table-column type=\"index\" width=\"50\"> </el-table-column>\n            <el-table-column type=\"selection\" width=\"55\" align=\"center\" />\n            <el-table-column label=\"指标名称\" align=\"left\" prop=\"indexName\" show-overflow-tooltip/>\n          </el-table>\n        </el-card>\n      </el-col>\n      <el-col :span=\"12\" class=\"mb10\">\n        <el-card>\n          <el-col :span=\"10\">\n            <span style=\"font-size:16px\">已选指标</span>\n          </el-col>\n          <el-table\n            v-loading=\"indexSelectedLoading\"\n            :data=\"indexSelectedList\"\n            :row-class-name=\"tableRowClassName\"\n            @row-dblclick=\"rowClickHasClass\"\n            @select=\"unselectIndex\"\n            height=\"calc('100% - 48px')\"\n          >\n            <el-table-column type=\"index\" width=\"50\"> </el-table-column>\n            <el-table-column type=\"selection\" width=\"55\" align=\"center\" />\n            <el-table-column label=\"指标名称\" align=\"left\" prop=\"indexName\" show-overflow-tooltip/>\n          </el-table>\n        </el-card>\n      </el-col>\n    </el-row>\n  </div>\n</template>\n\n<script>\nimport {listBonusIndex, saveBonusIndex} from \"@/api/evaluate/index\";\n\nexport default {\n  name: 'BonusIndex',\n  props: {\n\n  },\n  data() {\n    return {\n      indexSelectedLoading:false,\n      indexListLoading:false,\n      form:{},\n      rules:{},\n      showSearch:true,\n      deptRoomTypeDict:[],\n      deptRoomType: null,\n      indexList: [],\n      // 未选指标\n      indexUnSelectedList: [],\n      // 已选指标\n      indexSelectedList: [],\n      dataLists:[],\n    };\n  },\n\n  created(){\n    this.getDicts(\"JXGL_JJ_KSLB\").then(response=>{\n      this.deptRoomTypeDict = response.data;\n      this.deptRoomType = this.deptRoomTypeDict[0].dictValue;\n    })\n    this.getBonusIndexList();\n  },\n\n  mounted() {\n\n  },\n\n  methods: {\n    /** 获取奖金指标列表 */\n    getBonusIndexList(){\n      let param = {orgType: \"2\"};//科\n      listBonusIndex(param).then(response => {\n        this.indexList = response.data;\n        this.getBonusIndexListSelected(this.deptRoomType)\n        this.indexSelectedLoading = false\n      });\n    },\n    /** 获取已选指标列表 */\n    getBonusIndexListSelected(deptRoomType){\n      this.indexUnSelectedList = [];\n      this.indexSelectedList = [];\n      this.indexList.forEach(item=>{\n        if(deptRoomType == '0'){\n          // 独立核算\n          if(item.deptType != '2'){\n\n          }\n        }else if(deptRoomType == '1'){\n          // 平均奖\n          if(item.deptType == '2'){\n\n          }\n        }\n        if((deptRoomType == '0' && item.deptType != '2') || deptRoomType == '1' && item.deptType == '2'){\n          if(!item.deptRoomType){\n            this.indexUnSelectedList.push(item);\n          }else if(item.deptRoomType == deptRoomType){\n            this.indexSelectedList.push(item);\n          }\n        }\n      })\n    },\n\n    tableRowClassName({ row, rowIndex }) {\n      row.index = rowIndex;\n    },\n    // 待选角色多选框选中数据\n    selectIndex(selection, row) {\n      this.rowClickWaitClass(selection[0])\n    },\n    //待选角色 点击行\n    rowClickWaitClass(selection){\n      this.indexSelectedList.push(selection);\n      this.indexUnSelectedList.splice(selection.index, 1);\n    },\n    // 已选角色多选框选中数据\n    unselectIndex(selection, row) {\n      this.rowClickHasClass(selection[0])\n    },\n    // 已经选择点击行\n    rowClickHasClass(selection){\n      this.indexUnSelectedList.push(selection);\n      this.indexSelectedList.splice(selection.index, 1);\n    },\n    switchDeptRoomType(all){\n      this.getBonusIndexListSelected(all);\n    },\n\n    submitForm(){\n      if(!this.deptRoomType){\n        this.msgError(\"未选择科室类别\");\n        return;\n      }\n      let data = {\n        compCode: this.$store.state.user.userInfo.deptId,\n        deptRoomType: this.deptRoomType,\n        evaluateIndexBonusList: this.indexSelectedList.map(item=>{\n          this.dataLists.forEach(ite=>{\n            if(ite.indexName==item.indexName){\n              item.indexCode=ite.indexCode\n            }\n          })\n          return item\n        })\n      }\n      const saveLoading=this.saveLoading()\n      saveBonusIndex(data).then(response=>{\n        if(response.code==200){\n          this.msgSuccess(\"保存成功\");\n          this.$emit(\"success\", false);\n          this.getBonusIndexList();\n          saveLoading.close()\n        }\n      })\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n::v-deep .mb10 {\n  height: 100%;\n  .el-card__body {\n    padding: 10px;\n    height: 100%;\n  }\n  .el-table{\n    height: calc(100vh - 220px);\n  }\n}\n.app-container{padding: 0px;}\n</style>\n"]}]}